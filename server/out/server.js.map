<<<<<<< HEAD
<<<<<<< HEAD
{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/vscode-jsonrpc/lib/main.js","webpack:///./node_modules/vscode-jsonrpc/lib/is.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/main.js","webpack:///./node_modules/vscode-jsonrpc/lib/events.js","webpack:///./node_modules/vscode-jsonrpc/lib/messageReader.js","webpack:///./node_modules/vscode-jsonrpc/lib/messageWriter.js","webpack:///./node_modules/vscode-languageserver/lib/main.js","webpack:///external \"path\"","webpack:///external \"net\"","webpack:///./node_modules/vscode-languageserver/lib/utils/is.js","webpack:///./node_modules/vscode-languageserver/lib sync","webpack:///./src/server.ts","webpack:///./node_modules/vscode-jsonrpc/lib/messages.js","webpack:///./node_modules/vscode-jsonrpc/lib/cancellation.js","webpack:///./node_modules/vscode-jsonrpc/lib/linkedMap.js","webpack:///./node_modules/vscode-jsonrpc/lib/pipeSupport.js","webpack:///external \"os\"","webpack:///external \"crypto\"","webpack:///./node_modules/vscode-jsonrpc/lib/socketSupport.js","webpack:///./node_modules/vscode-languageserver-types/lib/esm/main.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/utils/is.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.implementation.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.typeDefinition.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.workspaceFolders.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.configuration.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.colorProvider.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.foldingRange.js","webpack:///./node_modules/vscode-languageserver-protocol/lib/protocol.declaration.js","webpack:///./node_modules/vscode-languageserver/lib/configuration.js","webpack:///./node_modules/vscode-languageserver/lib/workspaceFolders.js","webpack:///./node_modules/vscode-languageserver/lib/utils/uuid.js","webpack:///./node_modules/vscode-languageserver/lib/files.js","webpack:///external \"url\"","webpack:///external \"fs\"","webpack:///external \"child_process\"","webpack:///./src/parser.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","__export","Is","messages_1","RequestType","RequestType0","RequestType1","RequestType2","RequestType3","RequestType4","RequestType5","RequestType6","RequestType7","RequestType8","RequestType9","ResponseError","ErrorCodes","NotificationType","NotificationType0","NotificationType1","NotificationType2","NotificationType3","NotificationType4","NotificationType5","NotificationType6","NotificationType7","NotificationType8","NotificationType9","messageReader_1","MessageReader","StreamMessageReader","IPCMessageReader","SocketMessageReader","messageWriter_1","MessageWriter","StreamMessageWriter","IPCMessageWriter","SocketMessageWriter","events_1","Disposable","Event","Emitter","cancellation_1","CancellationTokenSource","CancellationToken","linkedMap_1","CancelNotification","Trace","TraceFormat","SetTraceNotification","LogTraceNotification","ConnectionErrors","ConnectionState","type","NullLogger","freeze","error","warn","info","log","fromString","toLowerCase","Off","Messages","Verbose","toString","JSON","Text","ConnectionError","Error","code","message","super","this","setPrototypeOf","_createMessageConnection","messageReader","messageWriter","logger","strategy","sequenceNumber","notificationSquenceNumber","unknownResponseSquenceNumber","version","timer","tracer","starRequestHandler","undefined","requestHandlers","starNotificationHandler","notificationHandlers","messageQueue","LinkedMap","responsePromises","requestTokens","trace","traceFormat","state","New","errorEmitter","closeEmitter","unhandledNotificationEmitter","disposeEmitter","createRequestQueueKey","id","addMessageToQueue","queue","isRequestMessage","set","isResponseMessage","cancelUndispatched","_message","isListening","Listening","isClosed","Closed","isDisposed","Disposed","closeHandler","fire","triggerMessageQueue","size","setImmediate","shift","requestMessage","reply","resultOrError","method","startTime","jsonrpc","toJson","result","traceSendingResponse","write","replyError","data","params","stringify","logLSPMessage","traceReceivedRequest","requestHandler","element","handler","Date","now","cancellationSource","tokenKey","String","handlerResult","promise","numberOfParams","token","array","then","string","InternalError","replySuccess","MethodNotFound","handleRequest","isNotificationMessage","notificationHandler","source","cancel","traceReceivedNotification","handleNotification","responseMessage","responsePromise","timerStart","traceReceivedResponse","reject","resolve","handleResponse","number","responseHandler","handleInvalidMessage","processMessageQueue","onClose","onError","callback","toCancel","response","delete","lspMessage","isLSPMessage","timestamp","throwIfClosedOrDisposed","undefinedToNull","param","computeMessageParams","length","push","connection","sendNotification","messageParams","notificationMessage","traceSendingNotification","onNotification","func","sendRequest","throwIfNotListening","is","last","slice","map","Promise","traceSendingRequest","e","MessageWriteError","onCancellationRequested","onRequest","_value","_tracer","sendNotificationOrTraceOptions","_sendNotification","_traceFormat","boolean","event","onUnhandledNotification","onDispose","dispose","keys","forEach","listen","AlreadyListening","throwIfListening","inspect","console","verbose","ConnectionStrategy","candidate","createMessageConnection","input","output","read","end","isMessageWriter","Array","isArray","Number","stringArray","every","elem","vscode_jsonrpc_1","createClientPipeTransport","createServerPipeTransport","generateRandomPipeName","createClientSocketTransport","createServerSocketTransport","createProtocolConnection","reader","writer","_disposable","None","CallbackList","context","bucket","_callbacks","_contexts","remove","foundCallbackWithDifferentContext","len","splice","args","ret","callbacks","contexts","apply","_options","_event","listener","thisArgs","disposables","onFirstListenerAdd","isEmpty","add","_noop","onLastListenerRemove","invoke","DefaultSize","CR","Buffer","from","LF","CRLF","MessageBuffer","encoding","index","buffer","allocUnsafe","chunk","toAppend","str","bufferLen","byteLength","copy","newSize","Math","ceil","concat","current","split","header","indexOf","substr","trim","nextStart","onPartialMessage","AbstractMessageReader","partialMessageEmitter","asError","readable","_partialMessageTimeout","timeout","nextMessageLength","messageToken","partialMessageTimer","on","onData","fireError","fireClose","append","headers","tryReadHeaders","contentLength","parseInt","isNaN","msg","tryReadContent","setPartialMessageTimer","clearPartialMessageTimer","json","parse","clearTimeout","setTimeout","firePartialMessage","waitingTime","process","eventEmitter","socket","ContentLength","AbstractMessageWriter","count","writable","errorCount","join","sending","doWriteMessage","send","handleError","vscode_languageserver_protocol_1","configuration_1","workspaceFolders_1","UUID","fm","Files","uriToFilePath","resolveGlobalNodePath","resolveGlobalYarnPath","resolveModule","resolveModule2","resolveModulePath","shutdownReceived","exitTimer","null2Undefined","runTimer","processId","setInterval","kill","ex","exit","argv","arg","setupExitTimer","TextDocuments","_documents","_onDidChangeContent","_onDidOpen","_onDidClose","_onDidSave","_onWillSave","TextDocumentSyncKind","Full","_willSaveWaitUntil","uri","__textDocumentSync","onDidOpenTextDocument","td","textDocument","document","TextDocument","languageId","text","toFire","onDidChangeTextDocument","changes","contentChanges","update","isUpdateableDocument","onDidCloseTextDocument","onWillSaveTextDocument","reason","onWillSaveTextDocumentWaitUntil","onDidSaveTextDocument","ErrorMessageTracker","_messages","window","showErrorMessage","BulkRegistration","BulkRegistrationImpl","_registrations","_registered","Set","registerOptions","has","generateUuid","registrations","BulkUnregistration","BulkUnregistrationImpl","_connection","unregistrations","_unregistrations","Map","unregistration","values","unregisterations","UnregistrationRequest","_error","ConnectionLogger","_rawConnection","_capabilities","MessageType","Warning","Info","Log","LogMessageNotification","RemoteWindowImpl","actions","ShowMessageRequest","RemoteClientImpl","typeOrRegistrations","registerOptionsOrType","registerMany","registerSingle1","registerSingle2","isAttached","attach","RegistrationRequest","_result","unregisterSingle","asRegistrationParams","registration","RemoteWorkspaceImpl","WorkspaceFoldersFeature","ConfigurationFeature","paramOrEdit","edit","ApplyWorkspaceEditRequest","TracerImpl","_trace","TelemetryImpl","TelemetryEventNotification","combineConsoleFeatures","one","two","Base","combineTelemetryFeatures","combineTracerFeatures","combineClientFeatures","combineWindowFeatures","combineWorkspaceFeatures","combineFeatures","combine","__brand","telemetry","client","workspace","createConnection","arg1","arg2","arg3","arg4","factories","port","pipeName","stdin","stdout","transport","commandLineMessage","inputStream","rawAttach","remoteWindow","allRemotes","shutdownHandler","initializeHandler","exitHandler","protocolConnection","arguments","onInitialize","onInitialized","InitializedNotification","onShutdown","onExit","onDidChangeConfiguration","DidChangeConfigurationNotification","onDidChangeWatchedFiles","DidChangeWatchedFilesNotification","DidOpenTextDocumentNotification","DidChangeTextDocumentNotification","DidCloseTextDocumentNotification","WillSaveTextDocumentNotification","WillSaveTextDocumentWaitUntilRequest","DidSaveTextDocumentNotification","sendDiagnostics","PublishDiagnosticsNotification","onHover","HoverRequest","onCompletion","CompletionRequest","onCompletionResolve","CompletionResolveRequest","onSignatureHelp","SignatureHelpRequest","onDeclaration","DeclarationRequest","onDefinition","DefinitionRequest","onTypeDefinition","TypeDefinitionRequest","onImplementation","ImplementationRequest","onReferences","ReferencesRequest","onDocumentHighlight","DocumentHighlightRequest","onDocumentSymbol","DocumentSymbolRequest","onWorkspaceSymbol","WorkspaceSymbolRequest","onCodeAction","CodeActionRequest","onCodeLens","CodeLensRequest","onCodeLensResolve","CodeLensResolveRequest","onDocumentFormatting","DocumentFormattingRequest","onDocumentRangeFormatting","DocumentRangeFormattingRequest","onDocumentOnTypeFormatting","DocumentOnTypeFormattingRequest","onRenameRequest","RenameRequest","onPrepareRename","PrepareRenameRequest","onDocumentLinks","DocumentLinkRequest","onDocumentLinkResolve","DocumentLinkResolveRequest","onDocumentColor","DocumentColorRequest","onColorPresentation","ColorPresentationRequest","onFoldingRanges","FoldingRangeRequest","onExecuteCommand","ExecuteCommandRequest","remote","InitializeRequest","initialize","capabilities","thenable","asThenable","textDocumentSync","change","fillServerCapabilities","ShutdownRequest","ExitNotification","_createConnection","ProposedFeatures","all","require","typedArray","check","webpackEmptyContext","req","documents","hasConfigurationCapability","hasWorkspaceFolderCapability","hasDiagnosticRelatedInformationCapability","configuration","workspaceFolders","publishDiagnostics","relatedInformation","syncKind","codeActionProvider","completionProvider","resolveProvider","documentSymbolProvider","executeCommandProvider","register","onDidChangeWorkspaceFolders","defaultSettings","maxNumberOfProblems","enableSyntaxCheckTab","enableSyntaxCheckCodeAction","globalSettings","documentSettings","getDocumentSettings","resource","getConfiguration","scopeUri","section","validateTextDocument","settings","getText","pattern","problems","diagnostics","exec","diagnostic","severity","DiagnosticSeverity","range","start","positionAt","location","assign","documentSymbol","symbolInformationResult","thisdoc","symbols","ParseDocument","grammar","symbol","symbolRange","Range","parseItem","line","symbolInformation","SymbolInformation","container","pToken","command","syntaxmessage","myarray","stringsA","fieldsA","variablesA","sym","containerName","distinctStrings","distinctFields","distinctVars","newuri","createFile","kind","createFiles","workspaceEdit","documentChanges","applyEdit","textEdit","textEdits","MAX_VALUE","newText","textDocumentEdit","TextDocumentEdit","textDocumentEdits","clear","languageServerExample","onDidClose","onDidChangeContent","checkDocumentSyntax","_change","_textDocumentPosition","label","CompletionItemKind","item","detail","documentation","codeActionParams","codeAction","title","CodeActionKind","QuickFix","Command","ParseError","InvalidRequest","InvalidParams","serverErrorStart","serverErrorEnd","ServerNotInitialized","UnknownErrorCode","RequestCancelled","MessageReadError","AbstractMessageType","_method","_numberOfParams","_","isCancellationRequested","Cancelled","shortcutEvent","handle","MutableToken","_isCancelled","_emitter","_token","Touch","First","Last","_map","_head","_tail","_size","touch","next","previous","addItemLast","addItemFirst","removeItem","callbackfn","thisArg","path_1","os_1","crypto_1","net_1","randomSuffix","randomBytes","platform","tmpdir","connectResolve","connected","_reject","server","createServer","close","removeListener","onConnected","Position","Location","LocationLink","Color","ColorInformation","ColorPresentation","FoldingRangeKind","FoldingRange","DiagnosticRelatedInformation","Diagnostic","TextEdit","CreateFile","RenameFile","DeleteFile","WorkspaceEdit","character","objectLiteral","three","four","defined","targetUri","targetRange","targetSelectionRange","originSelectionRange","red","green","blue","alpha","color","additionalTextEdits","startLine","endLine","startCharacter","endCharacter","Information","Hint","_i","replace","insert","position","del","edits","VersionedTextDocumentIdentifier","options","overwrite","ignoreIfExists","oldUri","newUri","recursive","ignoreIfNotExists","TextDocumentIdentifier","TextDocumentItem","MarkupKind","MarkupContent","InsertTextFormat","CompletionItem","CompletionList","MarkedString","Hover","ParameterInformation","SignatureInformation","DocumentHighlightKind","DocumentHighlight","SymbolKind","TextEditChangeImpl","WorkspaceChange","_this","_textEditChanges","_workspaceEdit","textEditChange","configurable","getTextEditChange","checkDocumentChanges","renameFile","deleteFile","PlainText","Markdown","Method","Function","Constructor","Field","Variable","Class","Interface","Module","Property","Unit","Value","Enum","Keyword","Snippet","File","Reference","Folder","EnumMember","Constant","Struct","Operator","TypeParameter","items","isIncomplete","fromPlainText","plainText","language","contents","parameters","Read","Write","Namespace","Package","Boolean","Key","Null","CodeActionContext","CodeAction","CodeLens","FormattingOptions","DocumentSymbol","selectionRange","children","deprecated","Refactor","RefactorExtract","RefactorInline","RefactorRewrite","Source","SourceOrganizeImports","only","commandOrEdit","tabSize","insertSpaces","DocumentLink","target","TextDocumentSaveReason","EOL","content","FullTextDocument","lineCount","offsetAt","applyEdits","sortedEdits","mergeSort","compare","left","right","leftIdx","rightIdx","a","b","diff","lastModifiedOffset","startOffset","endOffset","substring","Manual","AfterDelay","FocusOut","_uri","_languageId","_version","_content","_lineOffsets","getLineOffsets","lineOffsets","isLineStart","ch","charAt","offset","max","min","low","high","mid","floor","lineOffset","nextLineOffset","protocol_implementation_1","protocol_typeDefinition_1","protocol_workspaceFolders_1","WorkspaceFoldersRequest","DidChangeWorkspaceFoldersNotification","protocol_configuration_1","ConfigurationRequest","protocol_colorProvider_1","protocol_foldingRange_1","protocol_declaration_1","DocumentFilter","scheme","ResourceOperationKind","Create","Rename","Delete","FailureHandlingKind","Abort","Transactional","TextOnlyTransactional","Undo","Incremental","InitializeError","unknownProtocolVersion","ShowMessageNotification","FileChangeType","Created","Changed","Deleted","WatchKind","Change","CompletionTriggerKind","Invoked","TriggerCharacter","TriggerForIncompleteCompletions","_getConfiguration","workspaceCapabilities","_onDidChangeWorkspaceFolders","_unregistration","ValueUUID","other","asHex","V4UUID","_randomHex","_oneOf","_timeHighBits","random","_chars","v4","empty","_UUIDPattern","isUUID","test","url","path","fs","child_process_1","isWindows","moduleName","nodePath","cwd","app","env","newEnv","delimiter","cp","fork","execArgv","pid","npmCommand","shell","spawnSync","prefix","err","FileSystem","workspaceRoot","isAbsolute","isParent","parsed","protocol","segments","decodeURIComponent","first","second","normalize","_stderr","globalPath","separator","__dirname","toRequire","success","yarnCommand","results","stderr","lines","yarn","_isCaseSensitive","isCaseSensitive","existsSync","__filename","toUpperCase","parent","child","PARSE_INSTRUCTION","mySymbols","ParseStatus","oneLine","vscode","oneString","findSymbol","symName","resultItem","ParseItem","oneSymbol","MySymbol","oneDB","inside","symb","withinField","resultSymbol","match","startofword","word","isKeyword","node","repository","keywords","patterns","newMatch","lastIndex","pLine","pDelimOpen","pDelimClose","nStart","nEnd","pClose","startFound","parseMode","parseDepth","parseString","stringQuote","instructionString","instructionStartLine","pItem","pStart","pEnd","pPosition","pName","pType"],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 11);\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"./thenable.ts\" />\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./is\");\r\nconst messages_1 = require(\"./messages\");\r\nexports.RequestType = messages_1.RequestType;\r\nexports.RequestType0 = messages_1.RequestType0;\r\nexports.RequestType1 = messages_1.RequestType1;\r\nexports.RequestType2 = messages_1.RequestType2;\r\nexports.RequestType3 = messages_1.RequestType3;\r\nexports.RequestType4 = messages_1.RequestType4;\r\nexports.RequestType5 = messages_1.RequestType5;\r\nexports.RequestType6 = messages_1.RequestType6;\r\nexports.RequestType7 = messages_1.RequestType7;\r\nexports.RequestType8 = messages_1.RequestType8;\r\nexports.RequestType9 = messages_1.RequestType9;\r\nexports.ResponseError = messages_1.ResponseError;\r\nexports.ErrorCodes = messages_1.ErrorCodes;\r\nexports.NotificationType = messages_1.NotificationType;\r\nexports.NotificationType0 = messages_1.NotificationType0;\r\nexports.NotificationType1 = messages_1.NotificationType1;\r\nexports.NotificationType2 = messages_1.NotificationType2;\r\nexports.NotificationType3 = messages_1.NotificationType3;\r\nexports.NotificationType4 = messages_1.NotificationType4;\r\nexports.NotificationType5 = messages_1.NotificationType5;\r\nexports.NotificationType6 = messages_1.NotificationType6;\r\nexports.NotificationType7 = messages_1.NotificationType7;\r\nexports.NotificationType8 = messages_1.NotificationType8;\r\nexports.NotificationType9 = messages_1.NotificationType9;\r\nconst messageReader_1 = require(\"./messageReader\");\r\nexports.MessageReader = messageReader_1.MessageReader;\r\nexports.StreamMessageReader = messageReader_1.StreamMessageReader;\r\nexports.IPCMessageReader = messageReader_1.IPCMessageReader;\r\nexports.SocketMessageReader = messageReader_1.SocketMessageReader;\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nexports.MessageWriter = messageWriter_1.MessageWriter;\r\nexports.StreamMessageWriter = messageWriter_1.StreamMessageWriter;\r\nexports.IPCMessageWriter = messageWriter_1.IPCMessageWriter;\r\nexports.SocketMessageWriter = messageWriter_1.SocketMessageWriter;\r\nconst events_1 = require(\"./events\");\r\nexports.Disposable = events_1.Disposable;\r\nexports.Event = events_1.Event;\r\nexports.Emitter = events_1.Emitter;\r\nconst cancellation_1 = require(\"./cancellation\");\r\nexports.CancellationTokenSource = cancellation_1.CancellationTokenSource;\r\nexports.CancellationToken = cancellation_1.CancellationToken;\r\nconst linkedMap_1 = require(\"./linkedMap\");\r\n__export(require(\"./pipeSupport\"));\r\n__export(require(\"./socketSupport\"));\r\nvar CancelNotification;\r\n(function (CancelNotification) {\r\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\r\n})(CancelNotification || (CancelNotification = {}));\r\nexports.NullLogger = Object.freeze({\r\n    error: () => { },\r\n    warn: () => { },\r\n    info: () => { },\r\n    log: () => { }\r\n});\r\nvar Trace;\r\n(function (Trace) {\r\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\r\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\r\n    Trace[Trace[\"Verbose\"] = 2] = \"Verbose\";\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\n(function (Trace) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        switch (value) {\r\n            case 'off':\r\n                return Trace.Off;\r\n            case 'messages':\r\n                return Trace.Messages;\r\n            case 'verbose':\r\n                return Trace.Verbose;\r\n            default:\r\n                return Trace.Off;\r\n        }\r\n    }\r\n    Trace.fromString = fromString;\r\n    function toString(value) {\r\n        switch (value) {\r\n            case Trace.Off:\r\n                return 'off';\r\n            case Trace.Messages:\r\n                return 'messages';\r\n            case Trace.Verbose:\r\n                return 'verbose';\r\n            default:\r\n                return 'off';\r\n        }\r\n    }\r\n    Trace.toString = toString;\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\nvar TraceFormat;\r\n(function (TraceFormat) {\r\n    TraceFormat[\"Text\"] = \"text\";\r\n    TraceFormat[\"JSON\"] = \"json\";\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\n(function (TraceFormat) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        if (value === 'json') {\r\n            return TraceFormat.JSON;\r\n        }\r\n        else {\r\n            return TraceFormat.Text;\r\n        }\r\n    }\r\n    TraceFormat.fromString = fromString;\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\nvar SetTraceNotification;\r\n(function (SetTraceNotification) {\r\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTraceNotification');\r\n})(SetTraceNotification = exports.SetTraceNotification || (exports.SetTraceNotification = {}));\r\nvar LogTraceNotification;\r\n(function (LogTraceNotification) {\r\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTraceNotification');\r\n})(LogTraceNotification = exports.LogTraceNotification || (exports.LogTraceNotification = {}));\r\nvar ConnectionErrors;\r\n(function (ConnectionErrors) {\r\n    /**\r\n     * The connection is closed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\r\n    /**\r\n     * The connection got disposed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\r\n    /**\r\n     * The connection is already in listening mode.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\r\n})(ConnectionErrors = exports.ConnectionErrors || (exports.ConnectionErrors = {}));\r\nclass ConnectionError extends Error {\r\n    constructor(code, message) {\r\n        super(message);\r\n        this.code = code;\r\n        Object.setPrototypeOf(this, ConnectionError.prototype);\r\n    }\r\n}\r\nexports.ConnectionError = ConnectionError;\r\nvar ConnectionStrategy;\r\n(function (ConnectionStrategy) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.cancelUndispatched);\r\n    }\r\n    ConnectionStrategy.is = is;\r\n})(ConnectionStrategy = exports.ConnectionStrategy || (exports.ConnectionStrategy = {}));\r\nvar ConnectionState;\r\n(function (ConnectionState) {\r\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\r\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\r\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\r\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\r\n})(ConnectionState || (ConnectionState = {}));\r\nfunction _createMessageConnection(messageReader, messageWriter, logger, strategy) {\r\n    let sequenceNumber = 0;\r\n    let notificationSquenceNumber = 0;\r\n    let unknownResponseSquenceNumber = 0;\r\n    const version = '2.0';\r\n    let starRequestHandler = undefined;\r\n    let requestHandlers = Object.create(null);\r\n    let starNotificationHandler = undefined;\r\n    let notificationHandlers = Object.create(null);\r\n    let timer;\r\n    let messageQueue = new linkedMap_1.LinkedMap();\r\n    let responsePromises = Object.create(null);\r\n    let requestTokens = Object.create(null);\r\n    let trace = Trace.Off;\r\n    let traceFormat = TraceFormat.Text;\r\n    let tracer;\r\n    let state = ConnectionState.New;\r\n    let errorEmitter = new events_1.Emitter();\r\n    let closeEmitter = new events_1.Emitter();\r\n    let unhandledNotificationEmitter = new events_1.Emitter();\r\n    let disposeEmitter = new events_1.Emitter();\r\n    function createRequestQueueKey(id) {\r\n        return 'req-' + id.toString();\r\n    }\r\n    function createResponseQueueKey(id) {\r\n        if (id === null) {\r\n            return 'res-unknown-' + (++unknownResponseSquenceNumber).toString();\r\n        }\r\n        else {\r\n            return 'res-' + id.toString();\r\n        }\r\n    }\r\n    function createNotificationQueueKey() {\r\n        return 'not-' + (++notificationSquenceNumber).toString();\r\n    }\r\n    function addMessageToQueue(queue, message) {\r\n        if (messages_1.isRequestMessage(message)) {\r\n            queue.set(createRequestQueueKey(message.id), message);\r\n        }\r\n        else if (messages_1.isResponseMessage(message)) {\r\n            queue.set(createResponseQueueKey(message.id), message);\r\n        }\r\n        else {\r\n            queue.set(createNotificationQueueKey(), message);\r\n        }\r\n    }\r\n    function cancelUndispatched(_message) {\r\n        return undefined;\r\n    }\r\n    function isListening() {\r\n        return state === ConnectionState.Listening;\r\n    }\r\n    function isClosed() {\r\n        return state === ConnectionState.Closed;\r\n    }\r\n    function isDisposed() {\r\n        return state === ConnectionState.Disposed;\r\n    }\r\n    function closeHandler() {\r\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\r\n            state = ConnectionState.Closed;\r\n            closeEmitter.fire(undefined);\r\n        }\r\n        // If the connection is disposed don't sent close events.\r\n    }\r\n    ;\r\n    function readErrorHandler(error) {\r\n        errorEmitter.fire([error, undefined, undefined]);\r\n    }\r\n    function writeErrorHandler(data) {\r\n        errorEmitter.fire(data);\r\n    }\r\n    messageReader.onClose(closeHandler);\r\n    messageReader.onError(readErrorHandler);\r\n    messageWriter.onClose(closeHandler);\r\n    messageWriter.onError(writeErrorHandler);\r\n    function triggerMessageQueue() {\r\n        if (timer || messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        timer = setImmediate(() => {\r\n            timer = undefined;\r\n            processMessageQueue();\r\n        });\r\n    }\r\n    function processMessageQueue() {\r\n        if (messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        let message = messageQueue.shift();\r\n        try {\r\n            if (messages_1.isRequestMessage(message)) {\r\n                handleRequest(message);\r\n            }\r\n            else if (messages_1.isNotificationMessage(message)) {\r\n                handleNotification(message);\r\n            }\r\n            else if (messages_1.isResponseMessage(message)) {\r\n                handleResponse(message);\r\n            }\r\n            else {\r\n                handleInvalidMessage(message);\r\n            }\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    }\r\n    let callback = (message) => {\r\n        try {\r\n            // We have received a cancellation message. Check if the message is still in the queue\r\n            // and cancel it if allowed to do so.\r\n            if (messages_1.isNotificationMessage(message) && message.method === CancelNotification.type.method) {\r\n                let key = createRequestQueueKey(message.params.id);\r\n                let toCancel = messageQueue.get(key);\r\n                if (messages_1.isRequestMessage(toCancel)) {\r\n                    let response = strategy && strategy.cancelUndispatched ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\r\n                    if (response && (response.error !== void 0 || response.result !== void 0)) {\r\n                        messageQueue.delete(key);\r\n                        response.id = toCancel.id;\r\n                        traceSendingResponse(response, message.method, Date.now());\r\n                        messageWriter.write(response);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            addMessageToQueue(messageQueue, message);\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    };\r\n    function handleRequest(requestMessage) {\r\n        if (isDisposed()) {\r\n            // we return here silently since we fired an event when the\r\n            // connection got disposed.\r\n            return;\r\n        }\r\n        function reply(resultOrError, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id\r\n            };\r\n            if (resultOrError instanceof messages_1.ResponseError) {\r\n                message.error = resultOrError.toJson();\r\n            }\r\n            else {\r\n                message.result = resultOrError === void 0 ? null : resultOrError;\r\n            }\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replyError(error, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                error: error.toJson()\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replySuccess(result, method, startTime) {\r\n            // The JSON RPC defines that a response must either have a result or an error\r\n            // So we can't treat undefined as a valid response result.\r\n            if (result === void 0) {\r\n                result = null;\r\n            }\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                result: result\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        traceReceivedRequest(requestMessage);\r\n        let element = requestHandlers[requestMessage.method];\r\n        let type;\r\n        let requestHandler;\r\n        if (element) {\r\n            type = element.type;\r\n            requestHandler = element.handler;\r\n        }\r\n        let startTime = Date.now();\r\n        if (requestHandler || starRequestHandler) {\r\n            let cancellationSource = new cancellation_1.CancellationTokenSource();\r\n            let tokenKey = String(requestMessage.id);\r\n            requestTokens[tokenKey] = cancellationSource;\r\n            try {\r\n                let handlerResult;\r\n                if (requestMessage.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, cancellationSource.token);\r\n                }\r\n                else if (Is.array(requestMessage.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(...requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, ...requestMessage.params, cancellationSource.token);\r\n                }\r\n                else {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\r\n                }\r\n                let promise = handlerResult;\r\n                if (!handlerResult) {\r\n                    delete requestTokens[tokenKey];\r\n                    replySuccess(handlerResult, requestMessage.method, startTime);\r\n                }\r\n                else if (promise.then) {\r\n                    promise.then((resultOrError) => {\r\n                        delete requestTokens[tokenKey];\r\n                        reply(resultOrError, requestMessage.method, startTime);\r\n                    }, error => {\r\n                        delete requestTokens[tokenKey];\r\n                        if (error instanceof messages_1.ResponseError) {\r\n                            replyError(error, requestMessage.method, startTime);\r\n                        }\r\n                        else if (error && Is.string(error.message)) {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                        }\r\n                        else {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    delete requestTokens[tokenKey];\r\n                    reply(handlerResult, requestMessage.method, startTime);\r\n                }\r\n            }\r\n            catch (error) {\r\n                delete requestTokens[tokenKey];\r\n                if (error instanceof messages_1.ResponseError) {\r\n                    reply(error, requestMessage.method, startTime);\r\n                }\r\n                else if (error && Is.string(error.message)) {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                }\r\n                else {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, `Unhandled method ${requestMessage.method}`), requestMessage.method, startTime);\r\n        }\r\n    }\r\n    function handleResponse(responseMessage) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        if (responseMessage.id === null) {\r\n            if (responseMessage.error) {\r\n                logger.error(`Received response message without id: Error is: \\n${JSON.stringify(responseMessage.error, undefined, 4)}`);\r\n            }\r\n            else {\r\n                logger.error(`Received response message without id. No further error information provided.`);\r\n            }\r\n        }\r\n        else {\r\n            let key = String(responseMessage.id);\r\n            let responsePromise = responsePromises[key];\r\n            traceReceivedResponse(responseMessage, responsePromise);\r\n            if (responsePromise) {\r\n                delete responsePromises[key];\r\n                try {\r\n                    if (responseMessage.error) {\r\n                        let error = responseMessage.error;\r\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\r\n                    }\r\n                    else if (responseMessage.result !== void 0) {\r\n                        responsePromise.resolve(responseMessage.result);\r\n                    }\r\n                    else {\r\n                        throw new Error('Should never happen.');\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    if (error.message) {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed with message: ${error.message}`);\r\n                    }\r\n                    else {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed unexpectedly.`);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleNotification(message) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        let type = undefined;\r\n        let notificationHandler;\r\n        if (message.method === CancelNotification.type.method) {\r\n            notificationHandler = (params) => {\r\n                let id = params.id;\r\n                let source = requestTokens[String(id)];\r\n                if (source) {\r\n                    source.cancel();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            let element = notificationHandlers[message.method];\r\n            if (element) {\r\n                notificationHandler = element.handler;\r\n                type = element.type;\r\n            }\r\n        }\r\n        if (notificationHandler || starNotificationHandler) {\r\n            try {\r\n                traceReceivedNotification(message);\r\n                if (message.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    notificationHandler ? notificationHandler() : starNotificationHandler(message.method);\r\n                }\r\n                else if (Is.array(message.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    notificationHandler ? notificationHandler(...message.params) : starNotificationHandler(message.method, ...message.params);\r\n                }\r\n                else {\r\n                    notificationHandler ? notificationHandler(message.params) : starNotificationHandler(message.method, message.params);\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (error.message) {\r\n                    logger.error(`Notification handler '${message.method}' failed with message: ${error.message}`);\r\n                }\r\n                else {\r\n                    logger.error(`Notification handler '${message.method}' failed unexpectedly.`);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            unhandledNotificationEmitter.fire(message);\r\n        }\r\n    }\r\n    function handleInvalidMessage(message) {\r\n        if (!message) {\r\n            logger.error('Received empty message.');\r\n            return;\r\n        }\r\n        logger.error(`Received message which is neither a response nor a notification message:\\n${JSON.stringify(message, null, 4)}`);\r\n        // Test whether we find an id to reject the promise\r\n        let responseMessage = message;\r\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\r\n            let key = String(responseMessage.id);\r\n            let responseHandler = responsePromises[key];\r\n            if (responseHandler) {\r\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\r\n            }\r\n        }\r\n    }\r\n    function traceSendingRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Sending request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-request', message);\r\n        }\r\n    }\r\n    function traceSendingNotification(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Sending notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-notification', message);\r\n        }\r\n    }\r\n    function traceSendingResponse(message, method, startTime) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            tracer.log(`Sending response '${method} - (${message.id})'. Processing request took ${Date.now() - startTime}ms`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-response', message);\r\n        }\r\n    }\r\n    function traceReceivedRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Received request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-request', message);\r\n        }\r\n    }\r\n    function traceReceivedNotification(message) {\r\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Received notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-notification', message);\r\n        }\r\n    }\r\n    function traceReceivedResponse(message, responsePromise) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            if (responsePromise) {\r\n                let error = message.error ? ` Request failed: ${message.error.message} (${message.error.code}).` : '';\r\n                tracer.log(`Received response '${responsePromise.method} - (${message.id})' in ${Date.now() - responsePromise.timerStart}ms.${error}`, data);\r\n            }\r\n            else {\r\n                tracer.log(`Received response ${message.id} without active response promise.`, data);\r\n            }\r\n        }\r\n        else {\r\n            logLSPMessage('receive-response', message);\r\n        }\r\n    }\r\n    function logLSPMessage(type, message) {\r\n        if (!tracer || trace === Trace.Off) {\r\n            return;\r\n        }\r\n        const lspMessage = {\r\n            isLSPMessage: true,\r\n            type,\r\n            message,\r\n            timestamp: Date.now()\r\n        };\r\n        tracer.log(lspMessage);\r\n    }\r\n    function throwIfClosedOrDisposed() {\r\n        if (isClosed()) {\r\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\r\n        }\r\n        if (isDisposed()) {\r\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\r\n        }\r\n    }\r\n    function throwIfListening() {\r\n        if (isListening()) {\r\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\r\n        }\r\n    }\r\n    function throwIfNotListening() {\r\n        if (!isListening()) {\r\n            throw new Error('Call listen() first.');\r\n        }\r\n    }\r\n    function undefinedToNull(param) {\r\n        if (param === void 0) {\r\n            return null;\r\n        }\r\n        else {\r\n            return param;\r\n        }\r\n    }\r\n    function computeMessageParams(type, params) {\r\n        let result;\r\n        let numberOfParams = type.numberOfParams;\r\n        switch (numberOfParams) {\r\n            case 0:\r\n                result = null;\r\n                break;\r\n            case 1:\r\n                result = undefinedToNull(params[0]);\r\n                break;\r\n            default:\r\n                result = [];\r\n                for (let i = 0; i < params.length && i < numberOfParams; i++) {\r\n                    result.push(undefinedToNull(params[i]));\r\n                }\r\n                if (params.length < numberOfParams) {\r\n                    for (let i = params.length; i < numberOfParams; i++) {\r\n                        result.push(null);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    let connection = {\r\n        sendNotification: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            let method;\r\n            let messageParams;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        messageParams = params[0];\r\n                        break;\r\n                    default:\r\n                        messageParams = params;\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n            }\r\n            let notificationMessage = {\r\n                jsonrpc: version,\r\n                method: method,\r\n                params: messageParams\r\n            };\r\n            traceSendingNotification(notificationMessage);\r\n            messageWriter.write(notificationMessage);\r\n        },\r\n        onNotification: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starNotificationHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    notificationHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    notificationHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        sendRequest: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfNotListening();\r\n            let method;\r\n            let messageParams;\r\n            let token = undefined;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        // The cancellation token is optional so it can also be undefined.\r\n                        if (cancellation_1.CancellationToken.is(params[0])) {\r\n                            messageParams = null;\r\n                            token = params[0];\r\n                        }\r\n                        else {\r\n                            messageParams = undefinedToNull(params[0]);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        const last = params.length - 1;\r\n                        if (cancellation_1.CancellationToken.is(params[last])) {\r\n                            token = params[last];\r\n                            if (params.length === 2) {\r\n                                messageParams = undefinedToNull(params[0]);\r\n                            }\r\n                            else {\r\n                                messageParams = params.slice(0, last).map(value => undefinedToNull(value));\r\n                            }\r\n                        }\r\n                        else {\r\n                            messageParams = params.map(value => undefinedToNull(value));\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n                let numberOfParams = type.numberOfParams;\r\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\r\n            }\r\n            let id = sequenceNumber++;\r\n            let result = new Promise((resolve, reject) => {\r\n                let requestMessage = {\r\n                    jsonrpc: version,\r\n                    id: id,\r\n                    method: method,\r\n                    params: messageParams\r\n                };\r\n                let responsePromise = { method: method, timerStart: Date.now(), resolve, reject };\r\n                traceSendingRequest(requestMessage);\r\n                try {\r\n                    messageWriter.write(requestMessage);\r\n                }\r\n                catch (e) {\r\n                    // Writing the message failed. So we need to reject the promise.\r\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, e.message ? e.message : 'Unknown reason'));\r\n                    responsePromise = null;\r\n                }\r\n                if (responsePromise) {\r\n                    responsePromises[String(id)] = responsePromise;\r\n                }\r\n            });\r\n            if (token) {\r\n                token.onCancellationRequested(() => {\r\n                    connection.sendNotification(CancelNotification.type, { id });\r\n                });\r\n            }\r\n            return result;\r\n        },\r\n        onRequest: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starRequestHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    requestHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    requestHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        trace: (_value, _tracer, sendNotificationOrTraceOptions) => {\r\n            let _sendNotification = false;\r\n            let _traceFormat = TraceFormat.Text;\r\n            if (sendNotificationOrTraceOptions !== void 0) {\r\n                if (Is.boolean(sendNotificationOrTraceOptions)) {\r\n                    _sendNotification = sendNotificationOrTraceOptions;\r\n                }\r\n                else {\r\n                    _sendNotification = sendNotificationOrTraceOptions.sendNotification || false;\r\n                    _traceFormat = sendNotificationOrTraceOptions.traceFormat || TraceFormat.Text;\r\n                }\r\n            }\r\n            trace = _value;\r\n            traceFormat = _traceFormat;\r\n            if (trace === Trace.Off) {\r\n                tracer = undefined;\r\n            }\r\n            else {\r\n                tracer = _tracer;\r\n            }\r\n            if (_sendNotification && !isClosed() && !isDisposed()) {\r\n                connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\r\n            }\r\n        },\r\n        onError: errorEmitter.event,\r\n        onClose: closeEmitter.event,\r\n        onUnhandledNotification: unhandledNotificationEmitter.event,\r\n        onDispose: disposeEmitter.event,\r\n        dispose: () => {\r\n            if (isDisposed()) {\r\n                return;\r\n            }\r\n            state = ConnectionState.Disposed;\r\n            disposeEmitter.fire(undefined);\r\n            let error = new Error('Connection got disposed.');\r\n            Object.keys(responsePromises).forEach((key) => {\r\n                responsePromises[key].reject(error);\r\n            });\r\n            responsePromises = Object.create(null);\r\n            requestTokens = Object.create(null);\r\n            messageQueue = new linkedMap_1.LinkedMap();\r\n            // Test for backwards compatibility\r\n            if (Is.func(messageWriter.dispose)) {\r\n                messageWriter.dispose();\r\n            }\r\n            if (Is.func(messageReader.dispose)) {\r\n                messageReader.dispose();\r\n            }\r\n        },\r\n        listen: () => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfListening();\r\n            state = ConnectionState.Listening;\r\n            messageReader.listen(callback);\r\n        },\r\n        inspect: () => {\r\n            console.log(\"inspect\");\r\n        }\r\n    };\r\n    connection.onNotification(LogTraceNotification.type, (params) => {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        tracer.log(params.message, trace === Trace.Verbose ? params.verbose : undefined);\r\n    });\r\n    return connection;\r\n}\r\nfunction isMessageReader(value) {\r\n    return value.listen !== void 0 && value.read === void 0;\r\n}\r\nfunction isMessageWriter(value) {\r\n    return value.write !== void 0 && value.end === void 0;\r\n}\r\nfunction createMessageConnection(input, output, logger, strategy) {\r\n    if (!logger) {\r\n        logger = exports.NullLogger;\r\n    }\r\n    let reader = isMessageReader(input) ? input : new messageReader_1.StreamMessageReader(input);\r\n    let writer = isMessageWriter(output) ? output : new messageWriter_1.StreamMessageWriter(output);\r\n    return _createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createMessageConnection = createMessageConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nexports.ErrorCodes = vscode_jsonrpc_1.ErrorCodes;\r\nexports.ResponseError = vscode_jsonrpc_1.ResponseError;\r\nexports.CancellationToken = vscode_jsonrpc_1.CancellationToken;\r\nexports.CancellationTokenSource = vscode_jsonrpc_1.CancellationTokenSource;\r\nexports.Disposable = vscode_jsonrpc_1.Disposable;\r\nexports.Event = vscode_jsonrpc_1.Event;\r\nexports.Emitter = vscode_jsonrpc_1.Emitter;\r\nexports.Trace = vscode_jsonrpc_1.Trace;\r\nexports.TraceFormat = vscode_jsonrpc_1.TraceFormat;\r\nexports.SetTraceNotification = vscode_jsonrpc_1.SetTraceNotification;\r\nexports.LogTraceNotification = vscode_jsonrpc_1.LogTraceNotification;\r\nexports.RequestType = vscode_jsonrpc_1.RequestType;\r\nexports.RequestType0 = vscode_jsonrpc_1.RequestType0;\r\nexports.NotificationType = vscode_jsonrpc_1.NotificationType;\r\nexports.NotificationType0 = vscode_jsonrpc_1.NotificationType0;\r\nexports.MessageReader = vscode_jsonrpc_1.MessageReader;\r\nexports.MessageWriter = vscode_jsonrpc_1.MessageWriter;\r\nexports.ConnectionStrategy = vscode_jsonrpc_1.ConnectionStrategy;\r\nexports.StreamMessageReader = vscode_jsonrpc_1.StreamMessageReader;\r\nexports.StreamMessageWriter = vscode_jsonrpc_1.StreamMessageWriter;\r\nexports.IPCMessageReader = vscode_jsonrpc_1.IPCMessageReader;\r\nexports.IPCMessageWriter = vscode_jsonrpc_1.IPCMessageWriter;\r\nexports.createClientPipeTransport = vscode_jsonrpc_1.createClientPipeTransport;\r\nexports.createServerPipeTransport = vscode_jsonrpc_1.createServerPipeTransport;\r\nexports.generateRandomPipeName = vscode_jsonrpc_1.generateRandomPipeName;\r\nexports.createClientSocketTransport = vscode_jsonrpc_1.createClientSocketTransport;\r\nexports.createServerSocketTransport = vscode_jsonrpc_1.createServerSocketTransport;\r\n__export(require(\"vscode-languageserver-types\"));\r\n__export(require(\"./protocol\"));\r\nfunction createProtocolConnection(reader, writer, logger, strategy) {\r\n    return vscode_jsonrpc_1.createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createProtocolConnection = createProtocolConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Disposable;\r\n(function (Disposable) {\r\n    function create(func) {\r\n        return {\r\n            dispose: func\r\n        };\r\n    }\r\n    Disposable.create = create;\r\n})(Disposable = exports.Disposable || (exports.Disposable = {}));\r\nvar Event;\r\n(function (Event) {\r\n    const _disposable = { dispose() { } };\r\n    Event.None = function () { return _disposable; };\r\n})(Event = exports.Event || (exports.Event = {}));\r\nclass CallbackList {\r\n    add(callback, context = null, bucket) {\r\n        if (!this._callbacks) {\r\n            this._callbacks = [];\r\n            this._contexts = [];\r\n        }\r\n        this._callbacks.push(callback);\r\n        this._contexts.push(context);\r\n        if (Array.isArray(bucket)) {\r\n            bucket.push({ dispose: () => this.remove(callback, context) });\r\n        }\r\n    }\r\n    remove(callback, context = null) {\r\n        if (!this._callbacks) {\r\n            return;\r\n        }\r\n        var foundCallbackWithDifferentContext = false;\r\n        for (var i = 0, len = this._callbacks.length; i < len; i++) {\r\n            if (this._callbacks[i] === callback) {\r\n                if (this._contexts[i] === context) {\r\n                    // callback & context match => remove it\r\n                    this._callbacks.splice(i, 1);\r\n                    this._contexts.splice(i, 1);\r\n                    return;\r\n                }\r\n                else {\r\n                    foundCallbackWithDifferentContext = true;\r\n                }\r\n            }\r\n        }\r\n        if (foundCallbackWithDifferentContext) {\r\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\r\n        }\r\n    }\r\n    invoke(...args) {\r\n        if (!this._callbacks) {\r\n            return [];\r\n        }\r\n        var ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\r\n        for (var i = 0, len = callbacks.length; i < len; i++) {\r\n            try {\r\n                ret.push(callbacks[i].apply(contexts[i], args));\r\n            }\r\n            catch (e) {\r\n                console.error(e);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    isEmpty() {\r\n        return !this._callbacks || this._callbacks.length === 0;\r\n    }\r\n    dispose() {\r\n        this._callbacks = undefined;\r\n        this._contexts = undefined;\r\n    }\r\n}\r\nclass Emitter {\r\n    constructor(_options) {\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * For the public to allow to subscribe\r\n     * to events from this Emitter\r\n     */\r\n    get event() {\r\n        if (!this._event) {\r\n            this._event = (listener, thisArgs, disposables) => {\r\n                if (!this._callbacks) {\r\n                    this._callbacks = new CallbackList();\r\n                }\r\n                if (this._options && this._options.onFirstListenerAdd && this._callbacks.isEmpty()) {\r\n                    this._options.onFirstListenerAdd(this);\r\n                }\r\n                this._callbacks.add(listener, thisArgs);\r\n                let result;\r\n                result = {\r\n                    dispose: () => {\r\n                        this._callbacks.remove(listener, thisArgs);\r\n                        result.dispose = Emitter._noop;\r\n                        if (this._options && this._options.onLastListenerRemove && this._callbacks.isEmpty()) {\r\n                            this._options.onLastListenerRemove(this);\r\n                        }\r\n                    }\r\n                };\r\n                if (Array.isArray(disposables)) {\r\n                    disposables.push(result);\r\n                }\r\n                return result;\r\n            };\r\n        }\r\n        return this._event;\r\n    }\r\n    /**\r\n     * To be kept private to fire an event to\r\n     * subscribers\r\n     */\r\n    fire(event) {\r\n        if (this._callbacks) {\r\n            this._callbacks.invoke.call(this._callbacks, event);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this._callbacks) {\r\n            this._callbacks.dispose();\r\n            this._callbacks = undefined;\r\n        }\r\n    }\r\n}\r\nEmitter._noop = function () { };\r\nexports.Emitter = Emitter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet DefaultSize = 8192;\r\nlet CR = Buffer.from('\\r', 'ascii')[0];\r\nlet LF = Buffer.from('\\n', 'ascii')[0];\r\nlet CRLF = '\\r\\n';\r\nclass MessageBuffer {\r\n    constructor(encoding = 'utf8') {\r\n        this.encoding = encoding;\r\n        this.index = 0;\r\n        this.buffer = Buffer.allocUnsafe(DefaultSize);\r\n    }\r\n    append(chunk) {\r\n        var toAppend = chunk;\r\n        if (typeof (chunk) === 'string') {\r\n            var str = chunk;\r\n            var bufferLen = Buffer.byteLength(str, this.encoding);\r\n            toAppend = Buffer.allocUnsafe(bufferLen);\r\n            toAppend.write(str, 0, bufferLen, this.encoding);\r\n        }\r\n        if (this.buffer.length - this.index >= toAppend.length) {\r\n            toAppend.copy(this.buffer, this.index, 0, toAppend.length);\r\n        }\r\n        else {\r\n            var newSize = (Math.ceil((this.index + toAppend.length) / DefaultSize) + 1) * DefaultSize;\r\n            if (this.index === 0) {\r\n                this.buffer = Buffer.allocUnsafe(newSize);\r\n                toAppend.copy(this.buffer, 0, 0, toAppend.length);\r\n            }\r\n            else {\r\n                this.buffer = Buffer.concat([this.buffer.slice(0, this.index), toAppend], newSize);\r\n            }\r\n        }\r\n        this.index += toAppend.length;\r\n    }\r\n    tryReadHeaders() {\r\n        let result = undefined;\r\n        let current = 0;\r\n        while (current + 3 < this.index && (this.buffer[current] !== CR || this.buffer[current + 1] !== LF || this.buffer[current + 2] !== CR || this.buffer[current + 3] !== LF)) {\r\n            current++;\r\n        }\r\n        // No header / body separator found (e.g CRLFCRLF)\r\n        if (current + 3 >= this.index) {\r\n            return result;\r\n        }\r\n        result = Object.create(null);\r\n        let headers = this.buffer.toString('ascii', 0, current).split(CRLF);\r\n        headers.forEach((header) => {\r\n            let index = header.indexOf(':');\r\n            if (index === -1) {\r\n                throw new Error('Message header must separate key and value using :');\r\n            }\r\n            let key = header.substr(0, index);\r\n            let value = header.substr(index + 1).trim();\r\n            result[key] = value;\r\n        });\r\n        let nextStart = current + 4;\r\n        this.buffer = this.buffer.slice(nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    tryReadContent(length) {\r\n        if (this.index < length) {\r\n            return null;\r\n        }\r\n        let result = this.buffer.toString(this.encoding, 0, length);\r\n        let nextStart = length;\r\n        this.buffer.copy(this.buffer, 0, nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    get numberOfBytes() {\r\n        return this.index;\r\n    }\r\n}\r\nvar MessageReader;\r\n(function (MessageReader) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\r\n    }\r\n    MessageReader.is = is;\r\n})(MessageReader = exports.MessageReader || (exports.MessageReader = {}));\r\nclass AbstractMessageReader {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n        this.partialMessageEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error) {\r\n        this.errorEmitter.fire(this.asError(error));\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    get onPartialMessage() {\r\n        return this.partialMessageEmitter.event;\r\n    }\r\n    firePartialMessage(info) {\r\n        this.partialMessageEmitter.fire(info);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Reader recevied error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageReader = AbstractMessageReader;\r\nclass StreamMessageReader extends AbstractMessageReader {\r\n    constructor(readable, encoding = 'utf8') {\r\n        super();\r\n        this.readable = readable;\r\n        this.buffer = new MessageBuffer(encoding);\r\n        this._partialMessageTimeout = 10000;\r\n    }\r\n    set partialMessageTimeout(timeout) {\r\n        this._partialMessageTimeout = timeout;\r\n    }\r\n    get partialMessageTimeout() {\r\n        return this._partialMessageTimeout;\r\n    }\r\n    listen(callback) {\r\n        this.nextMessageLength = -1;\r\n        this.messageToken = 0;\r\n        this.partialMessageTimer = undefined;\r\n        this.callback = callback;\r\n        this.readable.on('data', (data) => {\r\n            this.onData(data);\r\n        });\r\n        this.readable.on('error', (error) => this.fireError(error));\r\n        this.readable.on('close', () => this.fireClose());\r\n    }\r\n    onData(data) {\r\n        this.buffer.append(data);\r\n        while (true) {\r\n            if (this.nextMessageLength === -1) {\r\n                let headers = this.buffer.tryReadHeaders();\r\n                if (!headers) {\r\n                    return;\r\n                }\r\n                let contentLength = headers['Content-Length'];\r\n                if (!contentLength) {\r\n                    throw new Error('Header must provide a Content-Length property.');\r\n                }\r\n                let length = parseInt(contentLength);\r\n                if (isNaN(length)) {\r\n                    throw new Error('Content-Length value must be a number.');\r\n                }\r\n                this.nextMessageLength = length;\r\n                // Take the encoding form the header. For compatibility\r\n                // treat both utf-8 and utf8 as node utf8\r\n            }\r\n            var msg = this.buffer.tryReadContent(this.nextMessageLength);\r\n            if (msg === null) {\r\n                /** We haven't recevied the full message yet. */\r\n                this.setPartialMessageTimer();\r\n                return;\r\n            }\r\n            this.clearPartialMessageTimer();\r\n            this.nextMessageLength = -1;\r\n            this.messageToken++;\r\n            var json = JSON.parse(msg);\r\n            this.callback(json);\r\n        }\r\n    }\r\n    clearPartialMessageTimer() {\r\n        if (this.partialMessageTimer) {\r\n            clearTimeout(this.partialMessageTimer);\r\n            this.partialMessageTimer = undefined;\r\n        }\r\n    }\r\n    setPartialMessageTimer() {\r\n        this.clearPartialMessageTimer();\r\n        if (this._partialMessageTimeout <= 0) {\r\n            return;\r\n        }\r\n        this.partialMessageTimer = setTimeout((token, timeout) => {\r\n            this.partialMessageTimer = undefined;\r\n            if (token === this.messageToken) {\r\n                this.firePartialMessage({ messageToken: token, waitingTime: timeout });\r\n                this.setPartialMessageTimer();\r\n            }\r\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\r\n    }\r\n}\r\nexports.StreamMessageReader = StreamMessageReader;\r\nclass IPCMessageReader extends AbstractMessageReader {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose());\r\n    }\r\n    listen(callback) {\r\n        this.process.on('message', callback);\r\n    }\r\n}\r\nexports.IPCMessageReader = IPCMessageReader;\r\nclass SocketMessageReader extends StreamMessageReader {\r\n    constructor(socket, encoding = 'utf-8') {\r\n        super(socket, encoding);\r\n    }\r\n}\r\nexports.SocketMessageReader = SocketMessageReader;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet ContentLength = 'Content-Length: ';\r\nlet CRLF = '\\r\\n';\r\nvar MessageWriter;\r\n(function (MessageWriter) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.write);\r\n    }\r\n    MessageWriter.is = is;\r\n})(MessageWriter = exports.MessageWriter || (exports.MessageWriter = {}));\r\nclass AbstractMessageWriter {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error, message, count) {\r\n        this.errorEmitter.fire([this.asError(error), message, count]);\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Writer recevied error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageWriter = AbstractMessageWriter;\r\nclass StreamMessageWriter extends AbstractMessageWriter {\r\n    constructor(writable, encoding = 'utf8') {\r\n        super();\r\n        this.writable = writable;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.writable.on('error', (error) => this.fireError(error));\r\n        this.writable.on('close', () => this.fireClose());\r\n    }\r\n    write(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.writable.write(headers.join(''), 'ascii');\r\n            // Now write the content. This can be written in any encoding\r\n            this.writable.write(json, this.encoding);\r\n            this.errorCount = 0;\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.StreamMessageWriter = StreamMessageWriter;\r\nclass IPCMessageWriter extends AbstractMessageWriter {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        this.errorCount = 0;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose);\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        try {\r\n            if (this.process.send) {\r\n                this.sending = true;\r\n                this.process.send(msg, undefined, undefined, (error) => {\r\n                    this.sending = false;\r\n                    if (error) {\r\n                        this.errorCount++;\r\n                        this.fireError(error, msg, this.errorCount);\r\n                    }\r\n                    else {\r\n                        this.errorCount = 0;\r\n                    }\r\n                    if (this.queue.length > 0) {\r\n                        this.doWriteMessage(this.queue.shift());\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.IPCMessageWriter = IPCMessageWriter;\r\nclass SocketMessageWriter extends AbstractMessageWriter {\r\n    constructor(socket, encoding = 'utf8') {\r\n        super();\r\n        this.socket = socket;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.socket.on('error', (error) => this.fireError(error));\r\n        this.socket.on('close', () => this.fireClose());\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.sending = true;\r\n            this.socket.write(headers.join(''), 'ascii', (error) => {\r\n                if (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n                try {\r\n                    // Now write the content. This can be written in any encoding\r\n                    this.socket.write(json, this.encoding, (error) => {\r\n                        this.sending = false;\r\n                        if (error) {\r\n                            this.handleError(error, msg);\r\n                        }\r\n                        else {\r\n                            this.errorCount = 0;\r\n                        }\r\n                        if (this.queue.length > 0) {\r\n                            this.doWriteMessage(this.queue.shift());\r\n                        }\r\n                    });\r\n                }\r\n                catch (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            this.handleError(error, msg);\r\n        }\r\n    }\r\n    handleError(error, msg) {\r\n        this.errorCount++;\r\n        this.fireError(error, msg, this.errorCount);\r\n    }\r\n}\r\nexports.SocketMessageWriter = SocketMessageWriter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"./thenable.ts\" />\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nexports.Event = vscode_languageserver_protocol_1.Event;\r\nconst configuration_1 = require(\"./configuration\");\r\nconst workspaceFolders_1 = require(\"./workspaceFolders\");\r\nconst Is = require(\"./utils/is\");\r\nconst UUID = require(\"./utils/uuid\");\r\n// ------------- Reexport the API surface of the language worker API ----------------------\r\n__export(require(\"vscode-languageserver-protocol\"));\r\nconst fm = require(\"./files\");\r\nvar Files;\r\n(function (Files) {\r\n    Files.uriToFilePath = fm.uriToFilePath;\r\n    Files.resolveGlobalNodePath = fm.resolveGlobalNodePath;\r\n    Files.resolveGlobalYarnPath = fm.resolveGlobalYarnPath;\r\n    Files.resolve = fm.resolve;\r\n    Files.resolveModule = fm.resolveModule;\r\n    Files.resolveModule2 = fm.resolveModule2;\r\n    Files.resolveModulePath = fm.resolveModulePath;\r\n})(Files = exports.Files || (exports.Files = {}));\r\nlet shutdownReceived = false;\r\nlet exitTimer = undefined;\r\nfunction setupExitTimer() {\r\n    const argName = '--clientProcessId';\r\n    function runTimer(value) {\r\n        try {\r\n            let processId = parseInt(value);\r\n            if (!isNaN(processId)) {\r\n                exitTimer = setInterval(() => {\r\n                    try {\r\n                        process.kill(processId, 0);\r\n                    }\r\n                    catch (ex) {\r\n                        // Parent process doesn't exist anymore. Exit the server.\r\n                        process.exit(shutdownReceived ? 0 : 1);\r\n                    }\r\n                }, 3000);\r\n            }\r\n        }\r\n        catch (e) {\r\n            // Ignore errors;\r\n        }\r\n    }\r\n    for (let i = 2; i < process.argv.length; i++) {\r\n        let arg = process.argv[i];\r\n        if (arg === argName && i + 1 < process.argv.length) {\r\n            runTimer(process.argv[i + 1]);\r\n            return;\r\n        }\r\n        else {\r\n            let args = arg.split('=');\r\n            if (args[0] === argName) {\r\n                runTimer(args[1]);\r\n            }\r\n        }\r\n    }\r\n}\r\nsetupExitTimer();\r\nfunction null2Undefined(value) {\r\n    if (value === null) {\r\n        return void 0;\r\n    }\r\n    return value;\r\n}\r\n/**\r\n * A manager for simple text documents\r\n */\r\nclass TextDocuments {\r\n    /**\r\n     * Create a new text document manager.\r\n     */\r\n    constructor() {\r\n        this._documents = Object.create(null);\r\n        this._onDidChangeContent = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidOpen = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidClose = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onDidSave = new vscode_languageserver_protocol_1.Emitter();\r\n        this._onWillSave = new vscode_languageserver_protocol_1.Emitter();\r\n    }\r\n    /**\r\n     * Returns the [TextDocumentSyncKind](#TextDocumentSyncKind) used by\r\n     * this text document manager.\r\n     */\r\n    get syncKind() {\r\n        return vscode_languageserver_protocol_1.TextDocumentSyncKind.Full;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been opened or the content changes.\r\n     */\r\n    get onDidChangeContent() {\r\n        return this._onDidChangeContent.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been opened.\r\n     */\r\n    get onDidOpen() {\r\n        return this._onDidOpen.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * will be saved.\r\n     */\r\n    get onWillSave() {\r\n        return this._onWillSave.event;\r\n    }\r\n    /**\r\n     * Sets a handler that will be called if a participant wants to provide\r\n     * edits during a text document save.\r\n     */\r\n    onWillSaveWaitUntil(handler) {\r\n        this._willSaveWaitUntil = handler;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been saved.\r\n     */\r\n    get onDidSave() {\r\n        return this._onDidSave.event;\r\n    }\r\n    /**\r\n     * An event that fires when a text document managed by this manager\r\n     * has been closed.\r\n     */\r\n    get onDidClose() {\r\n        return this._onDidClose.event;\r\n    }\r\n    /**\r\n     * Returns the document for the given URI. Returns undefined if\r\n     * the document is not mananged by this instance.\r\n     *\r\n     * @param uri The text document's URI to retrieve.\r\n     * @return the text document or `undefined`.\r\n     */\r\n    get(uri) {\r\n        return this._documents[uri];\r\n    }\r\n    /**\r\n     * Returns all text documents managed by this instance.\r\n     *\r\n     * @return all text documents.\r\n     */\r\n    all() {\r\n        return Object.keys(this._documents).map(key => this._documents[key]);\r\n    }\r\n    /**\r\n     * Returns the URIs of all text documents managed by this instance.\r\n     *\r\n     * @return the URI's of all text documents.\r\n     */\r\n    keys() {\r\n        return Object.keys(this._documents);\r\n    }\r\n    /**\r\n     * Listens for `low level` notification on the given connection to\r\n     * update the text documents managed by this instance.\r\n     *\r\n     * @param connection The connection to listen on.\r\n     */\r\n    listen(connection) {\r\n        function isUpdateableDocument(value) {\r\n            return Is.func(value.update);\r\n        }\r\n        connection.__textDocumentSync = vscode_languageserver_protocol_1.TextDocumentSyncKind.Full;\r\n        connection.onDidOpenTextDocument((event) => {\r\n            let td = event.textDocument;\r\n            let document = vscode_languageserver_protocol_1.TextDocument.create(td.uri, td.languageId, td.version, td.text);\r\n            this._documents[td.uri] = document;\r\n            let toFire = Object.freeze({ document });\r\n            this._onDidOpen.fire(toFire);\r\n            this._onDidChangeContent.fire(toFire);\r\n        });\r\n        connection.onDidChangeTextDocument((event) => {\r\n            let td = event.textDocument;\r\n            let changes = event.contentChanges;\r\n            let last = changes.length > 0 ? changes[changes.length - 1] : undefined;\r\n            if (last) {\r\n                let document = this._documents[td.uri];\r\n                if (document && isUpdateableDocument(document)) {\r\n                    if (td.version === null || td.version === void 0) {\r\n                        throw new Error(`Received document change event for ${td.uri} without valid version identifier`);\r\n                    }\r\n                    document.update(last, td.version);\r\n                    this._onDidChangeContent.fire(Object.freeze({ document }));\r\n                }\r\n            }\r\n        });\r\n        connection.onDidCloseTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                delete this._documents[event.textDocument.uri];\r\n                this._onDidClose.fire(Object.freeze({ document }));\r\n            }\r\n        });\r\n        connection.onWillSaveTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                this._onWillSave.fire(Object.freeze({ document, reason: event.reason }));\r\n            }\r\n        });\r\n        connection.onWillSaveTextDocumentWaitUntil((event, token) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document && this._willSaveWaitUntil) {\r\n                return this._willSaveWaitUntil(Object.freeze({ document, reason: event.reason }), token);\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        });\r\n        connection.onDidSaveTextDocument((event) => {\r\n            let document = this._documents[event.textDocument.uri];\r\n            if (document) {\r\n                this._onDidSave.fire(Object.freeze({ document }));\r\n            }\r\n        });\r\n    }\r\n}\r\nexports.TextDocuments = TextDocuments;\r\n/**\r\n * Helps tracking error message. Equal occurences of the same\r\n * message are only stored once. This class is for example\r\n * useful if text documents are validated in a loop and equal\r\n * error message should be folded into one.\r\n */\r\nclass ErrorMessageTracker {\r\n    constructor() {\r\n        this._messages = Object.create(null);\r\n    }\r\n    /**\r\n     * Add a message to the tracker.\r\n     *\r\n     * @param message The message to add.\r\n     */\r\n    add(message) {\r\n        let count = this._messages[message];\r\n        if (!count) {\r\n            count = 0;\r\n        }\r\n        count++;\r\n        this._messages[message] = count;\r\n    }\r\n    /**\r\n     * Send all tracked messages to the connection's window.\r\n     *\r\n     * @param connection The connection established between client and server.\r\n     */\r\n    sendErrors(connection) {\r\n        Object.keys(this._messages).forEach(message => {\r\n            connection.window.showErrorMessage(message);\r\n        });\r\n    }\r\n}\r\nexports.ErrorMessageTracker = ErrorMessageTracker;\r\nvar BulkRegistration;\r\n(function (BulkRegistration) {\r\n    /**\r\n     * Creates a new bulk registration.\r\n     * @return an empty bulk registration.\r\n     */\r\n    function create() {\r\n        return new BulkRegistrationImpl();\r\n    }\r\n    BulkRegistration.create = create;\r\n})(BulkRegistration = exports.BulkRegistration || (exports.BulkRegistration = {}));\r\nclass BulkRegistrationImpl {\r\n    constructor() {\r\n        this._registrations = [];\r\n        this._registered = new Set();\r\n    }\r\n    add(type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        if (this._registered.has(method)) {\r\n            throw new Error(`${method} is already added to this registration`);\r\n        }\r\n        const id = UUID.generateUuid();\r\n        this._registrations.push({\r\n            id: id,\r\n            method: method,\r\n            registerOptions: registerOptions || {}\r\n        });\r\n        this._registered.add(method);\r\n    }\r\n    asRegistrationParams() {\r\n        return {\r\n            registrations: this._registrations\r\n        };\r\n    }\r\n}\r\nvar BulkUnregistration;\r\n(function (BulkUnregistration) {\r\n    function create() {\r\n        return new BulkUnregistrationImpl(undefined, []);\r\n    }\r\n    BulkUnregistration.create = create;\r\n})(BulkUnregistration = exports.BulkUnregistration || (exports.BulkUnregistration = {}));\r\nclass BulkUnregistrationImpl {\r\n    constructor(_connection, unregistrations) {\r\n        this._connection = _connection;\r\n        this._unregistrations = new Map();\r\n        unregistrations.forEach(unregistration => {\r\n            this._unregistrations.set(unregistration.method, unregistration);\r\n        });\r\n    }\r\n    get isAttached() {\r\n        return !!this._connection;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    add(unregistration) {\r\n        this._unregistrations.set(unregistration.method, unregistration);\r\n    }\r\n    dispose() {\r\n        let unregistrations = [];\r\n        for (let unregistration of this._unregistrations.values()) {\r\n            unregistrations.push(unregistration);\r\n        }\r\n        let params = {\r\n            unregisterations: unregistrations\r\n        };\r\n        this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(undefined, (_error) => {\r\n            this._connection.console.info(`Bulk unregistration failed.`);\r\n        });\r\n    }\r\n    disposeSingle(arg) {\r\n        const method = Is.string(arg) ? arg : arg.method;\r\n        const unregistration = this._unregistrations.get(method);\r\n        if (!unregistration) {\r\n            return false;\r\n        }\r\n        let params = {\r\n            unregisterations: [unregistration]\r\n        };\r\n        this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(() => {\r\n            this._unregistrations.delete(method);\r\n        }, (_error) => {\r\n            this._connection.console.info(`Unregistering request handler for ${unregistration.id} failed.`);\r\n        });\r\n        return true;\r\n    }\r\n}\r\nclass ConnectionLogger {\r\n    constructor() {\r\n    }\r\n    rawAttach(connection) {\r\n        this._rawConnection = connection;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    error(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Error, message);\r\n    }\r\n    warn(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Warning, message);\r\n    }\r\n    info(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Info, message);\r\n    }\r\n    log(message) {\r\n        this.send(vscode_languageserver_protocol_1.MessageType.Log, message);\r\n    }\r\n    send(type, message) {\r\n        if (this._rawConnection) {\r\n            this._rawConnection.sendNotification(vscode_languageserver_protocol_1.LogMessageNotification.type, { type, message });\r\n        }\r\n    }\r\n}\r\nclass RemoteWindowImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    showErrorMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Error, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n    showWarningMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Warning, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n    showInformationMessage(message, ...actions) {\r\n        let params = { type: vscode_languageserver_protocol_1.MessageType.Info, message, actions };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, params).then(null2Undefined);\r\n    }\r\n}\r\nclass RemoteClientImpl {\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    register(typeOrRegistrations, registerOptionsOrType, registerOptions) {\r\n        if (typeOrRegistrations instanceof BulkRegistrationImpl) {\r\n            return this.registerMany(typeOrRegistrations);\r\n        }\r\n        else if (typeOrRegistrations instanceof BulkUnregistrationImpl) {\r\n            return this.registerSingle1(typeOrRegistrations, registerOptionsOrType, registerOptions);\r\n        }\r\n        else {\r\n            return this.registerSingle2(typeOrRegistrations, registerOptionsOrType);\r\n        }\r\n    }\r\n    registerSingle1(unregistration, type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        const id = UUID.generateUuid();\r\n        let params = {\r\n            registrations: [{ id, method, registerOptions: registerOptions || {} }]\r\n        };\r\n        if (!unregistration.isAttached) {\r\n            unregistration.attach(this._connection);\r\n        }\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then((_result) => {\r\n            unregistration.add({ id: id, method: method });\r\n            return unregistration;\r\n        }, (_error) => {\r\n            this.connection.console.info(`Registering request handler for ${method} failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n    registerSingle2(type, registerOptions) {\r\n        const method = Is.string(type) ? type : type.method;\r\n        const id = UUID.generateUuid();\r\n        let params = {\r\n            registrations: [{ id, method, registerOptions: registerOptions || {} }]\r\n        };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then((_result) => {\r\n            return vscode_languageserver_protocol_1.Disposable.create(() => {\r\n                this.unregisterSingle(id, method);\r\n            });\r\n        }, (_error) => {\r\n            this.connection.console.info(`Registering request handler for ${method} failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n    unregisterSingle(id, method) {\r\n        let params = {\r\n            unregisterations: [{ id, method }]\r\n        };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params).then(undefined, (_error) => {\r\n            this.connection.console.info(`Unregistering request handler for ${id} failed.`);\r\n        });\r\n    }\r\n    registerMany(registrations) {\r\n        let params = registrations.asRegistrationParams();\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params).then(() => {\r\n            return new BulkUnregistrationImpl(this._connection, params.registrations.map(registration => { return { id: registration.id, method: registration.method }; }));\r\n        }, (_error) => {\r\n            this.connection.console.info(`Bulk registration failed.`);\r\n            return Promise.reject(_error);\r\n        });\r\n    }\r\n}\r\nclass _RemoteWorkspaceImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    applyEdit(paramOrEdit) {\r\n        function isApplyWorkspaceEditParams(value) {\r\n            return value && !!value.edit;\r\n        }\r\n        let params = isApplyWorkspaceEditParams(paramOrEdit) ? paramOrEdit : { edit: paramOrEdit };\r\n        return this._connection.sendRequest(vscode_languageserver_protocol_1.ApplyWorkspaceEditRequest.type, params);\r\n    }\r\n}\r\nconst RemoteWorkspaceImpl = workspaceFolders_1.WorkspaceFoldersFeature(configuration_1.ConfigurationFeature(_RemoteWorkspaceImpl));\r\nclass TracerImpl {\r\n    constructor() {\r\n        this._trace = vscode_languageserver_protocol_1.Trace.Off;\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    set trace(value) {\r\n        this._trace = value;\r\n    }\r\n    log(message, verbose) {\r\n        if (this._trace === vscode_languageserver_protocol_1.Trace.Off) {\r\n            return;\r\n        }\r\n        this._connection.sendNotification(vscode_languageserver_protocol_1.LogTraceNotification.type, {\r\n            message: message,\r\n            verbose: this._trace === vscode_languageserver_protocol_1.Trace.Verbose ? verbose : undefined\r\n        });\r\n    }\r\n}\r\nclass TelemetryImpl {\r\n    constructor() {\r\n    }\r\n    attach(connection) {\r\n        this._connection = connection;\r\n    }\r\n    get connection() {\r\n        if (!this._connection) {\r\n            throw new Error('Remote is not attached to a connection yet.');\r\n        }\r\n        return this._connection;\r\n    }\r\n    initialize(_capabilities) {\r\n    }\r\n    fillServerCapabilities(_capabilities) {\r\n    }\r\n    logEvent(data) {\r\n        this._connection.sendNotification(vscode_languageserver_protocol_1.TelemetryEventNotification.type, data);\r\n    }\r\n}\r\nfunction combineConsoleFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineConsoleFeatures = combineConsoleFeatures;\r\nfunction combineTelemetryFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineTelemetryFeatures = combineTelemetryFeatures;\r\nfunction combineTracerFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineTracerFeatures = combineTracerFeatures;\r\nfunction combineClientFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineClientFeatures = combineClientFeatures;\r\nfunction combineWindowFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineWindowFeatures = combineWindowFeatures;\r\nfunction combineWorkspaceFeatures(one, two) {\r\n    return function (Base) {\r\n        return two(one(Base));\r\n    };\r\n}\r\nexports.combineWorkspaceFeatures = combineWorkspaceFeatures;\r\nfunction combineFeatures(one, two) {\r\n    function combine(one, two, func) {\r\n        if (one && two) {\r\n            return func(one, two);\r\n        }\r\n        else if (one) {\r\n            return one;\r\n        }\r\n        else {\r\n            return two;\r\n        }\r\n    }\r\n    let result = {\r\n        __brand: 'features',\r\n        console: combine(one.console, two.console, combineConsoleFeatures),\r\n        tracer: combine(one.tracer, two.tracer, combineTracerFeatures),\r\n        telemetry: combine(one.telemetry, two.telemetry, combineTelemetryFeatures),\r\n        client: combine(one.client, two.client, combineClientFeatures),\r\n        window: combine(one.window, two.window, combineWindowFeatures),\r\n        workspace: combine(one.workspace, two.workspace, combineWorkspaceFeatures)\r\n    };\r\n    return result;\r\n}\r\nexports.combineFeatures = combineFeatures;\r\nfunction createConnection(arg1, arg2, arg3, arg4) {\r\n    let factories;\r\n    let input;\r\n    let output;\r\n    let strategy;\r\n    if (arg1 !== void 0 && arg1.__brand === 'features') {\r\n        factories = arg1;\r\n        arg1 = arg2;\r\n        arg2 = arg3;\r\n        arg3 = arg4;\r\n    }\r\n    if (vscode_languageserver_protocol_1.ConnectionStrategy.is(arg1)) {\r\n        strategy = arg1;\r\n    }\r\n    else {\r\n        input = arg1;\r\n        output = arg2;\r\n        strategy = arg3;\r\n    }\r\n    return _createConnection(input, output, strategy, factories);\r\n}\r\nexports.createConnection = createConnection;\r\nfunction _createConnection(input, output, strategy, factories) {\r\n    if (!input && !output && process.argv.length > 2) {\r\n        let port = void 0;\r\n        let pipeName = void 0;\r\n        let argv = process.argv.slice(2);\r\n        for (let i = 0; i < argv.length; i++) {\r\n            let arg = argv[i];\r\n            if (arg === '--node-ipc') {\r\n                input = new vscode_languageserver_protocol_1.IPCMessageReader(process);\r\n                output = new vscode_languageserver_protocol_1.IPCMessageWriter(process);\r\n                break;\r\n            }\r\n            else if (arg === '--stdio') {\r\n                input = process.stdin;\r\n                output = process.stdout;\r\n                break;\r\n            }\r\n            else if (arg === '--socket') {\r\n                port = parseInt(argv[i + 1]);\r\n                break;\r\n            }\r\n            else if (arg === '--pipe') {\r\n                pipeName = argv[i + 1];\r\n                break;\r\n            }\r\n            else {\r\n                var args = arg.split('=');\r\n                if (args[0] === '--socket') {\r\n                    port = parseInt(args[1]);\r\n                    break;\r\n                }\r\n                else if (args[0] === '--pipe') {\r\n                    pipeName = args[1];\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        if (port) {\r\n            let transport = vscode_languageserver_protocol_1.createServerSocketTransport(port);\r\n            input = transport[0];\r\n            output = transport[1];\r\n        }\r\n        else if (pipeName) {\r\n            let transport = vscode_languageserver_protocol_1.createServerPipeTransport(pipeName);\r\n            input = transport[0];\r\n            output = transport[1];\r\n        }\r\n    }\r\n    var commandLineMessage = \"Use arguments of createConnection or set command line parameters: '--node-ipc', '--stdio' or '--socket={number}'\";\r\n    if (!input) {\r\n        throw new Error(\"Connection input stream is not set. \" + commandLineMessage);\r\n    }\r\n    if (!output) {\r\n        throw new Error(\"Connection output stream is not set. \" + commandLineMessage);\r\n    }\r\n    // Backwards compatibility\r\n    if (Is.func(input.read) && Is.func(input.on)) {\r\n        let inputStream = input;\r\n        inputStream.on('end', () => {\r\n            process.exit(shutdownReceived ? 0 : 1);\r\n        });\r\n        inputStream.on('close', () => {\r\n            process.exit(shutdownReceived ? 0 : 1);\r\n        });\r\n    }\r\n    const logger = (factories && factories.console ? new (factories.console(ConnectionLogger))() : new ConnectionLogger());\r\n    const connection = vscode_languageserver_protocol_1.createProtocolConnection(input, output, logger, strategy);\r\n    logger.rawAttach(connection);\r\n    const tracer = (factories && factories.tracer ? new (factories.tracer(TracerImpl))() : new TracerImpl());\r\n    const telemetry = (factories && factories.telemetry ? new (factories.telemetry(TelemetryImpl))() : new TelemetryImpl());\r\n    const client = (factories && factories.client ? new (factories.client(RemoteClientImpl))() : new RemoteClientImpl());\r\n    const remoteWindow = (factories && factories.window ? new (factories.window(RemoteWindowImpl))() : new RemoteWindowImpl());\r\n    const workspace = (factories && factories.workspace ? new (factories.workspace(RemoteWorkspaceImpl))() : new RemoteWorkspaceImpl());\r\n    const allRemotes = [logger, tracer, telemetry, client, remoteWindow, workspace];\r\n    function asThenable(value) {\r\n        if (Is.thenable(value)) {\r\n            return value;\r\n        }\r\n        else {\r\n            return Promise.resolve(value);\r\n        }\r\n    }\r\n    let shutdownHandler = undefined;\r\n    let initializeHandler = undefined;\r\n    let exitHandler = undefined;\r\n    let protocolConnection = {\r\n        listen: () => connection.listen(),\r\n        sendRequest: (type, ...params) => connection.sendRequest(Is.string(type) ? type : type.method, ...params),\r\n        onRequest: (type, handler) => connection.onRequest(type, handler),\r\n        sendNotification: (type, param) => {\r\n            const method = Is.string(type) ? type : type.method;\r\n            if (arguments.length === 1) {\r\n                connection.sendNotification(method);\r\n            }\r\n            else {\r\n                connection.sendNotification(method, param);\r\n            }\r\n        },\r\n        onNotification: (type, handler) => connection.onNotification(type, handler),\r\n        onInitialize: (handler) => initializeHandler = handler,\r\n        onInitialized: (handler) => connection.onNotification(vscode_languageserver_protocol_1.InitializedNotification.type, handler),\r\n        onShutdown: (handler) => shutdownHandler = handler,\r\n        onExit: (handler) => exitHandler = handler,\r\n        get console() { return logger; },\r\n        get telemetry() { return telemetry; },\r\n        get tracer() { return tracer; },\r\n        get client() { return client; },\r\n        get window() { return remoteWindow; },\r\n        get workspace() { return workspace; },\r\n        onDidChangeConfiguration: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type, handler),\r\n        onDidChangeWatchedFiles: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeWatchedFilesNotification.type, handler),\r\n        __textDocumentSync: undefined,\r\n        onDidOpenTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidOpenTextDocumentNotification.type, handler),\r\n        onDidChangeTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, handler),\r\n        onDidCloseTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidCloseTextDocumentNotification.type, handler),\r\n        onWillSaveTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.WillSaveTextDocumentNotification.type, handler),\r\n        onWillSaveTextDocumentWaitUntil: (handler) => connection.onRequest(vscode_languageserver_protocol_1.WillSaveTextDocumentWaitUntilRequest.type, handler),\r\n        onDidSaveTextDocument: (handler) => connection.onNotification(vscode_languageserver_protocol_1.DidSaveTextDocumentNotification.type, handler),\r\n        sendDiagnostics: (params) => connection.sendNotification(vscode_languageserver_protocol_1.PublishDiagnosticsNotification.type, params),\r\n        onHover: (handler) => connection.onRequest(vscode_languageserver_protocol_1.HoverRequest.type, handler),\r\n        onCompletion: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CompletionRequest.type, handler),\r\n        onCompletionResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CompletionResolveRequest.type, handler),\r\n        onSignatureHelp: (handler) => connection.onRequest(vscode_languageserver_protocol_1.SignatureHelpRequest.type, handler),\r\n        onDeclaration: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DeclarationRequest.type, handler),\r\n        onDefinition: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DefinitionRequest.type, handler),\r\n        onTypeDefinition: (handler) => connection.onRequest(vscode_languageserver_protocol_1.TypeDefinitionRequest.type, handler),\r\n        onImplementation: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ImplementationRequest.type, handler),\r\n        onReferences: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ReferencesRequest.type, handler),\r\n        onDocumentHighlight: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentHighlightRequest.type, handler),\r\n        onDocumentSymbol: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentSymbolRequest.type, handler),\r\n        onWorkspaceSymbol: (handler) => connection.onRequest(vscode_languageserver_protocol_1.WorkspaceSymbolRequest.type, handler),\r\n        onCodeAction: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeActionRequest.type, handler),\r\n        onCodeLens: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeLensRequest.type, handler),\r\n        onCodeLensResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.CodeLensResolveRequest.type, handler),\r\n        onDocumentFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentFormattingRequest.type, handler),\r\n        onDocumentRangeFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentRangeFormattingRequest.type, handler),\r\n        onDocumentOnTypeFormatting: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentOnTypeFormattingRequest.type, handler),\r\n        onRenameRequest: (handler) => connection.onRequest(vscode_languageserver_protocol_1.RenameRequest.type, handler),\r\n        onPrepareRename: (handler) => connection.onRequest(vscode_languageserver_protocol_1.PrepareRenameRequest.type, handler),\r\n        onDocumentLinks: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentLinkRequest.type, handler),\r\n        onDocumentLinkResolve: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentLinkResolveRequest.type, handler),\r\n        onDocumentColor: (handler) => connection.onRequest(vscode_languageserver_protocol_1.DocumentColorRequest.type, handler),\r\n        onColorPresentation: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ColorPresentationRequest.type, handler),\r\n        onFoldingRanges: (handler) => connection.onRequest(vscode_languageserver_protocol_1.FoldingRangeRequest.type, handler),\r\n        onExecuteCommand: (handler) => connection.onRequest(vscode_languageserver_protocol_1.ExecuteCommandRequest.type, handler),\r\n        dispose: () => connection.dispose()\r\n    };\r\n    for (let remote of allRemotes) {\r\n        remote.attach(protocolConnection);\r\n    }\r\n    connection.onRequest(vscode_languageserver_protocol_1.InitializeRequest.type, (params) => {\r\n        const processId = params.processId;\r\n        if (Is.number(processId) && exitTimer === void 0) {\r\n            // We received a parent process id. Set up a timer to periodically check\r\n            // if the parent is still alive.\r\n            setInterval(() => {\r\n                try {\r\n                    process.kill(processId, 0);\r\n                }\r\n                catch (ex) {\r\n                    // Parent process doesn't exist anymore. Exit the server.\r\n                    process.exit(shutdownReceived ? 0 : 1);\r\n                }\r\n            }, 3000);\r\n        }\r\n        if (Is.string(params.trace)) {\r\n            tracer.trace = vscode_languageserver_protocol_1.Trace.fromString(params.trace);\r\n        }\r\n        for (let remote of allRemotes) {\r\n            remote.initialize(params.capabilities);\r\n        }\r\n        if (initializeHandler) {\r\n            let result = initializeHandler(params, new vscode_languageserver_protocol_1.CancellationTokenSource().token);\r\n            return asThenable(result).then((value) => {\r\n                if (value instanceof vscode_languageserver_protocol_1.ResponseError) {\r\n                    return value;\r\n                }\r\n                let result = value;\r\n                if (!result) {\r\n                    result = { capabilities: {} };\r\n                }\r\n                let capabilities = result.capabilities;\r\n                if (!capabilities) {\r\n                    capabilities = {};\r\n                    result.capabilities = capabilities;\r\n                }\r\n                if (capabilities.textDocumentSync === void 0 || capabilities.textDocumentSync === null) {\r\n                    capabilities.textDocumentSync = Is.number(protocolConnection.__textDocumentSync) ? protocolConnection.__textDocumentSync : vscode_languageserver_protocol_1.TextDocumentSyncKind.None;\r\n                }\r\n                else if (!Is.number(capabilities.textDocumentSync) && !Is.number(capabilities.textDocumentSync.change)) {\r\n                    capabilities.textDocumentSync.change = Is.number(protocolConnection.__textDocumentSync) ? protocolConnection.__textDocumentSync : vscode_languageserver_protocol_1.TextDocumentSyncKind.None;\r\n                }\r\n                for (let remote of allRemotes) {\r\n                    remote.fillServerCapabilities(capabilities);\r\n                }\r\n                return result;\r\n            });\r\n        }\r\n        else {\r\n            let result = { capabilities: { textDocumentSync: vscode_languageserver_protocol_1.TextDocumentSyncKind.None } };\r\n            for (let remote of allRemotes) {\r\n                remote.fillServerCapabilities(result.capabilities);\r\n            }\r\n            return result;\r\n        }\r\n    });\r\n    connection.onRequest(vscode_languageserver_protocol_1.ShutdownRequest.type, () => {\r\n        shutdownReceived = true;\r\n        if (shutdownHandler) {\r\n            return shutdownHandler(new vscode_languageserver_protocol_1.CancellationTokenSource().token);\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    });\r\n    connection.onNotification(vscode_languageserver_protocol_1.ExitNotification.type, () => {\r\n        try {\r\n            if (exitHandler) {\r\n                exitHandler();\r\n            }\r\n        }\r\n        finally {\r\n            if (shutdownReceived) {\r\n                process.exit(0);\r\n            }\r\n            else {\r\n                process.exit(1);\r\n            }\r\n        }\r\n    });\r\n    connection.onNotification(vscode_languageserver_protocol_1.SetTraceNotification.type, (params) => {\r\n        tracer.trace = vscode_languageserver_protocol_1.Trace.fromString(params.value);\r\n    });\r\n    return protocolConnection;\r\n}\r\n// Export the protocol currently in proposed state.\r\nvar ProposedFeatures;\r\n(function (ProposedFeatures) {\r\n    ProposedFeatures.all = {\r\n        __brand: 'features',\r\n    };\r\n})(ProposedFeatures = exports.ProposedFeatures || (exports.ProposedFeatures = {}));\r\n","module.exports = require(\"path\");","module.exports = require(\"net\");","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction thenable(value) {\r\n    return value && func(value.then);\r\n}\r\nexports.thenable = thenable;\r\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 10;","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\nimport {\r\n\tcreateConnection,\r\n\r\n\tDiagnostic,\r\n\tDiagnosticSeverity,\r\n\r\n\r\n\tExecuteCommandParams,\r\n\tExecuteCommandRequest,\r\n\tCommand,\r\n\tDidChangeConfigurationNotification,\r\n\tDocumentSymbolParams,\r\n\tInitializeParams,\r\n\tCancellationToken,\r\n\tCodeActionParams,\r\n\tCodeActionOptions,\r\n\tCompletionItem,\r\n\tCompletionItemKind,\r\n\tCodeAction,\r\n\tCodeActionKind,\r\n\tCreateFile,\r\n\r\n\r\n\tMessageType,\r\n\tStreamMessageWriter,\r\n\tShowMessageRequestParams,\r\n\tProposedFeatures,\r\n\tPublishDiagnosticsParams,\r\n\tRange,\r\n\tSymbolInformation,\r\n\tSymbolKind,\r\n\tTextDocumentPositionParams,\r\n\tRemoteWindow,\r\n\tShowMessageNotification,\r\n\tShowMessageParams,\r\n\tTextDocuments,\r\n\tTextDocument,\r\n\tWindowFeature,\r\n\tWorkspaceEdit,\r\n\tWorkspaceChange,\r\n\tWorkspaceFolder,\r\n\tWorkspaceFeature,\r\n\tCreateFileOptions,\r\n\r\n\r\n\tDeleteFile,\r\n\tLocation,\r\n\tPosition,\r\n\tRenameFile,\r\n\tTextDocumentEdit,\r\n\tTextEdit,\r\n\tVersionedTextDocumentIdentifier,\r\n\r\n\r\n\r\n\r\n} from 'vscode-languageserver';\r\nimport * as utils from './utils';\r\nimport * as path from 'path';\r\n//grab array of keywords here. can we get this from the client?\r\nimport * as grammar from './pro.tmLanguage.json';\r\n\r\n\r\n\r\n//import * as vscode from 'vscode-languageserver';\r\n\r\nimport { ParseDocument, ParseItem, MySymbol } from './parser';\r\n//import {onExecuteCommand} from './commands';\r\nimport { connect } from 'http2';\r\nimport { isWindows } from './utils.js';\r\nimport { WorkspaceFoldersFeature } from 'vscode-languageserver/lib/workspaceFolders';\r\n\r\n// Create a connection for the server. The connection uses Node's IPC as a transport.\r\n// Also include all preview / proposed LSP features.\r\nlet connection = createConnection(ProposedFeatures.all);\r\n\r\n// Create a simple text document manager. The text document manager\r\n// supports full document sync only\r\nlet documents: TextDocuments = new TextDocuments();\r\n\r\nlet hasConfigurationCapability: boolean = false;\r\nlet hasWorkspaceFolderCapability: boolean = false;\r\nlet hasDiagnosticRelatedInformationCapability: boolean = false;\r\n\r\nconnection.onInitialize((params: InitializeParams) => {\r\n\tlet capabilities = params.capabilities;\r\n\r\n\t// Does the client support the `workspace/configuration` request?\r\n\t// If not, we will fall back using global settings\r\n\thasConfigurationCapability = !!(\r\n\t\tcapabilities.workspace && !!capabilities.workspace.configuration\r\n\t);\r\n\thasWorkspaceFolderCapability = !!(\r\n\t\tcapabilities.workspace && !!capabilities.workspace.workspaceFolders\r\n\t);\r\n\thasDiagnosticRelatedInformationCapability = !!(\r\n\t\tcapabilities.textDocument &&\r\n\t\tcapabilities.textDocument.publishDiagnostics &&\r\n\t\tcapabilities.textDocument.publishDiagnostics.relatedInformation\r\n\t);\r\n\r\n\treturn {\r\n\t\tcapabilities: {\r\n\t\t\ttextDocumentSync: documents.syncKind,\r\n\r\n\t\t\t// code action - only way to return a command with a link to doc?\r\n\t\t\tcodeActionProvider: true,\r\n\t\t\t// Tell the client that the server supports code completion\r\n\t\t\tcompletionProvider: {\r\n\t\t\t\tresolveProvider: true\r\n\r\n\t\t\t},\r\n\r\n\t\t\t// Tell the client that the server supports document Symbols\r\n\t\t\tdocumentSymbolProvider: true,\r\n\r\n\t\t\t// and can execute commands (for syntax checker)\r\n\t\t\texecuteCommandProvider: {\r\n\t\t\t\t\"commands\": [\"checkSyntax\"]\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t};\r\n});\r\n\r\nconnection.onInitialized(() => {\r\n\tif (hasConfigurationCapability) {\r\n\t\t// Register for all configuration changes.\r\n\t\tconnection.client.register(DidChangeConfigurationNotification.type, undefined);\r\n\t}\r\n\tif (hasWorkspaceFolderCapability) {\r\n\t\tconnection.workspace.onDidChangeWorkspaceFolders(_event => {\r\n\t\t\tconnection.console.log('Workspace folder change event received.');\r\n\t\t});\r\n\t}\r\n\r\n});\r\n\r\n// The example settings\r\ninterface ExampleSettings {\r\n\tmaxNumberOfProblems: number;\r\n\tenableSyntaxCheckTab: boolean;\r\n\tenableSyntaxCheckCodeAction: boolean;\r\n}\r\n\r\n// The global settings, used when the `workspace/configuration` request is not supported by the client.\r\n// Please note that this is not the case when using this server with the client provided in this example\r\n// but could happen with other clients.\r\nconst defaultSettings: ExampleSettings = { maxNumberOfProblems: 1000, enableSyntaxCheckTab: true, enableSyntaxCheckCodeAction: false };\r\nlet globalSettings: ExampleSettings = defaultSettings;\r\n\r\n// Cache the settings of all open documents\r\nlet documentSettings: Map<string, Thenable<ExampleSettings>> = new Map();\r\n\r\n\r\n\r\n\r\n\r\nconnection.onDidChangeConfiguration(change => {\r\n\tif (hasConfigurationCapability) {\r\n\t\t// Reset all cached document settings\r\n\t\tdocumentSettings.clear();\r\n\t} else {\r\n\t\tglobalSettings = <ExampleSettings>(\r\n\t\t\t(change.settings.languageServerExample || defaultSettings)\r\n\t\t);\r\n\t}\r\n\r\n\t// Revalidate all open text documents\r\n\tdocuments.all().forEach(validateTextDocument);\r\n});\r\n\r\nfunction getDocumentSettings(resource: string): Thenable<ExampleSettings> {\r\n\tif (!hasConfigurationCapability) {\r\n\t\treturn Promise.resolve(globalSettings);\r\n\t}\r\n\tlet result = documentSettings.get(resource);\r\n\tif (!result) {\r\n\t\tresult = connection.workspace.getConfiguration({\r\n\t\t\tscopeUri: resource,\r\n\t\t\tsection: 'languageServerExample'\r\n\t\t});\r\n\t\tdocumentSettings.set(resource, result);\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n// Only keep settings for open documents\r\ndocuments.onDidClose(e => {\r\n\tdocumentSettings.delete(e.document.uri);\r\n});\r\n\r\n// The content of a text document has changed. This event is emitted\r\n// when the text document first opened or when its content has changed.\r\ndocuments.onDidChangeContent(change => {\r\n\r\n\t//DISABLED but left code in for reference.\r\n\t//validateTextDocument(change.document);\r\n\tcheckDocumentSyntax(change.document);\r\n});\r\n\r\nasync function checkDocumentSyntax(textDocument: TextDocument): Promise<void> {\r\n\t//if syntaxcheck tab is enabled:\r\n\tlet settings = await getDocumentSettings(textDocument.uri);\r\n\tif (settings.enableSyntaxCheckTab) {\r\n\t\tvar doc = documents.get(textDocument.uri);\r\n\t\t//monitor only .pro files\r\n\t\t//how do we retrieve this from the client language setting?\r\n\t\tif (doc.languageId == 'pro') {\r\n\t\t\t\r\n\t\t\t//pass document name to syntax checker\r\n\t\t\tvar args: string[] = [];\r\n\t\t\targs.push(textDocument.uri.toString());\r\n\t\t\t\r\n\t\t\tvar execute: ExecuteCommandParams = { command: \"checkSyntax\", arguments: args };\r\n\t\t\tvar token: CancellationToken;\r\n\t\t\tonExecuteCommand(execute, token);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nasync function validateTextDocument(textDocument: TextDocument): Promise<void> {\r\n\t// In this simple example we get the settings for every validate run.\r\n\tlet settings = await getDocumentSettings(textDocument.uri);\r\n\r\n\t// The validator creates diagnostics for all uppercase words length 2 and more\r\n\tlet text = textDocument.getText();\r\n\tlet pattern = /\\b[A-Z]{2,}\\b/g;\r\n\tlet m: RegExpExecArray | null;\r\n\r\n\tlet problems = 0;\r\n\tlet diagnostics: Diagnostic[] = [];\r\n\twhile ((m = pattern.exec(text)) && problems < settings.maxNumberOfProblems) {\r\n\t\tproblems++;\r\n\t\tlet diagnostic: Diagnostic = {\r\n\t\t\tseverity: DiagnosticSeverity.Warning,\r\n\t\t\trange: {\r\n\t\t\t\tstart: textDocument.positionAt(m.index),\r\n\t\t\t\tend: textDocument.positionAt(m.index + m[0].length)\r\n\t\t\t},\r\n\t\t\tmessage: `${m[0]} is all uppercase!!!.`,\r\n\t\t\tsource: 'ex'\r\n\t\t};\r\n\t\tif (hasDiagnosticRelatedInformationCapability) {\r\n\t\t\tdiagnostic.relatedInformation = [\r\n\t\t\t\t{\r\n\t\t\t\t\tlocation: {\r\n\t\t\t\t\t\turi: textDocument.uri,\r\n\t\t\t\t\t\trange: Object.assign({}, diagnostic.range)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmessage: 'Spelling matters'\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlocation: {\r\n\t\t\t\t\t\turi: textDocument.uri,\r\n\t\t\t\t\t\trange: Object.assign({}, diagnostic.range)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmessage: 'Particularly for names'\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\t\tdiagnostics.push(diagnostic);\r\n\t}\r\n\r\n\t// Send the computed diagnostics to VSCode.\r\n\tconnection.sendDiagnostics({ uri: textDocument.uri, diagnostics });\r\n}\r\n\r\nconnection.onDidChangeWatchedFiles(_change => {\r\n\t// Monitored files have change in VSCode\r\n\tconsole.log('We received an file change event');\r\n});\r\n\r\n// This handler provides the initial list of the completion items.\r\nconnection.onCompletion(\r\n\t(_textDocumentPosition: TextDocumentPositionParams): CompletionItem[] => {\r\n\t\t// The pass parameter contains the position of the text document in\r\n\t\t// which code complete got requested. For the example we ignore this\r\n\t\t// info and always provide the same completion items.\r\n\t\treturn [\r\n\t\t\t{\r\n\t\t\t\tlabel: 'TypeScript',\r\n\t\t\t\tkind: CompletionItemKind.Text,\r\n\t\t\t\tdata: 1\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tlabel: 'JavaScript',\r\n\t\t\t\tkind: CompletionItemKind.Text,\r\n\t\t\t\tdata: 2\r\n\t\t\t}\r\n\t\t];\r\n\t}\r\n);\r\n\r\n// This handler resolves additional information for the item selected in\r\n// the completion list.\r\nconnection.onCompletionResolve(\r\n\t(item: CompletionItem): CompletionItem => {\r\n\t\tif (item.data === 1) {\r\n\t\t\titem.detail = 'TypeScript details';\r\n\t\t\titem.documentation = 'TypeScript documentation';\r\n\t\t} else if (item.data === 2) {\r\n\t\t\titem.detail = 'JavaScript details';\r\n\t\t\titem.documentation = 'JavaScript documentation';\r\n\t\t}\r\n\t\treturn item;\r\n\t}\r\n);\r\n\r\nconnection.onCodeAction((codeActionParams: CodeActionParams): CodeAction[] => {\r\n\t//all this is a bodge to get the uri through to the calling command, so we can parse symbols and presend dialog box server-side\r\n\r\n\tlet codeActions = [];\r\n\tlet codeAction: CodeAction = { title: \"Check Syntax\", kind: CodeActionKind.QuickFix };\r\n\r\n\tvar doc: TextDocument = documents.get(codeActionParams.textDocument.uri);\r\n\r\n\tvar args: string[] = [];\r\n\targs.push(codeActionParams.textDocument.uri.toString());\r\n\tvar command: Command = Command.create(\"checkSyntax\", \"checkSyntax\", codeActionParams.textDocument.uri.toString());\r\n\r\n\tcodeAction.command = command;\r\n\t//\tvar oneCommand = Command.create(\"my syntax checker\",\"checkSyntax\",args);\r\n\t//command.push(oneCommand);\r\n\tcodeActions.push(codeAction);\r\n\r\n\t//DISABLED in preference to onDocumentChange trigger\r\n\t//return codeActions;\r\n\treturn;\r\n});\r\n\r\nconnection.onDocumentSymbol(onDocumentSymbol);\r\n//change to async then promise.resolve\r\nfunction onDocumentSymbol(documentSymbol: DocumentSymbolParams): SymbolInformation[] {\r\n\tconsole.log('Server.onDocumentSymbol', documentSymbol);\r\n\t//const path = utils.uriToPath(documentSymbol.textDocument.uri);\r\n\r\n\t// Create an SymbolInformation[] Object to pass as result\r\n\tconst symbolInformationResult: SymbolInformation[] = [];\r\n\r\n\t// Form local variables for changed doc uri (preliminary code is for DocumentSymbol not workspace-wide)\r\n\tconst uri = documentSymbol.textDocument.uri;\r\n\tconst thisdoc = documents.get(uri);\r\n\r\n\t//create headings/containers for outline... not yet working...\r\n\t/*\r\n\tconst wholedoc = Range.create(0, 0, thisdoc.lineCount, Number.MAX_VALUE);\r\n\tvar headingSymbolString = SymbolInformation.create('STRINGS:',SymbolKind.String,wholedoc,uri);\r\n\tsymbolInformationResult.push(headingSymbolString);\r\n\t\r\n\tvar headingSymbolString = SymbolInformation.create('DB FIELDS:',SymbolKind.Field,wholedoc,uri);\r\n\tsymbolInformationResult.push(headingSymbolString);\r\n\t*/\r\n\r\n\t// Retrieve list of symbols by passing document to parser\r\n\t// ParseItem is (name,symbolKind and Line), but not Range. Extended by MySymbol to include start and end char pos in line\r\n\t// pass it also our grammar json to identify keyworkds\r\n\tconst symbols: MySymbol[] = ParseDocument(thisdoc, grammar);\r\n\r\n\t//for each symbok, construct a SymbolInformation Object, and push to result array\r\n\tfor (const symbol of symbols) {\r\n\r\n\t\t// What is the document range that covers this symbol? \r\n\t\t// this is the character range of the whole line, rather than just the symbol start and end\r\n\t\tconst symbolRange = Range.create(symbol.parseItem.line, symbol.start, symbol.parseItem.line, symbol.end);\r\n\r\n\t\t// Construct symbolInformation Object\r\n\t\tconst symbolInformation = SymbolInformation.create(symbol.parseItem.name, symbol.parseItem.type, symbolRange, uri, symbol.parseItem.container);\r\n\t\t//var conName = symbolInformation.containerName;\r\n\r\n\t\t// Finally, push the symbol to output array\r\n\t\tsymbolInformationResult.push(symbolInformation);\r\n\t}\r\n\treturn symbolInformationResult;\r\n}\r\n\r\n\r\n/*\r\nconnection.onDidOpenTextDocument((params) => {\r\n\t// A text document got opened in VSCode.\r\n\t// params.uri uniquely identifies the document. For documents store on disk this is a file URI.\r\n\t// params.text the initial full content of the document.\r\n\tconnection.console.log(`${params.textDocument.uri} opened.`);\r\n});\r\nconnection.onDidChangeTextDocument((params) => {\r\n\t// The content of a text document did change in VSCode.\r\n\t// params.uri uniquely identifies the document.\r\n\t// params.contentChanges describe the content changes to the document.\r\n\tconnection.console.log(`${params.textDocument.uri} changed: ${JSON.stringify(params.contentChanges)}`);\r\n});\r\nconnection.onDidCloseTextDocument((params) => {\r\n\t// A text document got closed in VSCode.\r\n\t// params.uri uniquely identifies the document.\r\n\tconnection.console.log(`${params.textDocument.uri} closed.`);\r\n});\r\n*/\r\n\r\n// Make the text document manager listen on the connection\r\n// for open, change and close text document events\r\n\r\n\r\nconnection.onExecuteCommand(onExecuteCommand);\r\nasync function onExecuteCommand(params: ExecuteCommandParams, pToken: CancellationToken) {\r\n\tconsole.log(\"run command\");\r\n\tswitch (params.command) {\r\n\t\tcase \"checkSyntax\":\r\n\t\t\t// we have passed the doc URI in the ExecuteCommandParams as an argument.\r\n\t\t\t// (this seems to have to come via a CodeAction rather than a plain UI ExecuteCommand in order that\r\n\t\t\t// the UI can pass the document url )\r\n\r\n\t\t\t// Get the DocumentSymols \r\n\t\t\tlet uri: string = params.arguments[0];\r\n\t\t\tconst thisdoc = documents.get(uri);\r\n\t\t\tlet documentSymbol: DocumentSymbolParams = { textDocument: thisdoc };\r\n\t\t\tvar symbolInformationResult: SymbolInformation[] = [];\r\n\t\t\tsymbolInformationResult = onDocumentSymbol(documentSymbol);\r\n\t\t\tvar syntaxmessage: string;\r\n\t\t\tvar myarray = [];\r\n\t\t\tvar strings: string = \"\";\r\n\t\t\tvar fields: string = \"\";\r\n\t\t\tvar variables: string = \"\";\r\n\r\n\t\t\tvar stringsA: string[] = [];\r\n\t\t\tvar fieldsA: string[] = [];\r\n\t\t\tvar variablesA: string[] = [];\r\n\r\n\r\n\t\t\t//Format the symbols into a Syntax Checker result string\r\n\t\t\tfor (let sym of symbolInformationResult) {\r\n\t\t\t\t//syntaxmessage += sym.containerName;\r\n\t\t\t\tmyarray.push({\r\n\t\t\t\t\t\"type\": sym.containerName,\r\n\t\t\t\t\t\"value\": sym.name\r\n\t\t\t\t});\r\n\t\t\t\tif (sym.containerName == \"STRINGS:\") {\r\n\t\t\t\t\tstringsA.push(sym.name);\r\n\t\t\t\t\tstrings += sym.name + \"\\r\\n\";\r\n\t\t\t\t}\r\n\t\t\t\tif (sym.containerName == \"DB FIELDS:\") {\r\n\t\t\t\t\tfields += sym.name + \"\\r\\n\";\r\n\t\t\t\t\tfieldsA.push(sym.name);\r\n\t\t\t\t}\r\n\t\t\t\tif (sym.containerName == \"VARIABLES:\") {\r\n\t\t\t\t\tvariables += sym.name + \"\\r\\n\";\r\n\t\t\t\t\tvariablesA.push(sym.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//syntaxmessage = '*****     STRINGS     *****\\r\\n' + strings + \"\\r\\n\" + \"*****     DB FIELDS     *****\\r\\n\" + fields + \"\\r\\n\" + \"*****     VARIABLES     *****\\r\\n\" + variables;\r\n\t\t\tconst distinctStrings = [...new Set(stringsA)];\r\n\t\t\tconst distinctFields = [...new Set(fieldsA)];\r\n\t\t\tconst distinctVars = [...new Set(variablesA)];\r\n\r\n\t\t\tsyntaxmessage = '*****     STRINGS       *****\\r\\n' + distinctStrings.join('\\r\\n') + '\\r\\n\\r\\n';\r\n\t\t\tsyntaxmessage += '*****     DB FIELDS     *****\\r\\n' + distinctFields.join('\\r\\n') + '\\r\\n\\r\\n';\r\n\t\t\tsyntaxmessage += '*****     VARIABLES     *****\\r\\n' + distinctVars.join('\\r\\n') + '\\r\\n\\r\\n';\r\n\r\n\t\t\t//popup syntax\r\n\r\n\t\t\t// hmm, doesn't allow multiline.\r\n\t\t\t//connection.window.showErrorMessage(syntaxmessage);\r\n\r\n\t\t\t//instead, make a new tab in the workspace\r\n\t\t\t//some text\r\n\t\t\t//const textToAdd: string = \"test string\";\r\n\r\n\t\t\t//create new WorkspaceChange obj\r\n\t\t\t//let workspaceChange = new WorkspaceChange();\r\n\r\n\t\t\t//uri of new file\r\n\t\t\tlet newuri = 'file:///c:/temp/syntaxcheck.txt';\r\n\r\n\t\t\t//construct a CreateFile variable\r\n\t\t\tlet createFile: CreateFile = { kind: 'create', uri: newuri };\r\n\t\t\t//and make into array\r\n\t\t\tlet createFiles: CreateFile[] = [];\r\n\t\t\tcreateFiles.push(createFile);\r\n\r\n\t\t\t//make a new workspaceEdit variable, specifying a createFile document change\r\n\t\t\tvar workspaceEdit: WorkspaceEdit = { documentChanges: createFiles };\r\n\r\n\t\t\t//pass to client to apply this edit\r\n\t\t\tawait connection.workspace.applyEdit(workspaceEdit);\r\n\r\n\r\n\t\t\t//To insert the text (and pop up the window), create array of TextEdit\r\n\t\t\tlet textEdit: TextEdit[] = [];\r\n\t\t\t//let document = documents.get(newuri);\r\n\t\t\tlet documentRange: Range = Range.create(0, 0, Number.MAX_VALUE, Number.MAX_VALUE);\r\n\t\t\t//populate with the text, and where to insert (surely this is what workspaceChange.insert is for?)\r\n\t\t\tlet textEdits: TextEdit = { range: documentRange, newText: syntaxmessage };\r\n\t\t\t//Range.create(Position.create(0, 1),Position.create(0, 1)), newText: syntaxmessage};\r\n\t\t\ttextEdit.push(textEdits);\r\n\r\n\t\t\t//make a new array of textDocumentEdits, containing our TextEdit (range and text)\r\n\t\t\tlet textDocumentEdit = TextDocumentEdit.create({ uri: newuri, version: 1 }, textEdit);\r\n\t\t\tlet textDocumentEdits: TextDocumentEdit[] = [];\r\n\t\t\ttextDocumentEdits.push(textDocumentEdit);\r\n\r\n\t\t\t//set  our workspaceEdit variable to this new TextDocumentEdit\r\n\t\t\tworkspaceEdit = { documentChanges: textDocumentEdits };\r\n\r\n\t\t\t//and finally apply this to our workspace.\r\n\t\t\t// we can probably do this some more elegant way / in\r\n\t\t\tconnection.workspace.applyEdit(workspaceEdit);\r\n\r\n\t\t\tbreak;\r\n\t}\r\n}\r\n\r\n\r\n\r\n\r\ndocuments.listen(connection);\r\n\r\n// Listen on the connection\r\nconnection.listen();\r\n\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst is = require(\"./is\");\r\n/**\r\n * Predefined error codes.\r\n */\r\nvar ErrorCodes;\r\n(function (ErrorCodes) {\r\n    // Defined by JSON RPC\r\n    ErrorCodes.ParseError = -32700;\r\n    ErrorCodes.InvalidRequest = -32600;\r\n    ErrorCodes.MethodNotFound = -32601;\r\n    ErrorCodes.InvalidParams = -32602;\r\n    ErrorCodes.InternalError = -32603;\r\n    ErrorCodes.serverErrorStart = -32099;\r\n    ErrorCodes.serverErrorEnd = -32000;\r\n    ErrorCodes.ServerNotInitialized = -32002;\r\n    ErrorCodes.UnknownErrorCode = -32001;\r\n    // Defined by the protocol.\r\n    ErrorCodes.RequestCancelled = -32800;\r\n    // Defined by VSCode library.\r\n    ErrorCodes.MessageWriteError = 1;\r\n    ErrorCodes.MessageReadError = 2;\r\n})(ErrorCodes = exports.ErrorCodes || (exports.ErrorCodes = {}));\r\n/**\r\n * An error object return in a response in case a request\r\n * has failed.\r\n */\r\nclass ResponseError extends Error {\r\n    constructor(code, message, data) {\r\n        super(message);\r\n        this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\r\n        this.data = data;\r\n        Object.setPrototypeOf(this, ResponseError.prototype);\r\n    }\r\n    toJson() {\r\n        return {\r\n            code: this.code,\r\n            message: this.message,\r\n            data: this.data,\r\n        };\r\n    }\r\n}\r\nexports.ResponseError = ResponseError;\r\n/**\r\n * An abstract implementation of a MessageType.\r\n */\r\nclass AbstractMessageType {\r\n    constructor(_method, _numberOfParams) {\r\n        this._method = _method;\r\n        this._numberOfParams = _numberOfParams;\r\n    }\r\n    get method() {\r\n        return this._method;\r\n    }\r\n    get numberOfParams() {\r\n        return this._numberOfParams;\r\n    }\r\n}\r\nexports.AbstractMessageType = AbstractMessageType;\r\n/**\r\n * Classes to type request response pairs\r\n */\r\nclass RequestType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType0 = RequestType0;\r\nclass RequestType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType = RequestType;\r\nclass RequestType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType1 = RequestType1;\r\nclass RequestType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType2 = RequestType2;\r\nclass RequestType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType3 = RequestType3;\r\nclass RequestType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType4 = RequestType4;\r\nclass RequestType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType5 = RequestType5;\r\nclass RequestType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType6 = RequestType6;\r\nclass RequestType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType7 = RequestType7;\r\nclass RequestType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType8 = RequestType8;\r\nclass RequestType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.RequestType9 = RequestType9;\r\nclass NotificationType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType = NotificationType;\r\nclass NotificationType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType0 = NotificationType0;\r\nclass NotificationType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType1 = NotificationType1;\r\nclass NotificationType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType2 = NotificationType2;\r\nclass NotificationType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType3 = NotificationType3;\r\nclass NotificationType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType4 = NotificationType4;\r\nclass NotificationType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType5 = NotificationType5;\r\nclass NotificationType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType6 = NotificationType6;\r\nclass NotificationType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType7 = NotificationType7;\r\nclass NotificationType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType8 = NotificationType8;\r\nclass NotificationType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType9 = NotificationType9;\r\n/**\r\n * Tests if the given message is a request message\r\n */\r\nfunction isRequestMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\r\n}\r\nexports.isRequestMessage = isRequestMessage;\r\n/**\r\n * Tests if the given message is a notification message\r\n */\r\nfunction isNotificationMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && message.id === void 0;\r\n}\r\nexports.isNotificationMessage = isNotificationMessage;\r\n/**\r\n * Tests if the given message is a response message\r\n */\r\nfunction isResponseMessage(message) {\r\n    let candidate = message;\r\n    return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\r\n}\r\nexports.isResponseMessage = isResponseMessage;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nvar CancellationToken;\r\n(function (CancellationToken) {\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && (candidate === CancellationToken.None\r\n            || candidate === CancellationToken.Cancelled\r\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\r\n    }\r\n    CancellationToken.is = is;\r\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\r\nconst shortcutEvent = Object.freeze(function (callback, context) {\r\n    let handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose() { clearTimeout(handle); } };\r\n});\r\nclass MutableToken {\r\n    constructor() {\r\n        this._isCancelled = false;\r\n    }\r\n    cancel() {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this._emitter = undefined;\r\n            }\r\n        }\r\n    }\r\n    get isCancellationRequested() {\r\n        return this._isCancelled;\r\n    }\r\n    get onCancellationRequested() {\r\n        if (this._isCancelled) {\r\n            return shortcutEvent;\r\n        }\r\n        if (!this._emitter) {\r\n            this._emitter = new events_1.Emitter();\r\n        }\r\n        return this._emitter.event;\r\n    }\r\n}\r\nclass CancellationTokenSource {\r\n    get token() {\r\n        if (!this._token) {\r\n            // be lazy and create the token only when\r\n            // actually needed\r\n            this._token = new MutableToken();\r\n        }\r\n        return this._token;\r\n    }\r\n    cancel() {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else {\r\n            this._token.cancel();\r\n        }\r\n    }\r\n    dispose() {\r\n        this.cancel();\r\n    }\r\n}\r\nexports.CancellationTokenSource = CancellationTokenSource;\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Touch;\r\n(function (Touch) {\r\n    Touch.None = 0;\r\n    Touch.First = 1;\r\n    Touch.Last = 2;\r\n})(Touch = exports.Touch || (exports.Touch = {}));\r\nclass LinkedMap {\r\n    constructor() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    clear() {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    isEmpty() {\r\n        return !this._head && !this._tail;\r\n    }\r\n    get size() {\r\n        return this._size;\r\n    }\r\n    has(key) {\r\n        return this._map.has(key);\r\n    }\r\n    get(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return item.value;\r\n    }\r\n    set(key, value, touch = Touch.None) {\r\n        let item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== Touch.None) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key, value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case Touch.None:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case Touch.First:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case Touch.Last:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    }\r\n    delete(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        this._map.delete(key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return true;\r\n    }\r\n    shift() {\r\n        if (!this._head && !this._tail) {\r\n            return undefined;\r\n        }\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        const item = this._head;\r\n        this._map.delete(item.key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return item.value;\r\n    }\r\n    forEach(callbackfn, thisArg) {\r\n        let current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    }\r\n    forEachReverse(callbackfn, thisArg) {\r\n        let current = this._tail;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.previous;\r\n        }\r\n    }\r\n    values() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.value);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    keys() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.key);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    /* JSON RPC run on es5 which has no Symbol.iterator\r\n    public keys(): IterableIterator<K> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    let result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    public values(): IterableIterator<V> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    let result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    addItemFirst(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    }\r\n    addItemLast(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    }\r\n    removeItem(item) {\r\n        if (item === this._head && item === this._tail) {\r\n            this._head = undefined;\r\n            this._tail = undefined;\r\n        }\r\n        else if (item === this._head) {\r\n            this._head = item.next;\r\n        }\r\n        else if (item === this._tail) {\r\n            this._tail = item.previous;\r\n        }\r\n        else {\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            if (!next || !previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            next.previous = previous;\r\n            previous.next = next;\r\n        }\r\n    }\r\n    touch(item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\r\n            return;\r\n        }\r\n        if (touch === Touch.First) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = undefined;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = undefined;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === Touch.Last) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = undefined;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = undefined;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    }\r\n}\r\nexports.LinkedMap = LinkedMap;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst path_1 = require(\"path\");\r\nconst os_1 = require(\"os\");\r\nconst crypto_1 = require(\"crypto\");\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction generateRandomPipeName() {\r\n    const randomSuffix = crypto_1.randomBytes(21).toString('hex');\r\n    if (process.platform === 'win32') {\r\n        return `\\\\\\\\.\\\\pipe\\\\vscode-jsonrpc-${randomSuffix}-sock`;\r\n    }\r\n    else {\r\n        // Mac/Unix: use socket file\r\n        return path_1.join(os_1.tmpdir(), `vscode-${randomSuffix}.sock`);\r\n    }\r\n}\r\nexports.generateRandomPipeName = generateRandomPipeName;\r\nfunction createClientPipeTransport(pipeName, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(pipeName, () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientPipeTransport = createClientPipeTransport;\r\nfunction createServerPipeTransport(pipeName, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(pipeName);\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerPipeTransport = createServerPipeTransport;\r\n","module.exports = require(\"os\");","module.exports = require(\"crypto\");","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction createClientSocketTransport(port, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(port, '127.0.0.1', () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientSocketTransport = createClientSocketTransport;\r\nfunction createServerSocketTransport(port, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(port, '127.0.0.1');\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerSocketTransport = createServerSocketTransport;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\n/**\r\n * The Position namespace provides helper functions to work with\r\n * [Position](#Position) literals.\r\n */\r\nexport var Position;\r\n(function (Position) {\r\n    /**\r\n     * Creates a new Position literal from the given line and character.\r\n     * @param line The position's line.\r\n     * @param character The position's character.\r\n     */\r\n    function create(line, character) {\r\n        return { line: line, character: character };\r\n    }\r\n    Position.create = create;\r\n    /**\r\n     * Checks whether the given liternal conforms to the [Position](#Position) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Is.number(candidate.line) && Is.number(candidate.character);\r\n    }\r\n    Position.is = is;\r\n})(Position || (Position = {}));\r\n/**\r\n * The Range namespace provides helper functions to work with\r\n * [Range](#Range) literals.\r\n */\r\nexport var Range;\r\n(function (Range) {\r\n    function create(one, two, three, four) {\r\n        if (Is.number(one) && Is.number(two) && Is.number(three) && Is.number(four)) {\r\n            return { start: Position.create(one, two), end: Position.create(three, four) };\r\n        }\r\n        else if (Position.is(one) && Position.is(two)) {\r\n            return { start: one, end: two };\r\n        }\r\n        else {\r\n            throw new Error(\"Range#create called with invalid arguments[\" + one + \", \" + two + \", \" + three + \", \" + four + \"]\");\r\n        }\r\n    }\r\n    Range.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Range](#Range) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Position.is(candidate.start) && Position.is(candidate.end);\r\n    }\r\n    Range.is = is;\r\n})(Range || (Range = {}));\r\n/**\r\n * The Location namespace provides helper functions to work with\r\n * [Location](#Location) literals.\r\n */\r\nexport var Location;\r\n(function (Location) {\r\n    /**\r\n     * Creates a Location literal.\r\n     * @param uri The location's uri.\r\n     * @param range The location's range.\r\n     */\r\n    function create(uri, range) {\r\n        return { uri: uri, range: range };\r\n    }\r\n    Location.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Location](#Location) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.string(candidate.uri) || Is.undefined(candidate.uri));\r\n    }\r\n    Location.is = is;\r\n})(Location || (Location = {}));\r\n/**\r\n * The LocationLink namespace provides helper functions to work with\r\n * [LocationLink](#LocationLink) literals.\r\n */\r\nexport var LocationLink;\r\n(function (LocationLink) {\r\n    /**\r\n     * Creates a LocationLink literal.\r\n     * @param targetUri The definition's uri.\r\n     * @param targetRange The full range of the definition.\r\n     * @param targetSelectionRange The span of the symbol definition at the target.\r\n     * @param originSelectionRange The span of the symbol being defined in the originating source file.\r\n     */\r\n    function create(targetUri, targetRange, targetSelectionRange, originSelectionRange) {\r\n        return { targetUri: targetUri, targetRange: targetRange, targetSelectionRange: targetSelectionRange, originSelectionRange: originSelectionRange };\r\n    }\r\n    LocationLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [LocationLink](#LocationLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.targetRange) && Is.string(candidate.targetUri)\r\n            && (Range.is(candidate.targetSelectionRange) || Is.undefined(candidate.targetSelectionRange))\r\n            && (Range.is(candidate.originSelectionRange) || Is.undefined(candidate.originSelectionRange));\r\n    }\r\n    LocationLink.is = is;\r\n})(LocationLink || (LocationLink = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [Color](#Color) literals.\r\n */\r\nexport var Color;\r\n(function (Color) {\r\n    /**\r\n     * Creates a new Color literal.\r\n     */\r\n    function create(red, green, blue, alpha) {\r\n        return {\r\n            red: red,\r\n            green: green,\r\n            blue: blue,\r\n            alpha: alpha,\r\n        };\r\n    }\r\n    Color.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Color](#Color) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.red)\r\n            && Is.number(candidate.green)\r\n            && Is.number(candidate.blue)\r\n            && Is.number(candidate.alpha);\r\n    }\r\n    Color.is = is;\r\n})(Color || (Color = {}));\r\n/**\r\n * The ColorInformation namespace provides helper functions to work with\r\n * [ColorInformation](#ColorInformation) literals.\r\n */\r\nexport var ColorInformation;\r\n(function (ColorInformation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(range, color) {\r\n        return {\r\n            range: range,\r\n            color: color,\r\n        };\r\n    }\r\n    ColorInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Range.is(candidate.range) && Color.is(candidate.color);\r\n    }\r\n    ColorInformation.is = is;\r\n})(ColorInformation || (ColorInformation = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [ColorPresentation](#ColorPresentation) literals.\r\n */\r\nexport var ColorPresentation;\r\n(function (ColorPresentation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(label, textEdit, additionalTextEdits) {\r\n        return {\r\n            label: label,\r\n            textEdit: textEdit,\r\n            additionalTextEdits: additionalTextEdits,\r\n        };\r\n    }\r\n    ColorPresentation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate.label)\r\n            && (Is.undefined(candidate.textEdit) || TextEdit.is(candidate))\r\n            && (Is.undefined(candidate.additionalTextEdits) || Is.typedArray(candidate.additionalTextEdits, TextEdit.is));\r\n    }\r\n    ColorPresentation.is = is;\r\n})(ColorPresentation || (ColorPresentation = {}));\r\n/**\r\n * Enum of known range kinds\r\n */\r\nexport var FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind || (FoldingRangeKind = {}));\r\n/**\r\n * The folding range namespace provides helper functions to work with\r\n * [FoldingRange](#FoldingRange) literals.\r\n */\r\nexport var FoldingRange;\r\n(function (FoldingRange) {\r\n    /**\r\n     * Creates a new FoldingRange literal.\r\n     */\r\n    function create(startLine, endLine, startCharacter, endCharacter, kind) {\r\n        var result = {\r\n            startLine: startLine,\r\n            endLine: endLine\r\n        };\r\n        if (Is.defined(startCharacter)) {\r\n            result.startCharacter = startCharacter;\r\n        }\r\n        if (Is.defined(endCharacter)) {\r\n            result.endCharacter = endCharacter;\r\n        }\r\n        if (Is.defined(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    FoldingRange.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FoldingRange](#FoldingRange) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.startLine) && Is.number(candidate.startLine)\r\n            && (Is.undefined(candidate.startCharacter) || Is.number(candidate.startCharacter))\r\n            && (Is.undefined(candidate.endCharacter) || Is.number(candidate.endCharacter))\r\n            && (Is.undefined(candidate.kind) || Is.string(candidate.kind));\r\n    }\r\n    FoldingRange.is = is;\r\n})(FoldingRange || (FoldingRange = {}));\r\n/**\r\n * The DiagnosticRelatedInformation namespace provides helper functions to work with\r\n * [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) literals.\r\n */\r\nexport var DiagnosticRelatedInformation;\r\n(function (DiagnosticRelatedInformation) {\r\n    /**\r\n     * Creates a new DiagnosticRelatedInformation literal.\r\n     */\r\n    function create(location, message) {\r\n        return {\r\n            location: location,\r\n            message: message\r\n        };\r\n    }\r\n    DiagnosticRelatedInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Location.is(candidate.location) && Is.string(candidate.message);\r\n    }\r\n    DiagnosticRelatedInformation.is = is;\r\n})(DiagnosticRelatedInformation || (DiagnosticRelatedInformation = {}));\r\n/**\r\n * The diagnostic's severity.\r\n */\r\nexport var DiagnosticSeverity;\r\n(function (DiagnosticSeverity) {\r\n    /**\r\n     * Reports an error.\r\n     */\r\n    DiagnosticSeverity.Error = 1;\r\n    /**\r\n     * Reports a warning.\r\n     */\r\n    DiagnosticSeverity.Warning = 2;\r\n    /**\r\n     * Reports an information.\r\n     */\r\n    DiagnosticSeverity.Information = 3;\r\n    /**\r\n     * Reports a hint.\r\n     */\r\n    DiagnosticSeverity.Hint = 4;\r\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\r\n/**\r\n * The Diagnostic namespace provides helper functions to work with\r\n * [Diagnostic](#Diagnostic) literals.\r\n */\r\nexport var Diagnostic;\r\n(function (Diagnostic) {\r\n    /**\r\n     * Creates a new Diagnostic literal.\r\n     */\r\n    function create(range, message, severity, code, source, relatedInformation) {\r\n        var result = { range: range, message: message };\r\n        if (Is.defined(severity)) {\r\n            result.severity = severity;\r\n        }\r\n        if (Is.defined(code)) {\r\n            result.code = code;\r\n        }\r\n        if (Is.defined(source)) {\r\n            result.source = source;\r\n        }\r\n        if (Is.defined(relatedInformation)) {\r\n            result.relatedInformation = relatedInformation;\r\n        }\r\n        return result;\r\n    }\r\n    Diagnostic.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Diagnostic](#Diagnostic) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && Range.is(candidate.range)\r\n            && Is.string(candidate.message)\r\n            && (Is.number(candidate.severity) || Is.undefined(candidate.severity))\r\n            && (Is.number(candidate.code) || Is.string(candidate.code) || Is.undefined(candidate.code))\r\n            && (Is.string(candidate.source) || Is.undefined(candidate.source))\r\n            && (Is.undefined(candidate.relatedInformation) || Is.typedArray(candidate.relatedInformation, DiagnosticRelatedInformation.is));\r\n    }\r\n    Diagnostic.is = is;\r\n})(Diagnostic || (Diagnostic = {}));\r\n/**\r\n * The Command namespace provides helper functions to work with\r\n * [Command](#Command) literals.\r\n */\r\nexport var Command;\r\n(function (Command) {\r\n    /**\r\n     * Creates a new Command literal.\r\n     */\r\n    function create(title, command) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { title: title, command: command };\r\n        if (Is.defined(args) && args.length > 0) {\r\n            result.arguments = args;\r\n        }\r\n        return result;\r\n    }\r\n    Command.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Command](#Command) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.title) && Is.string(candidate.command);\r\n    }\r\n    Command.is = is;\r\n})(Command || (Command = {}));\r\n/**\r\n * The TextEdit namespace provides helper function to create replace,\r\n * insert and delete edits more easily.\r\n */\r\nexport var TextEdit;\r\n(function (TextEdit) {\r\n    /**\r\n     * Creates a replace text edit.\r\n     * @param range The range of text to be replaced.\r\n     * @param newText The new text.\r\n     */\r\n    function replace(range, newText) {\r\n        return { range: range, newText: newText };\r\n    }\r\n    TextEdit.replace = replace;\r\n    /**\r\n     * Creates a insert text edit.\r\n     * @param position The position to insert the text at.\r\n     * @param newText The text to be inserted.\r\n     */\r\n    function insert(position, newText) {\r\n        return { range: { start: position, end: position }, newText: newText };\r\n    }\r\n    TextEdit.insert = insert;\r\n    /**\r\n     * Creates a delete text edit.\r\n     * @param range The range of text to be deleted.\r\n     */\r\n    function del(range) {\r\n        return { range: range, newText: '' };\r\n    }\r\n    TextEdit.del = del;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate)\r\n            && Is.string(candidate.newText)\r\n            && Range.is(candidate.range);\r\n    }\r\n    TextEdit.is = is;\r\n})(TextEdit || (TextEdit = {}));\r\n/**\r\n * The TextDocumentEdit namespace provides helper function to create\r\n * an edit that manipulates a text document.\r\n */\r\nexport var TextDocumentEdit;\r\n(function (TextDocumentEdit) {\r\n    /**\r\n     * Creates a new `TextDocumentEdit`\r\n     */\r\n    function create(textDocument, edits) {\r\n        return { textDocument: textDocument, edits: edits };\r\n    }\r\n    TextDocumentEdit.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && VersionedTextDocumentIdentifier.is(candidate.textDocument)\r\n            && Array.isArray(candidate.edits);\r\n    }\r\n    TextDocumentEdit.is = is;\r\n})(TextDocumentEdit || (TextDocumentEdit = {}));\r\nexport var CreateFile;\r\n(function (CreateFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'create',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    CreateFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'create' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    CreateFile.is = is;\r\n})(CreateFile || (CreateFile = {}));\r\nexport var RenameFile;\r\n(function (RenameFile) {\r\n    function create(oldUri, newUri, options) {\r\n        var result = {\r\n            kind: 'rename',\r\n            oldUri: oldUri,\r\n            newUri: newUri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    RenameFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'rename' && Is.string(candidate.oldUri) && Is.string(candidate.newUri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    RenameFile.is = is;\r\n})(RenameFile || (RenameFile = {}));\r\nexport var DeleteFile;\r\n(function (DeleteFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'delete',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.recursive !== void 0 || options.ignoreIfNotExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    DeleteFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'delete' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.recursive === void 0 || Is.boolean(candidate.options.recursive)) && (candidate.options.ignoreIfNotExists === void 0 || Is.boolean(candidate.options.ignoreIfNotExists))));\r\n    }\r\n    DeleteFile.is = is;\r\n})(DeleteFile || (DeleteFile = {}));\r\nexport var WorkspaceEdit;\r\n(function (WorkspaceEdit) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            (candidate.changes !== void 0 || candidate.documentChanges !== void 0) &&\r\n            (candidate.documentChanges === void 0 || candidate.documentChanges.every(function (change) {\r\n                if (Is.string(change.kind)) {\r\n                    return CreateFile.is(change) || RenameFile.is(change) || DeleteFile.is(change);\r\n                }\r\n                else {\r\n                    return TextDocumentEdit.is(change);\r\n                }\r\n            }));\r\n    }\r\n    WorkspaceEdit.is = is;\r\n})(WorkspaceEdit || (WorkspaceEdit = {}));\r\nvar TextEditChangeImpl = /** @class */ (function () {\r\n    function TextEditChangeImpl(edits) {\r\n        this.edits = edits;\r\n    }\r\n    TextEditChangeImpl.prototype.insert = function (position, newText) {\r\n        this.edits.push(TextEdit.insert(position, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.replace = function (range, newText) {\r\n        this.edits.push(TextEdit.replace(range, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.delete = function (range) {\r\n        this.edits.push(TextEdit.del(range));\r\n    };\r\n    TextEditChangeImpl.prototype.add = function (edit) {\r\n        this.edits.push(edit);\r\n    };\r\n    TextEditChangeImpl.prototype.all = function () {\r\n        return this.edits;\r\n    };\r\n    TextEditChangeImpl.prototype.clear = function () {\r\n        this.edits.splice(0, this.edits.length);\r\n    };\r\n    return TextEditChangeImpl;\r\n}());\r\n/**\r\n * A workspace change helps constructing changes to a workspace.\r\n */\r\nvar WorkspaceChange = /** @class */ (function () {\r\n    function WorkspaceChange(workspaceEdit) {\r\n        var _this = this;\r\n        this._textEditChanges = Object.create(null);\r\n        if (workspaceEdit) {\r\n            this._workspaceEdit = workspaceEdit;\r\n            if (workspaceEdit.documentChanges) {\r\n                workspaceEdit.documentChanges.forEach(function (change) {\r\n                    if (TextDocumentEdit.is(change)) {\r\n                        var textEditChange = new TextEditChangeImpl(change.edits);\r\n                        _this._textEditChanges[change.textDocument.uri] = textEditChange;\r\n                    }\r\n                });\r\n            }\r\n            else if (workspaceEdit.changes) {\r\n                Object.keys(workspaceEdit.changes).forEach(function (key) {\r\n                    var textEditChange = new TextEditChangeImpl(workspaceEdit.changes[key]);\r\n                    _this._textEditChanges[key] = textEditChange;\r\n                });\r\n            }\r\n        }\r\n    }\r\n    Object.defineProperty(WorkspaceChange.prototype, \"edit\", {\r\n        /**\r\n         * Returns the underlying [WorkspaceEdit](#WorkspaceEdit) literal\r\n         * use to be returned from a workspace edit operation like rename.\r\n         */\r\n        get: function () {\r\n            return this._workspaceEdit;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WorkspaceChange.prototype.getTextEditChange = function (key) {\r\n        if (VersionedTextDocumentIdentifier.is(key)) {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    documentChanges: []\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.documentChanges) {\r\n                throw new Error('Workspace edit is not configured for document changes.');\r\n            }\r\n            var textDocument = key;\r\n            var result = this._textEditChanges[textDocument.uri];\r\n            if (!result) {\r\n                var edits = [];\r\n                var textDocumentEdit = {\r\n                    textDocument: textDocument,\r\n                    edits: edits\r\n                };\r\n                this._workspaceEdit.documentChanges.push(textDocumentEdit);\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[textDocument.uri] = result;\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    changes: Object.create(null)\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.changes) {\r\n                throw new Error('Workspace edit is not configured for normal text edit changes.');\r\n            }\r\n            var result = this._textEditChanges[key];\r\n            if (!result) {\r\n                var edits = [];\r\n                this._workspaceEdit.changes[key] = edits;\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[key] = result;\r\n            }\r\n            return result;\r\n        }\r\n    };\r\n    WorkspaceChange.prototype.createFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(CreateFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.renameFile = function (oldUri, newUri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(RenameFile.create(oldUri, newUri, options));\r\n    };\r\n    WorkspaceChange.prototype.deleteFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(DeleteFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.checkDocumentChanges = function () {\r\n        if (!this._workspaceEdit || !this._workspaceEdit.documentChanges) {\r\n            throw new Error('Workspace edit is not configured for document changes.');\r\n        }\r\n    };\r\n    return WorkspaceChange;\r\n}());\r\nexport { WorkspaceChange };\r\n/**\r\n * The TextDocumentIdentifier namespace provides helper functions to work with\r\n * [TextDocumentIdentifier](#TextDocumentIdentifier) literals.\r\n */\r\nexport var TextDocumentIdentifier;\r\n(function (TextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new TextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     */\r\n    function create(uri) {\r\n        return { uri: uri };\r\n    }\r\n    TextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentIdentifier](#TextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri);\r\n    }\r\n    TextDocumentIdentifier.is = is;\r\n})(TextDocumentIdentifier || (TextDocumentIdentifier = {}));\r\n/**\r\n * The VersionedTextDocumentIdentifier namespace provides helper functions to work with\r\n * [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) literals.\r\n */\r\nexport var VersionedTextDocumentIdentifier;\r\n(function (VersionedTextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new VersionedTextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     * @param uri The document's text.\r\n     */\r\n    function create(uri, version) {\r\n        return { uri: uri, version: version };\r\n    }\r\n    VersionedTextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (candidate.version === null || Is.number(candidate.version));\r\n    }\r\n    VersionedTextDocumentIdentifier.is = is;\r\n})(VersionedTextDocumentIdentifier || (VersionedTextDocumentIdentifier = {}));\r\n/**\r\n * The TextDocumentItem namespace provides helper functions to work with\r\n * [TextDocumentItem](#TextDocumentItem) literals.\r\n */\r\nexport var TextDocumentItem;\r\n(function (TextDocumentItem) {\r\n    /**\r\n     * Creates a new TextDocumentItem literal.\r\n     * @param uri The document's uri.\r\n     * @param languageId The document's language identifier.\r\n     * @param version The document's version number.\r\n     * @param text The document's text.\r\n     */\r\n    function create(uri, languageId, version, text) {\r\n        return { uri: uri, languageId: languageId, version: version, text: text };\r\n    }\r\n    TextDocumentItem.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentItem](#TextDocumentItem) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && Is.string(candidate.languageId) && Is.number(candidate.version) && Is.string(candidate.text);\r\n    }\r\n    TextDocumentItem.is = is;\r\n})(TextDocumentItem || (TextDocumentItem = {}));\r\n/**\r\n * Describes the content type that a client supports in various\r\n * result literals like `Hover`, `ParameterInfo` or `CompletionItem`.\r\n *\r\n * Please note that `MarkupKinds` must not start with a `$`. This kinds\r\n * are reserved for internal usage.\r\n */\r\nexport var MarkupKind;\r\n(function (MarkupKind) {\r\n    /**\r\n     * Plain text is supported as a content format\r\n     */\r\n    MarkupKind.PlainText = 'plaintext';\r\n    /**\r\n     * Markdown is supported as a content format\r\n     */\r\n    MarkupKind.Markdown = 'markdown';\r\n})(MarkupKind || (MarkupKind = {}));\r\n(function (MarkupKind) {\r\n    /**\r\n     * Checks whether the given value is a value of the [MarkupKind](#MarkupKind) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate === MarkupKind.PlainText || candidate === MarkupKind.Markdown;\r\n    }\r\n    MarkupKind.is = is;\r\n})(MarkupKind || (MarkupKind = {}));\r\nexport var MarkupContent;\r\n(function (MarkupContent) {\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkupContent](#MarkupContent) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(value) && MarkupKind.is(candidate.kind) && Is.string(candidate.value);\r\n    }\r\n    MarkupContent.is = is;\r\n})(MarkupContent || (MarkupContent = {}));\r\n/**\r\n * The kind of a completion entry.\r\n */\r\nexport var CompletionItemKind;\r\n(function (CompletionItemKind) {\r\n    CompletionItemKind.Text = 1;\r\n    CompletionItemKind.Method = 2;\r\n    CompletionItemKind.Function = 3;\r\n    CompletionItemKind.Constructor = 4;\r\n    CompletionItemKind.Field = 5;\r\n    CompletionItemKind.Variable = 6;\r\n    CompletionItemKind.Class = 7;\r\n    CompletionItemKind.Interface = 8;\r\n    CompletionItemKind.Module = 9;\r\n    CompletionItemKind.Property = 10;\r\n    CompletionItemKind.Unit = 11;\r\n    CompletionItemKind.Value = 12;\r\n    CompletionItemKind.Enum = 13;\r\n    CompletionItemKind.Keyword = 14;\r\n    CompletionItemKind.Snippet = 15;\r\n    CompletionItemKind.Color = 16;\r\n    CompletionItemKind.File = 17;\r\n    CompletionItemKind.Reference = 18;\r\n    CompletionItemKind.Folder = 19;\r\n    CompletionItemKind.EnumMember = 20;\r\n    CompletionItemKind.Constant = 21;\r\n    CompletionItemKind.Struct = 22;\r\n    CompletionItemKind.Event = 23;\r\n    CompletionItemKind.Operator = 24;\r\n    CompletionItemKind.TypeParameter = 25;\r\n})(CompletionItemKind || (CompletionItemKind = {}));\r\n/**\r\n * Defines whether the insert text in a completion item should be interpreted as\r\n * plain text or a snippet.\r\n */\r\nexport var InsertTextFormat;\r\n(function (InsertTextFormat) {\r\n    /**\r\n     * The primary text to be inserted is treated as a plain string.\r\n     */\r\n    InsertTextFormat.PlainText = 1;\r\n    /**\r\n     * The primary text to be inserted is treated as a snippet.\r\n     *\r\n     * A snippet can define tab stops and placeholders with `$1`, `$2`\r\n     * and `${3:foo}`. `$0` defines the final tab stop, it defaults to\r\n     * the end of the snippet. Placeholders with equal identifiers are linked,\r\n     * that is typing in one will update others too.\r\n     *\r\n     * See also: https://github.com/Microsoft/vscode/blob/master/src/vs/editor/contrib/snippet/common/snippet.md\r\n     */\r\n    InsertTextFormat.Snippet = 2;\r\n})(InsertTextFormat || (InsertTextFormat = {}));\r\n/**\r\n * The CompletionItem namespace provides functions to deal with\r\n * completion items.\r\n */\r\nexport var CompletionItem;\r\n(function (CompletionItem) {\r\n    /**\r\n     * Create a completion item and seed it with a label.\r\n     * @param label The completion item's label\r\n     */\r\n    function create(label) {\r\n        return { label: label };\r\n    }\r\n    CompletionItem.create = create;\r\n})(CompletionItem || (CompletionItem = {}));\r\n/**\r\n * The CompletionList namespace provides functions to deal with\r\n * completion lists.\r\n */\r\nexport var CompletionList;\r\n(function (CompletionList) {\r\n    /**\r\n     * Creates a new completion list.\r\n     *\r\n     * @param items The completion items.\r\n     * @param isIncomplete The list is not complete.\r\n     */\r\n    function create(items, isIncomplete) {\r\n        return { items: items ? items : [], isIncomplete: !!isIncomplete };\r\n    }\r\n    CompletionList.create = create;\r\n})(CompletionList || (CompletionList = {}));\r\nexport var MarkedString;\r\n(function (MarkedString) {\r\n    /**\r\n     * Creates a marked string from plain text.\r\n     *\r\n     * @param plainText The plain text.\r\n     */\r\n    function fromPlainText(plainText) {\r\n        return plainText.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, \"\\\\$&\"); // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n    }\r\n    MarkedString.fromPlainText = fromPlainText;\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkedString](#MarkedString) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate) || (Is.objectLiteral(candidate) && Is.string(candidate.language) && Is.string(candidate.value));\r\n    }\r\n    MarkedString.is = is;\r\n})(MarkedString || (MarkedString = {}));\r\nexport var Hover;\r\n(function (Hover) {\r\n    /**\r\n     * Checks whether the given value conforms to the [Hover](#Hover) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return !!candidate && Is.objectLiteral(candidate) && (MarkupContent.is(candidate.contents) ||\r\n            MarkedString.is(candidate.contents) ||\r\n            Is.typedArray(candidate.contents, MarkedString.is)) && (value.range === void 0 || Range.is(value.range));\r\n    }\r\n    Hover.is = is;\r\n})(Hover || (Hover = {}));\r\n/**\r\n * The ParameterInformation namespace provides helper functions to work with\r\n * [ParameterInformation](#ParameterInformation) literals.\r\n */\r\nexport var ParameterInformation;\r\n(function (ParameterInformation) {\r\n    /**\r\n     * Creates a new parameter information literal.\r\n     *\r\n     * @param label A label string.\r\n     * @param documentation A doc string.\r\n     */\r\n    function create(label, documentation) {\r\n        return documentation ? { label: label, documentation: documentation } : { label: label };\r\n    }\r\n    ParameterInformation.create = create;\r\n    ;\r\n})(ParameterInformation || (ParameterInformation = {}));\r\n/**\r\n * The SignatureInformation namespace provides helper functions to work with\r\n * [SignatureInformation](#SignatureInformation) literals.\r\n */\r\nexport var SignatureInformation;\r\n(function (SignatureInformation) {\r\n    function create(label, documentation) {\r\n        var parameters = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            parameters[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { label: label };\r\n        if (Is.defined(documentation)) {\r\n            result.documentation = documentation;\r\n        }\r\n        if (Is.defined(parameters)) {\r\n            result.parameters = parameters;\r\n        }\r\n        else {\r\n            result.parameters = [];\r\n        }\r\n        return result;\r\n    }\r\n    SignatureInformation.create = create;\r\n})(SignatureInformation || (SignatureInformation = {}));\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport var DocumentHighlightKind;\r\n(function (DocumentHighlightKind) {\r\n    /**\r\n     * A textual occurrence.\r\n     */\r\n    DocumentHighlightKind.Text = 1;\r\n    /**\r\n     * Read-access of a symbol, like reading a variable.\r\n     */\r\n    DocumentHighlightKind.Read = 2;\r\n    /**\r\n     * Write-access of a symbol, like writing to a variable.\r\n     */\r\n    DocumentHighlightKind.Write = 3;\r\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\r\n/**\r\n * DocumentHighlight namespace to provide helper functions to work with\r\n * [DocumentHighlight](#DocumentHighlight) literals.\r\n */\r\nexport var DocumentHighlight;\r\n(function (DocumentHighlight) {\r\n    /**\r\n     * Create a DocumentHighlight object.\r\n     * @param range The range the highlight applies to.\r\n     */\r\n    function create(range, kind) {\r\n        var result = { range: range };\r\n        if (Is.number(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentHighlight.create = create;\r\n})(DocumentHighlight || (DocumentHighlight = {}));\r\n/**\r\n * A symbol kind.\r\n */\r\nexport var SymbolKind;\r\n(function (SymbolKind) {\r\n    SymbolKind.File = 1;\r\n    SymbolKind.Module = 2;\r\n    SymbolKind.Namespace = 3;\r\n    SymbolKind.Package = 4;\r\n    SymbolKind.Class = 5;\r\n    SymbolKind.Method = 6;\r\n    SymbolKind.Property = 7;\r\n    SymbolKind.Field = 8;\r\n    SymbolKind.Constructor = 9;\r\n    SymbolKind.Enum = 10;\r\n    SymbolKind.Interface = 11;\r\n    SymbolKind.Function = 12;\r\n    SymbolKind.Variable = 13;\r\n    SymbolKind.Constant = 14;\r\n    SymbolKind.String = 15;\r\n    SymbolKind.Number = 16;\r\n    SymbolKind.Boolean = 17;\r\n    SymbolKind.Array = 18;\r\n    SymbolKind.Object = 19;\r\n    SymbolKind.Key = 20;\r\n    SymbolKind.Null = 21;\r\n    SymbolKind.EnumMember = 22;\r\n    SymbolKind.Struct = 23;\r\n    SymbolKind.Event = 24;\r\n    SymbolKind.Operator = 25;\r\n    SymbolKind.TypeParameter = 26;\r\n})(SymbolKind || (SymbolKind = {}));\r\nexport var SymbolInformation;\r\n(function (SymbolInformation) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the location of the symbol.\r\n     * @param uri The resource of the location of symbol, defaults to the current document.\r\n     * @param containerName The name of the symbol containing the symbol.\r\n     */\r\n    function create(name, kind, range, uri, containerName) {\r\n        var result = {\r\n            name: name,\r\n            kind: kind,\r\n            location: { uri: uri, range: range }\r\n        };\r\n        if (containerName) {\r\n            result.containerName = containerName;\r\n        }\r\n        return result;\r\n    }\r\n    SymbolInformation.create = create;\r\n})(SymbolInformation || (SymbolInformation = {}));\r\n/**\r\n * Represents programming constructs like variables, classes, interfaces etc.\r\n * that appear in a document. Document symbols can be hierarchical and they\r\n * have two ranges: one that encloses its definition and one that points to\r\n * its most interesting range, e.g. the range of an identifier.\r\n */\r\nvar DocumentSymbol = /** @class */ (function () {\r\n    function DocumentSymbol() {\r\n    }\r\n    return DocumentSymbol;\r\n}());\r\nexport { DocumentSymbol };\r\n(function (DocumentSymbol) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param detail The detail of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the symbol.\r\n     * @param selectionRange The selectionRange of the symbol.\r\n     * @param children Children of the symbol.\r\n     */\r\n    function create(name, detail, kind, range, selectionRange, children) {\r\n        var result = {\r\n            name: name,\r\n            detail: detail,\r\n            kind: kind,\r\n            range: range,\r\n            selectionRange: selectionRange\r\n        };\r\n        if (children !== void 0) {\r\n            result.children = children;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentSymbol.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentSymbol](#DocumentSymbol) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            Is.string(candidate.name) && Is.number(candidate.kind) &&\r\n            Range.is(candidate.range) && Range.is(candidate.selectionRange) &&\r\n            (candidate.detail === void 0 || Is.string(candidate.detail)) &&\r\n            (candidate.deprecated === void 0 || Is.boolean(candidate.deprecated)) &&\r\n            (candidate.children === void 0 || Array.isArray(candidate.children));\r\n    }\r\n    DocumentSymbol.is = is;\r\n})(DocumentSymbol || (DocumentSymbol = {}));\r\n/**\r\n * A set of predefined code action kinds\r\n */\r\nexport var CodeActionKind;\r\n(function (CodeActionKind) {\r\n    /**\r\n     * Base kind for quickfix actions: 'quickfix'\r\n     */\r\n    CodeActionKind.QuickFix = 'quickfix';\r\n    /**\r\n     * Base kind for refactoring actions: 'refactor'\r\n     */\r\n    CodeActionKind.Refactor = 'refactor';\r\n    /**\r\n     * Base kind for refactoring extraction actions: 'refactor.extract'\r\n     *\r\n     * Example extract actions:\r\n     *\r\n     * - Extract method\r\n     * - Extract function\r\n     * - Extract variable\r\n     * - Extract interface from class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorExtract = 'refactor.extract';\r\n    /**\r\n     * Base kind for refactoring inline actions: 'refactor.inline'\r\n     *\r\n     * Example inline actions:\r\n     *\r\n     * - Inline function\r\n     * - Inline variable\r\n     * - Inline constant\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorInline = 'refactor.inline';\r\n    /**\r\n     * Base kind for refactoring rewrite actions: 'refactor.rewrite'\r\n     *\r\n     * Example rewrite actions:\r\n     *\r\n     * - Convert JavaScript function to class\r\n     * - Add or remove parameter\r\n     * - Encapsulate field\r\n     * - Make method static\r\n     * - Move method to base class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorRewrite = 'refactor.rewrite';\r\n    /**\r\n     * Base kind for source actions: `source`\r\n     *\r\n     * Source code actions apply to the entire file.\r\n     */\r\n    CodeActionKind.Source = 'source';\r\n    /**\r\n     * Base kind for an organize imports source action: `source.organizeImports`\r\n     */\r\n    CodeActionKind.SourceOrganizeImports = 'source.organizeImports';\r\n})(CodeActionKind || (CodeActionKind = {}));\r\n/**\r\n * The CodeActionContext namespace provides helper functions to work with\r\n * [CodeActionContext](#CodeActionContext) literals.\r\n */\r\nexport var CodeActionContext;\r\n(function (CodeActionContext) {\r\n    /**\r\n     * Creates a new CodeActionContext literal.\r\n     */\r\n    function create(diagnostics, only) {\r\n        var result = { diagnostics: diagnostics };\r\n        if (only !== void 0 && only !== null) {\r\n            result.only = only;\r\n        }\r\n        return result;\r\n    }\r\n    CodeActionContext.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeActionContext](#CodeActionContext) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.typedArray(candidate.diagnostics, Diagnostic.is) && (candidate.only === void 0 || Is.typedArray(candidate.only, Is.string));\r\n    }\r\n    CodeActionContext.is = is;\r\n})(CodeActionContext || (CodeActionContext = {}));\r\nexport var CodeAction;\r\n(function (CodeAction) {\r\n    function create(title, commandOrEdit, kind) {\r\n        var result = { title: title };\r\n        if (Command.is(commandOrEdit)) {\r\n            result.command = commandOrEdit;\r\n        }\r\n        else {\r\n            result.edit = commandOrEdit;\r\n        }\r\n        if (kind !== void null) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    CodeAction.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.string(candidate.title) &&\r\n            (candidate.diagnostics === void 0 || Is.typedArray(candidate.diagnostics, Diagnostic.is)) &&\r\n            (candidate.kind === void 0 || Is.string(candidate.kind)) &&\r\n            (candidate.edit !== void 0 || candidate.command !== void 0) &&\r\n            (candidate.command === void 0 || Command.is(candidate.command)) &&\r\n            (candidate.edit === void 0 || WorkspaceEdit.is(candidate.edit));\r\n    }\r\n    CodeAction.is = is;\r\n})(CodeAction || (CodeAction = {}));\r\n/**\r\n * The CodeLens namespace provides helper functions to work with\r\n * [CodeLens](#CodeLens) literals.\r\n */\r\nexport var CodeLens;\r\n(function (CodeLens) {\r\n    /**\r\n     * Creates a new CodeLens literal.\r\n     */\r\n    function create(range, data) {\r\n        var result = { range: range };\r\n        if (Is.defined(data))\r\n            result.data = data;\r\n        return result;\r\n    }\r\n    CodeLens.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeLens](#CodeLens) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.command) || Command.is(candidate.command));\r\n    }\r\n    CodeLens.is = is;\r\n})(CodeLens || (CodeLens = {}));\r\n/**\r\n * The FormattingOptions namespace provides helper functions to work with\r\n * [FormattingOptions](#FormattingOptions) literals.\r\n */\r\nexport var FormattingOptions;\r\n(function (FormattingOptions) {\r\n    /**\r\n     * Creates a new FormattingOptions literal.\r\n     */\r\n    function create(tabSize, insertSpaces) {\r\n        return { tabSize: tabSize, insertSpaces: insertSpaces };\r\n    }\r\n    FormattingOptions.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FormattingOptions](#FormattingOptions) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.number(candidate.tabSize) && Is.boolean(candidate.insertSpaces);\r\n    }\r\n    FormattingOptions.is = is;\r\n})(FormattingOptions || (FormattingOptions = {}));\r\n/**\r\n * A document link is a range in a text document that links to an internal or external resource, like another\r\n * text document or a web site.\r\n */\r\nvar DocumentLink = /** @class */ (function () {\r\n    function DocumentLink() {\r\n    }\r\n    return DocumentLink;\r\n}());\r\nexport { DocumentLink };\r\n/**\r\n * The DocumentLink namespace provides helper functions to work with\r\n * [DocumentLink](#DocumentLink) literals.\r\n */\r\n(function (DocumentLink) {\r\n    /**\r\n     * Creates a new DocumentLink literal.\r\n     */\r\n    function create(range, target, data) {\r\n        return { range: range, target: target, data: data };\r\n    }\r\n    DocumentLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentLink](#DocumentLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.target) || Is.string(candidate.target));\r\n    }\r\n    DocumentLink.is = is;\r\n})(DocumentLink || (DocumentLink = {}));\r\nexport var EOL = ['\\n', '\\r\\n', '\\r'];\r\nexport var TextDocument;\r\n(function (TextDocument) {\r\n    /**\r\n     * Creates a new ITextDocument literal from the given uri and content.\r\n     * @param uri The document's uri.\r\n     * @param languageId  The document's language Id.\r\n     * @param content The document's content.\r\n     */\r\n    function create(uri, languageId, version, content) {\r\n        return new FullTextDocument(uri, languageId, version, content);\r\n    }\r\n    TextDocument.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ITextDocument](#ITextDocument) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (Is.undefined(candidate.languageId) || Is.string(candidate.languageId)) && Is.number(candidate.lineCount)\r\n            && Is.func(candidate.getText) && Is.func(candidate.positionAt) && Is.func(candidate.offsetAt) ? true : false;\r\n    }\r\n    TextDocument.is = is;\r\n    function applyEdits(document, edits) {\r\n        var text = document.getText();\r\n        var sortedEdits = mergeSort(edits, function (a, b) {\r\n            var diff = a.range.start.line - b.range.start.line;\r\n            if (diff === 0) {\r\n                return a.range.start.character - b.range.start.character;\r\n            }\r\n            return diff;\r\n        });\r\n        var lastModifiedOffset = text.length;\r\n        for (var i = sortedEdits.length - 1; i >= 0; i--) {\r\n            var e = sortedEdits[i];\r\n            var startOffset = document.offsetAt(e.range.start);\r\n            var endOffset = document.offsetAt(e.range.end);\r\n            if (endOffset <= lastModifiedOffset) {\r\n                text = text.substring(0, startOffset) + e.newText + text.substring(endOffset, text.length);\r\n            }\r\n            else {\r\n                throw new Error('Overlapping edit');\r\n            }\r\n            lastModifiedOffset = startOffset;\r\n        }\r\n        return text;\r\n    }\r\n    TextDocument.applyEdits = applyEdits;\r\n    function mergeSort(data, compare) {\r\n        if (data.length <= 1) {\r\n            // sorted\r\n            return data;\r\n        }\r\n        var p = (data.length / 2) | 0;\r\n        var left = data.slice(0, p);\r\n        var right = data.slice(p);\r\n        mergeSort(left, compare);\r\n        mergeSort(right, compare);\r\n        var leftIdx = 0;\r\n        var rightIdx = 0;\r\n        var i = 0;\r\n        while (leftIdx < left.length && rightIdx < right.length) {\r\n            var ret = compare(left[leftIdx], right[rightIdx]);\r\n            if (ret <= 0) {\r\n                // smaller_equal -> take left to preserve order\r\n                data[i++] = left[leftIdx++];\r\n            }\r\n            else {\r\n                // greater -> take right\r\n                data[i++] = right[rightIdx++];\r\n            }\r\n        }\r\n        while (leftIdx < left.length) {\r\n            data[i++] = left[leftIdx++];\r\n        }\r\n        while (rightIdx < right.length) {\r\n            data[i++] = right[rightIdx++];\r\n        }\r\n        return data;\r\n    }\r\n})(TextDocument || (TextDocument = {}));\r\n/**\r\n * Represents reasons why a text document is saved.\r\n */\r\nexport var TextDocumentSaveReason;\r\n(function (TextDocumentSaveReason) {\r\n    /**\r\n     * Manually triggered, e.g. by the user pressing save, by starting debugging,\r\n     * or by an API call.\r\n     */\r\n    TextDocumentSaveReason.Manual = 1;\r\n    /**\r\n     * Automatic after a delay.\r\n     */\r\n    TextDocumentSaveReason.AfterDelay = 2;\r\n    /**\r\n     * When the editor lost focus.\r\n     */\r\n    TextDocumentSaveReason.FocusOut = 3;\r\n})(TextDocumentSaveReason || (TextDocumentSaveReason = {}));\r\nvar FullTextDocument = /** @class */ (function () {\r\n    function FullTextDocument(uri, languageId, version, content) {\r\n        this._uri = uri;\r\n        this._languageId = languageId;\r\n        this._version = version;\r\n        this._content = content;\r\n        this._lineOffsets = null;\r\n    }\r\n    Object.defineProperty(FullTextDocument.prototype, \"uri\", {\r\n        get: function () {\r\n            return this._uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"version\", {\r\n        get: function () {\r\n            return this._version;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FullTextDocument.prototype.getText = function (range) {\r\n        if (range) {\r\n            var start = this.offsetAt(range.start);\r\n            var end = this.offsetAt(range.end);\r\n            return this._content.substring(start, end);\r\n        }\r\n        return this._content;\r\n    };\r\n    FullTextDocument.prototype.update = function (event, version) {\r\n        this._content = event.text;\r\n        this._version = version;\r\n        this._lineOffsets = null;\r\n    };\r\n    FullTextDocument.prototype.getLineOffsets = function () {\r\n        if (this._lineOffsets === null) {\r\n            var lineOffsets = [];\r\n            var text = this._content;\r\n            var isLineStart = true;\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (isLineStart) {\r\n                    lineOffsets.push(i);\r\n                    isLineStart = false;\r\n                }\r\n                var ch = text.charAt(i);\r\n                isLineStart = (ch === '\\r' || ch === '\\n');\r\n                if (ch === '\\r' && i + 1 < text.length && text.charAt(i + 1) === '\\n') {\r\n                    i++;\r\n                }\r\n            }\r\n            if (isLineStart && text.length > 0) {\r\n                lineOffsets.push(text.length);\r\n            }\r\n            this._lineOffsets = lineOffsets;\r\n        }\r\n        return this._lineOffsets;\r\n    };\r\n    FullTextDocument.prototype.positionAt = function (offset) {\r\n        offset = Math.max(Math.min(offset, this._content.length), 0);\r\n        var lineOffsets = this.getLineOffsets();\r\n        var low = 0, high = lineOffsets.length;\r\n        if (high === 0) {\r\n            return Position.create(0, offset);\r\n        }\r\n        while (low < high) {\r\n            var mid = Math.floor((low + high) / 2);\r\n            if (lineOffsets[mid] > offset) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        // low is the least x for which the line offset is larger than the current offset\r\n        // or array.length if no line offset is larger than the current offset\r\n        var line = low - 1;\r\n        return Position.create(line, offset - lineOffsets[line]);\r\n    };\r\n    FullTextDocument.prototype.offsetAt = function (position) {\r\n        var lineOffsets = this.getLineOffsets();\r\n        if (position.line >= lineOffsets.length) {\r\n            return this._content.length;\r\n        }\r\n        else if (position.line < 0) {\r\n            return 0;\r\n        }\r\n        var lineOffset = lineOffsets[position.line];\r\n        var nextLineOffset = (position.line + 1 < lineOffsets.length) ? lineOffsets[position.line + 1] : this._content.length;\r\n        return Math.max(Math.min(lineOffset + position.character, nextLineOffset), lineOffset);\r\n    };\r\n    Object.defineProperty(FullTextDocument.prototype, \"lineCount\", {\r\n        get: function () {\r\n            return this.getLineOffsets().length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FullTextDocument;\r\n}());\r\nvar Is;\r\n(function (Is) {\r\n    var toString = Object.prototype.toString;\r\n    function defined(value) {\r\n        return typeof value !== 'undefined';\r\n    }\r\n    Is.defined = defined;\r\n    function undefined(value) {\r\n        return typeof value === 'undefined';\r\n    }\r\n    Is.undefined = undefined;\r\n    function boolean(value) {\r\n        return value === true || value === false;\r\n    }\r\n    Is.boolean = boolean;\r\n    function string(value) {\r\n        return toString.call(value) === '[object String]';\r\n    }\r\n    Is.string = string;\r\n    function number(value) {\r\n        return toString.call(value) === '[object Number]';\r\n    }\r\n    Is.number = number;\r\n    function func(value) {\r\n        return toString.call(value) === '[object Function]';\r\n    }\r\n    Is.func = func;\r\n    function objectLiteral(value) {\r\n        // Strictly speaking class instances pass this check as well. Since the LSP\r\n        // doesn't use classes we ignore this for now. If we do we need to add something\r\n        // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\r\n        return value !== null && typeof value === 'object';\r\n    }\r\n    Is.objectLiteral = objectLiteral;\r\n    function typedArray(value, check) {\r\n        return Array.isArray(value) && value.every(check);\r\n    }\r\n    Is.typedArray = typedArray;\r\n})(Is || (Is = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./utils/is\");\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst protocol_implementation_1 = require(\"./protocol.implementation\");\r\nexports.ImplementationRequest = protocol_implementation_1.ImplementationRequest;\r\nconst protocol_typeDefinition_1 = require(\"./protocol.typeDefinition\");\r\nexports.TypeDefinitionRequest = protocol_typeDefinition_1.TypeDefinitionRequest;\r\nconst protocol_workspaceFolders_1 = require(\"./protocol.workspaceFolders\");\r\nexports.WorkspaceFoldersRequest = protocol_workspaceFolders_1.WorkspaceFoldersRequest;\r\nexports.DidChangeWorkspaceFoldersNotification = protocol_workspaceFolders_1.DidChangeWorkspaceFoldersNotification;\r\nconst protocol_configuration_1 = require(\"./protocol.configuration\");\r\nexports.ConfigurationRequest = protocol_configuration_1.ConfigurationRequest;\r\nconst protocol_colorProvider_1 = require(\"./protocol.colorProvider\");\r\nexports.DocumentColorRequest = protocol_colorProvider_1.DocumentColorRequest;\r\nexports.ColorPresentationRequest = protocol_colorProvider_1.ColorPresentationRequest;\r\nconst protocol_foldingRange_1 = require(\"./protocol.foldingRange\");\r\nexports.FoldingRangeRequest = protocol_foldingRange_1.FoldingRangeRequest;\r\nconst protocol_declaration_1 = require(\"./protocol.declaration\");\r\nexports.DeclarationRequest = protocol_declaration_1.DeclarationRequest;\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\nvar DocumentFilter;\r\n(function (DocumentFilter) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return Is.string(candidate.language) || Is.string(candidate.scheme) || Is.string(candidate.pattern);\r\n    }\r\n    DocumentFilter.is = is;\r\n})(DocumentFilter = exports.DocumentFilter || (exports.DocumentFilter = {}));\r\n/**\r\n * The `client/registerCapability` request is sent from the server to the client to register a new capability\r\n * handler on the client side.\r\n */\r\nvar RegistrationRequest;\r\n(function (RegistrationRequest) {\r\n    RegistrationRequest.type = new vscode_jsonrpc_1.RequestType('client/registerCapability');\r\n})(RegistrationRequest = exports.RegistrationRequest || (exports.RegistrationRequest = {}));\r\n/**\r\n * The `client/unregisterCapability` request is sent from the server to the client to unregister a previously registered capability\r\n * handler on the client side.\r\n */\r\nvar UnregistrationRequest;\r\n(function (UnregistrationRequest) {\r\n    UnregistrationRequest.type = new vscode_jsonrpc_1.RequestType('client/unregisterCapability');\r\n})(UnregistrationRequest = exports.UnregistrationRequest || (exports.UnregistrationRequest = {}));\r\nvar ResourceOperationKind;\r\n(function (ResourceOperationKind) {\r\n    /**\r\n     * Supports creating new files and folders.\r\n     */\r\n    ResourceOperationKind.Create = 'create';\r\n    /**\r\n     * Supports renaming existing files and folders.\r\n     */\r\n    ResourceOperationKind.Rename = 'rename';\r\n    /**\r\n     * Supports deleting existing files and folders.\r\n     */\r\n    ResourceOperationKind.Delete = 'delete';\r\n})(ResourceOperationKind = exports.ResourceOperationKind || (exports.ResourceOperationKind = {}));\r\nvar FailureHandlingKind;\r\n(function (FailureHandlingKind) {\r\n    /**\r\n     * Applying the workspace change is simply aborted if one of the changes provided\r\n     * fails. All operations executed before the failing operation stay executed.\r\n     */\r\n    FailureHandlingKind.Abort = 'abort';\r\n    /**\r\n     * All operations are executed transactional. That means they either all\r\n     * succeed or no changes at all are applied to the workspace.\r\n     */\r\n    FailureHandlingKind.Transactional = 'transactional';\r\n    /**\r\n     * If the workspace edit contains only textual file changes they are executed transactional.\r\n     * If resource changes (create, rename or delete file) are part of the change the failure\r\n     * handling startegy is abort.\r\n     */\r\n    FailureHandlingKind.TextOnlyTransactional = 'textOnlyTransactional';\r\n    /**\r\n     * The client tries to undo the operations already executed. But there is no\r\n     * guaruntee that this is succeeding.\r\n     */\r\n    FailureHandlingKind.Undo = 'undo';\r\n})(FailureHandlingKind = exports.FailureHandlingKind || (exports.FailureHandlingKind = {}));\r\n/**\r\n * Defines how the host (editor) should sync\r\n * document changes to the language server.\r\n */\r\nvar TextDocumentSyncKind;\r\n(function (TextDocumentSyncKind) {\r\n    /**\r\n     * Documents should not be synced at all.\r\n     */\r\n    TextDocumentSyncKind.None = 0;\r\n    /**\r\n     * Documents are synced by always sending the full content\r\n     * of the document.\r\n     */\r\n    TextDocumentSyncKind.Full = 1;\r\n    /**\r\n     * Documents are synced by sending the full content on open.\r\n     * After that only incremental updates to the document are\r\n     * send.\r\n     */\r\n    TextDocumentSyncKind.Incremental = 2;\r\n})(TextDocumentSyncKind = exports.TextDocumentSyncKind || (exports.TextDocumentSyncKind = {}));\r\n/**\r\n * The initialize request is sent from the client to the server.\r\n * It is sent once as the request after starting up the server.\r\n * The requests parameter is of type [InitializeParams](#InitializeParams)\r\n * the response if of type [InitializeResult](#InitializeResult) of a Thenable that\r\n * resolves to such.\r\n */\r\nvar InitializeRequest;\r\n(function (InitializeRequest) {\r\n    InitializeRequest.type = new vscode_jsonrpc_1.RequestType('initialize');\r\n})(InitializeRequest = exports.InitializeRequest || (exports.InitializeRequest = {}));\r\n/**\r\n * Known error codes for an `InitializeError`;\r\n */\r\nvar InitializeError;\r\n(function (InitializeError) {\r\n    /**\r\n     * If the protocol version provided by the client can't be handled by the server.\r\n     * @deprecated This initialize error got replaced by client capabilities. There is\r\n     * no version handshake in version 3.0x\r\n     */\r\n    InitializeError.unknownProtocolVersion = 1;\r\n})(InitializeError = exports.InitializeError || (exports.InitializeError = {}));\r\n/**\r\n * The intialized notification is sent from the client to the\r\n * server after the client is fully initialized and the server\r\n * is allowed to send requests from the server to the client.\r\n */\r\nvar InitializedNotification;\r\n(function (InitializedNotification) {\r\n    InitializedNotification.type = new vscode_jsonrpc_1.NotificationType('initialized');\r\n})(InitializedNotification = exports.InitializedNotification || (exports.InitializedNotification = {}));\r\n//---- Shutdown Method ----\r\n/**\r\n * A shutdown request is sent from the client to the server.\r\n * It is sent once when the client decides to shutdown the\r\n * server. The only notification that is sent after a shutdown request\r\n * is the exit event.\r\n */\r\nvar ShutdownRequest;\r\n(function (ShutdownRequest) {\r\n    ShutdownRequest.type = new vscode_jsonrpc_1.RequestType0('shutdown');\r\n})(ShutdownRequest = exports.ShutdownRequest || (exports.ShutdownRequest = {}));\r\n//---- Exit Notification ----\r\n/**\r\n * The exit event is sent from the client to the server to\r\n * ask the server to exit its process.\r\n */\r\nvar ExitNotification;\r\n(function (ExitNotification) {\r\n    ExitNotification.type = new vscode_jsonrpc_1.NotificationType0('exit');\r\n})(ExitNotification = exports.ExitNotification || (exports.ExitNotification = {}));\r\n//---- Configuration notification ----\r\n/**\r\n * The configuration change notification is sent from the client to the server\r\n * when the client's configuration has changed. The notification contains\r\n * the changed configuration as defined by the language client.\r\n */\r\nvar DidChangeConfigurationNotification;\r\n(function (DidChangeConfigurationNotification) {\r\n    DidChangeConfigurationNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeConfiguration');\r\n})(DidChangeConfigurationNotification = exports.DidChangeConfigurationNotification || (exports.DidChangeConfigurationNotification = {}));\r\n//---- Message show and log notifications ----\r\n/**\r\n * The message type\r\n */\r\nvar MessageType;\r\n(function (MessageType) {\r\n    /**\r\n     * An error message.\r\n     */\r\n    MessageType.Error = 1;\r\n    /**\r\n     * A warning message.\r\n     */\r\n    MessageType.Warning = 2;\r\n    /**\r\n     * An information message.\r\n     */\r\n    MessageType.Info = 3;\r\n    /**\r\n     * A log message.\r\n     */\r\n    MessageType.Log = 4;\r\n})(MessageType = exports.MessageType || (exports.MessageType = {}));\r\n/**\r\n * The show message notification is sent from a server to a client to ask\r\n * the client to display a particular message in the user interface.\r\n */\r\nvar ShowMessageNotification;\r\n(function (ShowMessageNotification) {\r\n    ShowMessageNotification.type = new vscode_jsonrpc_1.NotificationType('window/showMessage');\r\n})(ShowMessageNotification = exports.ShowMessageNotification || (exports.ShowMessageNotification = {}));\r\n/**\r\n * The show message request is sent from the server to the client to show a message\r\n * and a set of options actions to the user.\r\n */\r\nvar ShowMessageRequest;\r\n(function (ShowMessageRequest) {\r\n    ShowMessageRequest.type = new vscode_jsonrpc_1.RequestType('window/showMessageRequest');\r\n})(ShowMessageRequest = exports.ShowMessageRequest || (exports.ShowMessageRequest = {}));\r\n/**\r\n * The log message notification is sent from the server to the client to ask\r\n * the client to log a particular message.\r\n */\r\nvar LogMessageNotification;\r\n(function (LogMessageNotification) {\r\n    LogMessageNotification.type = new vscode_jsonrpc_1.NotificationType('window/logMessage');\r\n})(LogMessageNotification = exports.LogMessageNotification || (exports.LogMessageNotification = {}));\r\n//---- Telemetry notification\r\n/**\r\n * The telemetry event notification is sent from the server to the client to ask\r\n * the client to log telemetry data.\r\n */\r\nvar TelemetryEventNotification;\r\n(function (TelemetryEventNotification) {\r\n    TelemetryEventNotification.type = new vscode_jsonrpc_1.NotificationType('telemetry/event');\r\n})(TelemetryEventNotification = exports.TelemetryEventNotification || (exports.TelemetryEventNotification = {}));\r\n/**\r\n * The document open notification is sent from the client to the server to signal\r\n * newly opened text documents. The document's truth is now managed by the client\r\n * and the server must not try to read the document's truth using the document's\r\n * uri. Open in this sense means it is managed by the client. It doesn't necessarily\r\n * mean that its content is presented in an editor. An open notification must not\r\n * be sent more than once without a corresponding close notification send before.\r\n * This means open and close notification must be balanced and the max open count\r\n * is one.\r\n */\r\nvar DidOpenTextDocumentNotification;\r\n(function (DidOpenTextDocumentNotification) {\r\n    DidOpenTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didOpen');\r\n})(DidOpenTextDocumentNotification = exports.DidOpenTextDocumentNotification || (exports.DidOpenTextDocumentNotification = {}));\r\n/**\r\n * The document change notification is sent from the client to the server to signal\r\n * changes to a text document.\r\n */\r\nvar DidChangeTextDocumentNotification;\r\n(function (DidChangeTextDocumentNotification) {\r\n    DidChangeTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didChange');\r\n})(DidChangeTextDocumentNotification = exports.DidChangeTextDocumentNotification || (exports.DidChangeTextDocumentNotification = {}));\r\n/**\r\n * The document close notification is sent from the client to the server when\r\n * the document got closed in the client. The document's truth now exists where\r\n * the document's uri points to (e.g. if the document's uri is a file uri the\r\n * truth now exists on disk). As with the open notification the close notification\r\n * is about managing the document's content. Receiving a close notification\r\n * doesn't mean that the document was open in an editor before. A close\r\n * notification requires a previous open notification to be sent.\r\n */\r\nvar DidCloseTextDocumentNotification;\r\n(function (DidCloseTextDocumentNotification) {\r\n    DidCloseTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didClose');\r\n})(DidCloseTextDocumentNotification = exports.DidCloseTextDocumentNotification || (exports.DidCloseTextDocumentNotification = {}));\r\n/**\r\n * The document save notification is sent from the client to the server when\r\n * the document got saved in the client.\r\n */\r\nvar DidSaveTextDocumentNotification;\r\n(function (DidSaveTextDocumentNotification) {\r\n    DidSaveTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/didSave');\r\n})(DidSaveTextDocumentNotification = exports.DidSaveTextDocumentNotification || (exports.DidSaveTextDocumentNotification = {}));\r\n/**\r\n * A document will save notification is sent from the client to the server before\r\n * the document is actually saved.\r\n */\r\nvar WillSaveTextDocumentNotification;\r\n(function (WillSaveTextDocumentNotification) {\r\n    WillSaveTextDocumentNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/willSave');\r\n})(WillSaveTextDocumentNotification = exports.WillSaveTextDocumentNotification || (exports.WillSaveTextDocumentNotification = {}));\r\n/**\r\n * A document will save request is sent from the client to the server before\r\n * the document is actually saved. The request can return an array of TextEdits\r\n * which will be applied to the text document before it is saved. Please note that\r\n * clients might drop results if computing the text edits took too long or if a\r\n * server constantly fails on this request. This is done to keep the save fast and\r\n * reliable.\r\n */\r\nvar WillSaveTextDocumentWaitUntilRequest;\r\n(function (WillSaveTextDocumentWaitUntilRequest) {\r\n    WillSaveTextDocumentWaitUntilRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/willSaveWaitUntil');\r\n})(WillSaveTextDocumentWaitUntilRequest = exports.WillSaveTextDocumentWaitUntilRequest || (exports.WillSaveTextDocumentWaitUntilRequest = {}));\r\n//---- File eventing ----\r\n/**\r\n * The watched files notification is sent from the client to the server when\r\n * the client detects changes to file watched by the language client.\r\n */\r\nvar DidChangeWatchedFilesNotification;\r\n(function (DidChangeWatchedFilesNotification) {\r\n    DidChangeWatchedFilesNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeWatchedFiles');\r\n})(DidChangeWatchedFilesNotification = exports.DidChangeWatchedFilesNotification || (exports.DidChangeWatchedFilesNotification = {}));\r\n/**\r\n * The file event type\r\n */\r\nvar FileChangeType;\r\n(function (FileChangeType) {\r\n    /**\r\n     * The file got created.\r\n     */\r\n    FileChangeType.Created = 1;\r\n    /**\r\n     * The file got changed.\r\n     */\r\n    FileChangeType.Changed = 2;\r\n    /**\r\n     * The file got deleted.\r\n     */\r\n    FileChangeType.Deleted = 3;\r\n})(FileChangeType = exports.FileChangeType || (exports.FileChangeType = {}));\r\nvar WatchKind;\r\n(function (WatchKind) {\r\n    /**\r\n     * Interested in create events.\r\n     */\r\n    WatchKind.Create = 1;\r\n    /**\r\n     * Interested in change events\r\n     */\r\n    WatchKind.Change = 2;\r\n    /**\r\n     * Interested in delete events\r\n     */\r\n    WatchKind.Delete = 4;\r\n})(WatchKind = exports.WatchKind || (exports.WatchKind = {}));\r\n//---- Diagnostic notification ----\r\n/**\r\n * Diagnostics notification are sent from the server to the client to signal\r\n * results of validation runs.\r\n */\r\nvar PublishDiagnosticsNotification;\r\n(function (PublishDiagnosticsNotification) {\r\n    PublishDiagnosticsNotification.type = new vscode_jsonrpc_1.NotificationType('textDocument/publishDiagnostics');\r\n})(PublishDiagnosticsNotification = exports.PublishDiagnosticsNotification || (exports.PublishDiagnosticsNotification = {}));\r\n/**\r\n * How a completion was triggered\r\n */\r\nvar CompletionTriggerKind;\r\n(function (CompletionTriggerKind) {\r\n    /**\r\n     * Completion was triggered by typing an identifier (24x7 code\r\n     * complete), manual invocation (e.g Ctrl+Space) or via API.\r\n     */\r\n    CompletionTriggerKind.Invoked = 1;\r\n    /**\r\n     * Completion was triggered by a trigger character specified by\r\n     * the `triggerCharacters` properties of the `CompletionRegistrationOptions`.\r\n     */\r\n    CompletionTriggerKind.TriggerCharacter = 2;\r\n    /**\r\n     * Completion was re-triggered as current completion list is incomplete\r\n     */\r\n    CompletionTriggerKind.TriggerForIncompleteCompletions = 3;\r\n})(CompletionTriggerKind = exports.CompletionTriggerKind || (exports.CompletionTriggerKind = {}));\r\n/**\r\n * Request to request completion at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response\r\n * is of type [CompletionItem[]](#CompletionItem) or [CompletionList](#CompletionList)\r\n * or a Thenable that resolves to such.\r\n *\r\n * The request can delay the computation of the [`detail`](#CompletionItem.detail)\r\n * and [`documentation`](#CompletionItem.documentation) properties to the `completionItem/resolve`\r\n * request. However, properties that are needed for the initial sorting and filtering, like `sortText`,\r\n * `filterText`, `insertText`, and `textEdit`, must not be changed during resolve.\r\n */\r\nvar CompletionRequest;\r\n(function (CompletionRequest) {\r\n    CompletionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/completion');\r\n})(CompletionRequest = exports.CompletionRequest || (exports.CompletionRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given completion item.The request's\r\n * parameter is of type [CompletionItem](#CompletionItem) the response\r\n * is of type [CompletionItem](#CompletionItem) or a Thenable that resolves to such.\r\n */\r\nvar CompletionResolveRequest;\r\n(function (CompletionResolveRequest) {\r\n    CompletionResolveRequest.type = new vscode_jsonrpc_1.RequestType('completionItem/resolve');\r\n})(CompletionResolveRequest = exports.CompletionResolveRequest || (exports.CompletionResolveRequest = {}));\r\n//---- Hover Support -------------------------------\r\n/**\r\n * Request to request hover information at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response is of\r\n * type [Hover](#Hover) or a Thenable that resolves to such.\r\n */\r\nvar HoverRequest;\r\n(function (HoverRequest) {\r\n    HoverRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/hover');\r\n})(HoverRequest = exports.HoverRequest || (exports.HoverRequest = {}));\r\nvar SignatureHelpRequest;\r\n(function (SignatureHelpRequest) {\r\n    SignatureHelpRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/signatureHelp');\r\n})(SignatureHelpRequest = exports.SignatureHelpRequest || (exports.SignatureHelpRequest = {}));\r\n//---- Goto Definition -------------------------------------\r\n/**\r\n * A request to resolve the definition location of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the response is of either type [Definition](#Definition)\r\n * or a typed array of [DefinitionLink](#DefinitionLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DefinitionRequest;\r\n(function (DefinitionRequest) {\r\n    DefinitionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/definition');\r\n})(DefinitionRequest = exports.DefinitionRequest || (exports.DefinitionRequest = {}));\r\n/**\r\n * A request to resolve project-wide references for the symbol denoted\r\n * by the given text document position. The request's parameter is of\r\n * type [ReferenceParams](#ReferenceParams) the response is of type\r\n * [Location[]](#Location) or a Thenable that resolves to such.\r\n */\r\nvar ReferencesRequest;\r\n(function (ReferencesRequest) {\r\n    ReferencesRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/references');\r\n})(ReferencesRequest = exports.ReferencesRequest || (exports.ReferencesRequest = {}));\r\n//---- Document Highlight ----------------------------------\r\n/**\r\n * Request to resolve a [DocumentHighlight](#DocumentHighlight) for a given\r\n * text document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the request response is of type [DocumentHighlight[]]\r\n * (#DocumentHighlight) or a Thenable that resolves to such.\r\n */\r\nvar DocumentHighlightRequest;\r\n(function (DocumentHighlightRequest) {\r\n    DocumentHighlightRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentHighlight');\r\n})(DocumentHighlightRequest = exports.DocumentHighlightRequest || (exports.DocumentHighlightRequest = {}));\r\n//---- Document Symbol Provider ---------------------------\r\n/**\r\n * A request to list all symbols found in a given text document. The request's\r\n * parameter is of type [TextDocumentIdentifier](#TextDocumentIdentifier) the\r\n * response is of type [SymbolInformation[]](#SymbolInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentSymbolRequest;\r\n(function (DocumentSymbolRequest) {\r\n    DocumentSymbolRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentSymbol');\r\n})(DocumentSymbolRequest = exports.DocumentSymbolRequest || (exports.DocumentSymbolRequest = {}));\r\n//---- Workspace Symbol Provider ---------------------------\r\n/**\r\n * A request to list project-wide symbols matching the query string given\r\n * by the [WorkspaceSymbolParams](#WorkspaceSymbolParams). The response is\r\n * of type [SymbolInformation[]](#SymbolInformation) or a Thenable that\r\n * resolves to such.\r\n */\r\nvar WorkspaceSymbolRequest;\r\n(function (WorkspaceSymbolRequest) {\r\n    WorkspaceSymbolRequest.type = new vscode_jsonrpc_1.RequestType('workspace/symbol');\r\n})(WorkspaceSymbolRequest = exports.WorkspaceSymbolRequest || (exports.WorkspaceSymbolRequest = {}));\r\n/**\r\n * A request to provide commands for the given text document and range.\r\n */\r\nvar CodeActionRequest;\r\n(function (CodeActionRequest) {\r\n    CodeActionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/codeAction');\r\n})(CodeActionRequest = exports.CodeActionRequest || (exports.CodeActionRequest = {}));\r\n/**\r\n * A request to provide code lens for the given text document.\r\n */\r\nvar CodeLensRequest;\r\n(function (CodeLensRequest) {\r\n    CodeLensRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/codeLens');\r\n})(CodeLensRequest = exports.CodeLensRequest || (exports.CodeLensRequest = {}));\r\n/**\r\n * A request to resolve a command for a given code lens.\r\n */\r\nvar CodeLensResolveRequest;\r\n(function (CodeLensResolveRequest) {\r\n    CodeLensResolveRequest.type = new vscode_jsonrpc_1.RequestType('codeLens/resolve');\r\n})(CodeLensResolveRequest = exports.CodeLensResolveRequest || (exports.CodeLensResolveRequest = {}));\r\n/**\r\n * A request to to format a whole document.\r\n */\r\nvar DocumentFormattingRequest;\r\n(function (DocumentFormattingRequest) {\r\n    DocumentFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/formatting');\r\n})(DocumentFormattingRequest = exports.DocumentFormattingRequest || (exports.DocumentFormattingRequest = {}));\r\n/**\r\n * A request to to format a range in a document.\r\n */\r\nvar DocumentRangeFormattingRequest;\r\n(function (DocumentRangeFormattingRequest) {\r\n    DocumentRangeFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/rangeFormatting');\r\n})(DocumentRangeFormattingRequest = exports.DocumentRangeFormattingRequest || (exports.DocumentRangeFormattingRequest = {}));\r\n/**\r\n * A request to format a document on type.\r\n */\r\nvar DocumentOnTypeFormattingRequest;\r\n(function (DocumentOnTypeFormattingRequest) {\r\n    DocumentOnTypeFormattingRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/onTypeFormatting');\r\n})(DocumentOnTypeFormattingRequest = exports.DocumentOnTypeFormattingRequest || (exports.DocumentOnTypeFormattingRequest = {}));\r\n/**\r\n * A request to rename a symbol.\r\n */\r\nvar RenameRequest;\r\n(function (RenameRequest) {\r\n    RenameRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/rename');\r\n})(RenameRequest = exports.RenameRequest || (exports.RenameRequest = {}));\r\n/**\r\n * A request to test and perform the setup necessary for a rename.\r\n */\r\nvar PrepareRenameRequest;\r\n(function (PrepareRenameRequest) {\r\n    PrepareRenameRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/prepareRename');\r\n})(PrepareRenameRequest = exports.PrepareRenameRequest || (exports.PrepareRenameRequest = {}));\r\n/**\r\n * A request to provide document links\r\n */\r\nvar DocumentLinkRequest;\r\n(function (DocumentLinkRequest) {\r\n    DocumentLinkRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentLink');\r\n})(DocumentLinkRequest = exports.DocumentLinkRequest || (exports.DocumentLinkRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given document link. The request's\r\n * parameter is of type [DocumentLink](#DocumentLink) the response\r\n * is of type [DocumentLink](#DocumentLink) or a Thenable that resolves to such.\r\n */\r\nvar DocumentLinkResolveRequest;\r\n(function (DocumentLinkResolveRequest) {\r\n    DocumentLinkResolveRequest.type = new vscode_jsonrpc_1.RequestType('documentLink/resolve');\r\n})(DocumentLinkResolveRequest = exports.DocumentLinkResolveRequest || (exports.DocumentLinkResolveRequest = {}));\r\n/**\r\n * A request send from the client to the server to execute a command. The request might return\r\n * a workspace edit which the client will apply to the workspace.\r\n */\r\nvar ExecuteCommandRequest;\r\n(function (ExecuteCommandRequest) {\r\n    ExecuteCommandRequest.type = new vscode_jsonrpc_1.RequestType('workspace/executeCommand');\r\n})(ExecuteCommandRequest = exports.ExecuteCommandRequest || (exports.ExecuteCommandRequest = {}));\r\n/**\r\n * A request sent from the server to the client to modified certain resources.\r\n */\r\nvar ApplyWorkspaceEditRequest;\r\n(function (ApplyWorkspaceEditRequest) {\r\n    ApplyWorkspaceEditRequest.type = new vscode_jsonrpc_1.RequestType('workspace/applyEdit');\r\n})(ApplyWorkspaceEditRequest = exports.ApplyWorkspaceEditRequest || (exports.ApplyWorkspaceEditRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction thenable(value) {\r\n    return value && func(value.then);\r\n}\r\nexports.thenable = thenable;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the implementation locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar ImplementationRequest;\r\n(function (ImplementationRequest) {\r\n    ImplementationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/implementation');\r\n})(ImplementationRequest = exports.ImplementationRequest || (exports.ImplementationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar TypeDefinitionRequest;\r\n(function (TypeDefinitionRequest) {\r\n    TypeDefinitionRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/typeDefinition');\r\n})(TypeDefinitionRequest = exports.TypeDefinitionRequest || (exports.TypeDefinitionRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * The `workspace/workspaceFolders` is sent from the server to the client to fetch the open workspace folders.\r\n */\r\nvar WorkspaceFoldersRequest;\r\n(function (WorkspaceFoldersRequest) {\r\n    WorkspaceFoldersRequest.type = new vscode_jsonrpc_1.RequestType0('workspace/workspaceFolders');\r\n})(WorkspaceFoldersRequest = exports.WorkspaceFoldersRequest || (exports.WorkspaceFoldersRequest = {}));\r\n/**\r\n * The `workspace/didChangeWorkspaceFolders` notification is sent from the client to the server when the workspace\r\n * folder configuration changes.\r\n */\r\nvar DidChangeWorkspaceFoldersNotification;\r\n(function (DidChangeWorkspaceFoldersNotification) {\r\n    DidChangeWorkspaceFoldersNotification.type = new vscode_jsonrpc_1.NotificationType('workspace/didChangeWorkspaceFolders');\r\n})(DidChangeWorkspaceFoldersNotification = exports.DidChangeWorkspaceFoldersNotification || (exports.DidChangeWorkspaceFoldersNotification = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * The 'workspace/configuration' request is sent from the server to the client to fetch a certain\r\n * configuration setting.\r\n *\r\n * This pull model replaces the old push model were the client signaled configuration change via an\r\n * event. If the server still needs to react to configuration changes (since the server caches the\r\n * result of `workspace/configuration` requests) the server should register for an empty configuration\r\n * change event and empty the cache if such an event is received.\r\n */\r\nvar ConfigurationRequest;\r\n(function (ConfigurationRequest) {\r\n    ConfigurationRequest.type = new vscode_jsonrpc_1.RequestType('workspace/configuration');\r\n})(ConfigurationRequest = exports.ConfigurationRequest || (exports.ConfigurationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * A request to list all color symbols found in a given text document. The request's\r\n * parameter is of type [DocumentColorParams](#DocumentColorParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentColorRequest;\r\n(function (DocumentColorRequest) {\r\n    DocumentColorRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/documentColor');\r\n})(DocumentColorRequest = exports.DocumentColorRequest || (exports.DocumentColorRequest = {}));\r\n/**\r\n * A request to list all presentation for a color. The request's\r\n * parameter is of type [ColorPresentationParams](#ColorPresentationParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar ColorPresentationRequest;\r\n(function (ColorPresentationRequest) {\r\n    ColorPresentationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/colorPresentation');\r\n})(ColorPresentationRequest = exports.ColorPresentationRequest || (exports.ColorPresentationRequest = {}));\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n/**\r\n * Enum of known range kinds\r\n */\r\nvar FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind = exports.FoldingRangeKind || (exports.FoldingRangeKind = {}));\r\n/**\r\n * A request to provide folding ranges in a document. The request's\r\n * parameter is of type [FoldingRangeParams](#FoldingRangeParams), the\r\n * response is of type [FoldingRangeList](#FoldingRangeList) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar FoldingRangeRequest;\r\n(function (FoldingRangeRequest) {\r\n    FoldingRangeRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/foldingRange');\r\n})(FoldingRangeRequest = exports.FoldingRangeRequest || (exports.FoldingRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Declaration](#Declaration)\r\n * or a typed array of [DeclarationLink](#DeclarationLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DeclarationRequest;\r\n(function (DeclarationRequest) {\r\n    DeclarationRequest.type = new vscode_jsonrpc_1.RequestType('textDocument/declaration');\r\n})(DeclarationRequest = exports.DeclarationRequest || (exports.DeclarationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst Is = require(\"./utils/is\");\r\nexports.ConfigurationFeature = (Base) => {\r\n    return class extends Base {\r\n        getConfiguration(arg) {\r\n            if (!arg) {\r\n                return this._getConfiguration({});\r\n            }\r\n            else if (Is.string(arg)) {\r\n                return this._getConfiguration({ section: arg });\r\n            }\r\n            else {\r\n                return this._getConfiguration(arg);\r\n            }\r\n        }\r\n        _getConfiguration(arg) {\r\n            let params = {\r\n                items: Array.isArray(arg) ? arg : [arg]\r\n            };\r\n            return this.connection.sendRequest(vscode_languageserver_protocol_1.ConfigurationRequest.type, params).then((result) => {\r\n                return Array.isArray(arg) ? result : result[0];\r\n            });\r\n        }\r\n    };\r\n};\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nexports.WorkspaceFoldersFeature = (Base) => {\r\n    return class extends Base {\r\n        initialize(capabilities) {\r\n            let workspaceCapabilities = capabilities.workspace;\r\n            if (workspaceCapabilities && workspaceCapabilities.workspaceFolders) {\r\n                this._onDidChangeWorkspaceFolders = new vscode_languageserver_protocol_1.Emitter();\r\n                this.connection.onNotification(vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type, (params) => {\r\n                    this._onDidChangeWorkspaceFolders.fire(params.event);\r\n                });\r\n            }\r\n        }\r\n        getWorkspaceFolders() {\r\n            return this.connection.sendRequest(vscode_languageserver_protocol_1.WorkspaceFoldersRequest.type);\r\n        }\r\n        get onDidChangeWorkspaceFolders() {\r\n            if (!this._onDidChangeWorkspaceFolders) {\r\n                throw new Error('Client doesn\\'t support sending workspace folder change events.');\r\n            }\r\n            if (!this._unregistration) {\r\n                this._unregistration = this.connection.client.register(vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type);\r\n            }\r\n            return this._onDidChangeWorkspaceFolders.event;\r\n        }\r\n    };\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass ValueUUID {\r\n    constructor(_value) {\r\n        this._value = _value;\r\n        // empty\r\n    }\r\n    asHex() {\r\n        return this._value;\r\n    }\r\n    equals(other) {\r\n        return this.asHex() === other.asHex();\r\n    }\r\n}\r\nclass V4UUID extends ValueUUID {\r\n    constructor() {\r\n        super([\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            '4',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._oneOf(V4UUID._timeHighBits),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n        ].join(''));\r\n    }\r\n    static _oneOf(array) {\r\n        return array[Math.floor(array.length * Math.random())];\r\n    }\r\n    static _randomHex() {\r\n        return V4UUID._oneOf(V4UUID._chars);\r\n    }\r\n}\r\nV4UUID._chars = ['0', '1', '2', '3', '4', '5', '6', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nV4UUID._timeHighBits = ['8', '9', 'a', 'b'];\r\n/**\r\n * An empty UUID that contains only zeros.\r\n */\r\nexports.empty = new ValueUUID('00000000-0000-0000-0000-000000000000');\r\nfunction v4() {\r\n    return new V4UUID();\r\n}\r\nexports.v4 = v4;\r\nconst _UUIDPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\r\nfunction isUUID(value) {\r\n    return _UUIDPattern.test(value);\r\n}\r\nexports.isUUID = isUUID;\r\n/**\r\n * Parses a UUID that is of the format xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.\r\n * @param value A uuid string.\r\n */\r\nfunction parse(value) {\r\n    if (!isUUID(value)) {\r\n        throw new Error('invalid uuid');\r\n    }\r\n    return new ValueUUID(value);\r\n}\r\nexports.parse = parse;\r\nfunction generateUuid() {\r\n    return v4().asHex();\r\n}\r\nexports.generateUuid = generateUuid;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst url = require(\"url\");\r\nconst path = require(\"path\");\r\nconst fs = require(\"fs\");\r\nconst child_process_1 = require(\"child_process\");\r\n/**\r\n * @deprecated Use the `vscode-uri` npm module which provides a more\r\n * complete implementation of handling VS Code URIs.\r\n */\r\nfunction uriToFilePath(uri) {\r\n    let parsed = url.parse(uri);\r\n    if (parsed.protocol !== 'file:' || !parsed.path) {\r\n        return undefined;\r\n    }\r\n    let segments = parsed.path.split('/');\r\n    for (var i = 0, len = segments.length; i < len; i++) {\r\n        segments[i] = decodeURIComponent(segments[i]);\r\n    }\r\n    if (process.platform === 'win32' && segments.length > 1) {\r\n        let first = segments[0];\r\n        let second = segments[1];\r\n        // Do we have a drive letter and we started with a / which is the\r\n        // case if the first segement is empty (see split above)\r\n        if (first.length === 0 && second.length > 1 && second[1] === ':') {\r\n            // Remove first slash\r\n            segments.shift();\r\n        }\r\n    }\r\n    return path.normalize(segments.join('/'));\r\n}\r\nexports.uriToFilePath = uriToFilePath;\r\nfunction isWindows() {\r\n    return process.platform === 'win32';\r\n}\r\nfunction resolveModule(workspaceRoot, moduleName) {\r\n    let nodePathKey = 'NODE_PATH';\r\n    return new Promise((resolve, reject) => {\r\n        let nodePath = [];\r\n        if (workspaceRoot) {\r\n            nodePath.push(path.join(workspaceRoot, 'node_modules'));\r\n        }\r\n        child_process_1.exec('npm config get prefix', (error, stdout, _stderr) => {\r\n            if (!error) {\r\n                let globalPath = stdout.replace(/[\\s\\r\\n]+$/, '');\r\n                if (globalPath.length > 0) {\r\n                    if (isWindows()) {\r\n                        nodePath.push(path.join(globalPath, 'node_modules'));\r\n                    }\r\n                    else {\r\n                        nodePath.push(path.join(globalPath, 'lib', 'node_modules'));\r\n                    }\r\n                }\r\n            }\r\n            let separator = isWindows() ? ';' : ':';\r\n            let env = process.env;\r\n            let newEnv = Object.create(null);\r\n            Object.keys(env).forEach(key => newEnv[key] = env[key]);\r\n            if (newEnv[nodePathKey]) {\r\n                newEnv[nodePathKey] = nodePath.join(separator) + separator + newEnv[nodePathKey];\r\n            }\r\n            else {\r\n                newEnv[nodePathKey] = nodePath.join(separator);\r\n            }\r\n            newEnv['ELECTRON_RUN_AS_NODE'] = '1';\r\n            try {\r\n                let cp = child_process_1.fork(path.join(__dirname, 'resolve.js'), [], { env: newEnv, execArgv: [] });\r\n                if (cp.pid === void 0) {\r\n                    reject(new Error(`Starting process to resolve node module  ${moduleName} failed`));\r\n                    return;\r\n                }\r\n                cp.on('message', (message) => {\r\n                    if (message.command === 'resolve') {\r\n                        let toRequire = moduleName;\r\n                        if (message.success) {\r\n                            toRequire = message.result;\r\n                        }\r\n                        cp.send({ command: 'exit' });\r\n                        try {\r\n                            resolve(require(toRequire));\r\n                        }\r\n                        catch (error) {\r\n                            reject(error);\r\n                        }\r\n                    }\r\n                });\r\n                let message = {\r\n                    command: 'resolve',\r\n                    args: moduleName\r\n                };\r\n                cp.send(message);\r\n            }\r\n            catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    });\r\n}\r\nexports.resolveModule = resolveModule;\r\nfunction resolve(moduleName, nodePath, cwd, tracer) {\r\n    const nodePathKey = 'NODE_PATH';\r\n    const app = [\r\n        \"var p = process;\",\r\n        \"p.on('message',function(m){\",\r\n        \"if(m.c==='e'){\",\r\n        \"p.exit(0);\",\r\n        \"}\",\r\n        \"else if(m.c==='rs'){\",\r\n        \"try{\",\r\n        \"var r=require.resolve(m.a);\",\r\n        \"p.send({c:'r',s:true,r:r});\",\r\n        \"}\",\r\n        \"catch(err){\",\r\n        \"p.send({c:'r',s:false});\",\r\n        \"}\",\r\n        \"}\",\r\n        \"});\"\r\n    ].join('');\r\n    return new Promise((resolve, reject) => {\r\n        let env = process.env;\r\n        let newEnv = Object.create(null);\r\n        Object.keys(env).forEach(key => newEnv[key] = env[key]);\r\n        if (nodePath) {\r\n            if (newEnv[nodePathKey]) {\r\n                newEnv[nodePathKey] = nodePath + path.delimiter + newEnv[nodePathKey];\r\n            }\r\n            else {\r\n                newEnv[nodePathKey] = nodePath;\r\n            }\r\n            if (tracer) {\r\n                tracer(`NODE_PATH value is: ${newEnv[nodePathKey]}`);\r\n            }\r\n        }\r\n        newEnv['ELECTRON_RUN_AS_NODE'] = '1';\r\n        try {\r\n            let cp = child_process_1.fork('', [], {\r\n                cwd: cwd,\r\n                env: newEnv,\r\n                execArgv: ['-e', app]\r\n            });\r\n            if (cp.pid === void 0) {\r\n                reject(new Error(`Starting process to resolve node module  ${moduleName} failed`));\r\n                return;\r\n            }\r\n            cp.on('error', (error) => {\r\n                reject(error);\r\n            });\r\n            cp.on('message', (message) => {\r\n                if (message.c === 'r') {\r\n                    cp.send({ c: 'e' });\r\n                    if (message.s) {\r\n                        resolve(message.r);\r\n                    }\r\n                    else {\r\n                        reject(new Error(`Failed to resolve module: ${moduleName}`));\r\n                    }\r\n                }\r\n            });\r\n            let message = {\r\n                c: 'rs',\r\n                a: moduleName\r\n            };\r\n            cp.send(message);\r\n        }\r\n        catch (error) {\r\n            reject(error);\r\n        }\r\n    });\r\n}\r\nexports.resolve = resolve;\r\nfunction resolveGlobalNodePath(tracer) {\r\n    let npmCommand = 'npm';\r\n    let options = {\r\n        encoding: 'utf8'\r\n    };\r\n    if (isWindows()) {\r\n        npmCommand = 'npm.cmd';\r\n        options.shell = true;\r\n    }\r\n    let handler = () => { };\r\n    try {\r\n        process.on('SIGPIPE', handler);\r\n        let stdout = child_process_1.spawnSync(npmCommand, ['config', 'get', 'prefix'], options).stdout;\r\n        if (!stdout) {\r\n            if (tracer) {\r\n                tracer(`'npm config get prefix' didn't return a value.`);\r\n            }\r\n            return undefined;\r\n        }\r\n        let prefix = stdout.trim();\r\n        if (tracer) {\r\n            tracer(`'npm config get prefix' value is: ${prefix}`);\r\n        }\r\n        if (prefix.length > 0) {\r\n            if (isWindows()) {\r\n                return path.join(prefix, 'node_modules');\r\n            }\r\n            else {\r\n                return path.join(prefix, 'lib', 'node_modules');\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    catch (err) {\r\n        return undefined;\r\n    }\r\n    finally {\r\n        process.removeListener('SIGPIPE', handler);\r\n    }\r\n}\r\nexports.resolveGlobalNodePath = resolveGlobalNodePath;\r\nfunction resolveGlobalYarnPath(tracer) {\r\n    let yarnCommand = 'yarn';\r\n    let options = {\r\n        encoding: 'utf8'\r\n    };\r\n    if (isWindows()) {\r\n        yarnCommand = 'yarn.cmd';\r\n        options.shell = true;\r\n    }\r\n    let handler = () => { };\r\n    try {\r\n        process.on('SIGPIPE', handler);\r\n        let results = child_process_1.spawnSync(yarnCommand, ['global', 'dir', '--json'], options);\r\n        let stdout = results.stdout;\r\n        if (!stdout) {\r\n            if (tracer) {\r\n                tracer(`'yarn global dir' didn't return a value.`);\r\n                if (results.stderr) {\r\n                    tracer(results.stderr);\r\n                }\r\n            }\r\n            return undefined;\r\n        }\r\n        let lines = stdout.trim().split(/\\r?\\n/);\r\n        for (let line of lines) {\r\n            try {\r\n                let yarn = JSON.parse(line);\r\n                if (yarn.type === 'log') {\r\n                    return path.join(yarn.data, 'node_modules');\r\n                }\r\n            }\r\n            catch (e) {\r\n                // Do nothing. Ignore the line\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    catch (err) {\r\n        return undefined;\r\n    }\r\n    finally {\r\n        process.removeListener('SIGPIPE', handler);\r\n    }\r\n}\r\nexports.resolveGlobalYarnPath = resolveGlobalYarnPath;\r\nvar FileSystem;\r\n(function (FileSystem) {\r\n    let _isCaseSensitive = undefined;\r\n    function isCaseSensitive() {\r\n        if (_isCaseSensitive !== void 0) {\r\n            return _isCaseSensitive;\r\n        }\r\n        if (process.platform === 'win32') {\r\n            _isCaseSensitive = false;\r\n        }\r\n        else {\r\n            // convert current file name to upper case / lower case and check if file exists\r\n            // (guards against cases when name is already all uppercase or lowercase)\r\n            _isCaseSensitive = !fs.existsSync(__filename.toUpperCase()) || !fs.existsSync(__filename.toLowerCase());\r\n        }\r\n        return _isCaseSensitive;\r\n    }\r\n    FileSystem.isCaseSensitive = isCaseSensitive;\r\n    function isParent(parent, child) {\r\n        if (isCaseSensitive()) {\r\n            return path.normalize(child).indexOf(path.normalize(parent)) === 0;\r\n        }\r\n        else {\r\n            return path.normalize(child).toLowerCase().indexOf(path.normalize(parent).toLowerCase()) == 0;\r\n        }\r\n    }\r\n    FileSystem.isParent = isParent;\r\n})(FileSystem = exports.FileSystem || (exports.FileSystem = {}));\r\nfunction resolveModulePath(workspaceRoot, moduleName, nodePath, tracer) {\r\n    if (nodePath) {\r\n        if (!path.isAbsolute(nodePath)) {\r\n            nodePath = path.join(workspaceRoot, nodePath);\r\n        }\r\n        return resolve(moduleName, nodePath, nodePath, tracer).then((value) => {\r\n            if (FileSystem.isParent(nodePath, value)) {\r\n                return value;\r\n            }\r\n            else {\r\n                return Promise.reject(new Error(`Failed to load ${moduleName} from node path location.`));\r\n            }\r\n        }).then(undefined, (_error) => {\r\n            return resolve(moduleName, resolveGlobalNodePath(tracer), workspaceRoot, tracer);\r\n        });\r\n    }\r\n    else {\r\n        return resolve(moduleName, resolveGlobalNodePath(tracer), workspaceRoot, tracer);\r\n    }\r\n}\r\nexports.resolveModulePath = resolveModulePath;\r\n/**\r\n * Resolves the given module relative to the given workspace root. In contrast to\r\n * `resolveModule` this method considers the parent chain as well.\r\n */\r\nfunction resolveModule2(workspaceRoot, moduleName, nodePath, tracer) {\r\n    return resolveModulePath(workspaceRoot, moduleName, nodePath, tracer).then((path) => {\r\n        if (tracer) {\r\n            tracer(`Module ${moduleName} got resolved to ${path}`);\r\n        }\r\n        return require(path);\r\n    });\r\n}\r\nexports.resolveModule2 = resolveModule2;\r\n","module.exports = require(\"url\");","module.exports = require(\"fs\");","module.exports = require(\"child_process\");","import * as vscode from 'vscode-languageserver';\r\n\r\n// instruction mode (default), DBField mode. string mode\r\nconst PARSE_INSTRUCTION = 1;\r\nconst PARSE_DBFIELD = 2;\r\nconst PARSE_STRING = 3;\r\n\r\n//export function ParseDocument(document: vscode.TextDocument, token: vscode.CancellationToken): ParseItem[] {\r\nexport function ParseDocument(document: vscode.TextDocument, grammar: any): MySymbol[] {\r\n\t// this stores all the symbols we create\r\n\r\n\t// TODO: don't need to go via ParseItem any longer.. \r\n\t//const symbols: ParseItem[] = [];\r\n\t//console.log(grammar.repository.keywords.patterns);\r\n\r\n\t// Make an array of Items (strings, DB fields) and their positions\r\n\t// that should be checked to see if new (eg) variable is inside or not\r\n\tconst mySymbols: MySymbol[] = [];\r\n\r\n\t//unused\r\n\tlet parseStatus = new ParseStatus();\r\n\r\n\t// Parse the document, line by line\r\n\tfor (let i = 0; i < document.lineCount; i++) {\r\n\r\n\t\tlet oneLine = document.getText(vscode.Range.create(i, -1, i, Number.MAX_VALUE));\r\n\r\n\t\t/////////////////////////\r\n\t\t// 1 - Exclude comment lines\r\n\t\t/////////////////////////\r\n\t\tif (oneLine[0] === '#') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t/////////////////////////\r\n\t\t// 2 - find STRINGS. store start and end in mysms array for later\r\n\t\t/////////////////////////\r\n\t\tvar oneString: [number, number] = findSymbol(oneLine, '\"');\r\n\t\tif ((oneString[0] !== -1 && oneString[1] !== -1)) {\r\n\r\n\t\t\t//make a MySymbol to record the range of strings for exclusion from other searches\r\n\t\t\tlet symName: string = oneLine.substr(oneString[0], oneString[1] - oneString[0] + 1);\r\n\t\t\tlet resultItem = new ParseItem(symName, vscode.SymbolKind.String);\r\n\t\t\tresultItem.line = i;\r\n\t\t\tresultItem.container = \"STRINGS:\";\r\n\r\n\t\t\t// add on a start and end position to form a MySymbol\r\n\t\t\tlet oneSymbol: MySymbol = new MySymbol(resultItem, oneString[0], oneString[1]);\r\n\r\n\t\t\tmySymbols.push(oneSymbol);\r\n\t\t}\r\n\t\t/////////////////////////\r\n\t\t// 3- DB fields\r\n\t\t/////////////////////////\r\n\t\t// find DB fields like you do with strings,  \r\n\t\tvar oneDB: [number, number] = findSymbol(oneLine, '{', '}');\r\n\t\tif (oneDB[0] !== -1 && oneDB[1] !== -1) {\r\n\r\n\t\t\t// check if this is inside an existing symbol\r\n\t\t\tvar inside: boolean = false;\r\n\t\t\tcheck: for (var symb of mySymbols) {\r\n\t\t\t\tif (symb.withinField(i, oneDB[0])) {\r\n\t\t\t\t\tinside = true;\r\n\t\t\t\t\tbreak check;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!inside) {\r\n\t\t\t\tlet symName: string = oneLine.substr(oneDB[0], oneDB[1] - oneDB[0] + 1);\r\n\t\t\t\tlet resultSymbol = new ParseItem(symName, vscode.SymbolKind.Field);\r\n\t\t\t\tresultSymbol.line = i;\r\n\t\t\t\tresultSymbol.container = \"DB FIELDS:\";\r\n\t\t\t\t//symbols.push(resultSymbol);\r\n\r\n\t\t\t\t// also addit to mysms array\r\n\t\t\t\tlet oneSymbol: MySymbol = new MySymbol(resultSymbol, oneDB[0], oneDB[1]);\r\n\t\t\t\tmySymbols.push(oneSymbol);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/////////////////////\r\n\t\t//4 - Variables\r\n\t\t/////////////////////\r\n\t\t// need some method of ignoring keywords from lookup\r\n\t\t// yet exclude keywords if they form a variable name...\r\n\t\t// TextMate Grammar is defined in CLIENT not server\r\n\t\t// is there a way of either having the server define the syntax highlight grammar, or retrieve the TMgrammar keywords\r\n\t\t// via the language server?\r\n\t\t//alternatively, need to leave instructions to copy and chages to language.tmgrammar to the server dir too\r\n\r\n\t\tvar startofword: number = 0;\r\n\t\t// Word delimiter\r\n\t\tvar pattern = /[\\{\\}\\(\\)\\s\\,]/g;\r\n\t\tvar match: RegExpExecArray;\r\n\t\t// For each word:\r\n\t\twhile (match = pattern.exec(oneLine)) {\r\n\t\t\tvar word: string = oneLine.slice(startofword, match.index);\r\n\t\t\t//TODO parse a servercopy of the pro.tmLanguage.json\r\n\t\t\t\r\n\r\n\t\t\t// for eack keywords: if word.match(pattern) then exclude = true else exclude = false\r\n\t\t\t// (maybe move this to post-check if inside a DB field or string for speed...?\r\n\r\n\t\t\tvar isKeyword:boolean = false;\r\n\t\t\tfor (let node of grammar.repository.keywords.patterns) {\r\n\t\t\t\t//node is a name/match pair of a given keyword\r\n\t\t\t\t//node.match is a regexp but with ?i case insensitive flag which doesn't work here...\r\n\t\t\t\t\r\n\t\t\t\t// change (?i)\r\n\t\t\t\tvar replace = /\\(\\?i\\)/;\r\n\t\t\t\tif (node[\"match\"].match(replace)){\r\n\t\t\t\t\t//var newMatch:string = node[\"match\"].replace(replace,\"(?<!.)\");\r\n\t\t\t\t\tvar newMatch:string = node[\"match\"].replace(replace,\"\");\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif(word.toUpperCase().match(newMatch)) {\r\n\t\t\t\t\tconsole.log(\"Keyword found: \"+word);\r\n\t\t\t\t\tisKeyword=true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// If word is small or doesn't begin with alpha, or is a keyword, then discard as variable name\r\n\t\t\tif (word.length > 0 && word.match(/^[a-zA-Z]/) && !isKeyword) { // and exclude = false:\r\n\t\t\t\t// check if inside any existing symbols on this line:\r\n\t\t\t\tvar inside: boolean = false;\r\n\t\t\t\tcheck: for (var symb of mySymbols) {\r\n\t\t\t\t\tif (symb.withinField(i, startofword)) {\r\n\t\t\t\t\t\tinside = true;\r\n\t\t\t\t\t\tbreak check;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (!inside) {\r\n\t\t\t\t\tlet symName: string = word;\r\n\t\t\t\t\tlet resultSymbol = new ParseItem(symName, vscode.SymbolKind.Variable);\r\n\t\t\t\t\tresultSymbol.line = i;\r\n\t\t\t\t\tresultSymbol.container = \"VARIABLES:\";\r\n\t\t\t\t\t//symbols.push(resultSymbol);\r\n\r\n\t\t\t\t\t// also addit to mysms array\r\n\t\t\t\t\tlet oneSymbol: MySymbol = new MySymbol(resultSymbol, startofword, match.index);\r\n\t\t\t\t\tmySymbols.push(oneSymbol);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tstartofword = pattern.lastIndex;\r\n\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t}\r\n\t// 4 - everything else - split line into words delimited by non-ascii characters excluding {}\"\r\n\t//if the word is in the keywords list, then ignore,\r\n\t// otherwise, word is a variable - make into symbol\r\n\r\n\t//return array of MySymbol items to calling Server\r\n\treturn mySymbols;\r\n}\r\n// find all strings (a string may want to display a field name or curly braces)\r\n// find all db fields that aren't in strings\r\n// find all other words by delim, if it's not a keyword, then it's a variable\r\n\r\n\r\n\r\n// 3 - \r\n// FOR EACH WORD (split by space or bracket/curlybracet/comma)\r\n// word delimiters: (){},whitespace\r\n// string.split(\"\\\\P{Alpha}\")\r\n\r\n// if it's a keyword, ignore it\r\n\r\n\r\nclass oneWord {\r\n\tpublic word: string;\r\n\tpublic start: number;\r\n\tpublic end: number;\r\n\tconstructor(pWord: string, pStart: number, pEnd: number) {\r\n\r\n\t}\r\n}\r\n\r\nfunction findSymbol(pLine: string, pDelimOpen: string, pDelimClose?: string): [number, number] {\r\n\t// returns start and end position of string in a line enclosed by delimiter(s)\r\n\tlet i: number = 0;\r\n\tlet nStart: number = -1;\r\n\tlet nEnd: number = -1;\r\n\tvar pClose: string;\r\n\r\n\tif (typeof pDelimClose === 'undefined') {\r\n\t\tpClose = pDelimOpen;\r\n\t} else {\r\n\t\tpClose = pDelimClose;\r\n\t}\r\n\tlet startFound: boolean = false;\r\n\r\n\tfor (const c of pLine) {\r\n\t\tif ((c == pDelimOpen && !startFound) || (c == pClose && startFound)) {\r\n\t\t\tif (!startFound) {\r\n\t\t\t\tnStart = i;\r\n\t\t\t\tstartFound = true;\r\n\t\t\t} else {\r\n\t\t\t\tnEnd = i;\r\n\t\t\t\treturn ([nStart, nEnd]);\r\n\t\t\t}\r\n\t\t}\r\n\t\ti++;\r\n\t}\r\n\treturn [nStart, nEnd];\r\n}\r\n// store information about the parse state\r\nclass ParseStatus {\r\n\tpublic parseMode: number;\r\n\tpublic parseDepth: number;\r\n\tpublic parseString: string;\r\n\r\n\tpublic stringQuote: string;\r\n\r\n\tpublic instructionString: string;\r\n\tpublic instructionStartLine: number;\r\n\r\n\tconstructor() {\r\n\t\tthis.parseMode = PARSE_INSTRUCTION;\r\n\t\tthis.parseDepth = 0;\r\n\t\tthis.parseString = '';\r\n\t\tthis.stringQuote = '';\r\n\t\tthis.instructionString = '';\r\n\t\tthis.instructionStartLine = 0;\r\n\t}\r\n}\r\n\r\n// Store Information about the Parsed Object\r\n// tslint:disable-next-line: max-classes-per-file\r\n\r\nexport class MySymbol {\r\n\r\n\t//contains ParseItem to create SymbolItem from, and also the found start and end character positions\r\n\t// to detect whether we are inside an existing symbol or not (eg comment or DB field) \r\n\t// could later be extended to pass out to calling server for creating symbol including range\r\n\tpublic parseItem: ParseItem;\r\n\tpublic start: number;\r\n\tpublic end: number;\r\n\r\n\r\n\tconstructor(pItem: ParseItem, pStart?: number, pEnd?: number) {\r\n\t\tif (typeof pStart === 'undefined') {\r\n\t\t\tthis.start = 0;\r\n\t\t} else {\r\n\t\t\tthis.start = pStart;\r\n\t\t}\r\n\t\tif (typeof pEnd === 'undefined') {\r\n\t\t\tthis.end = 0;\r\n\t\t} else {\r\n\t\t\tthis.end = pEnd;\r\n\t\t}\r\n\t\tthis.parseItem = pItem;\r\n\t}\r\n\r\n\twithinField(pLine: number, pPosition: number): boolean {\r\n\t\tif (this.parseItem.line == pLine) {\r\n\t\t\tif (pPosition >= this.start && pPosition <= this.end) {\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class ParseItem {\r\n\tpublic name: string;\r\n\tpublic line: number;\r\n\tpublic type: vscode.SymbolKind;\r\n\tpublic container: string;\r\n\r\n\r\n\tconstructor(pName: string, pType?: vscode.SymbolKind) {\r\n\t\tif (typeof pType === 'undefined') {\r\n\t\t\tthis.type = vscode.SymbolKind.Object;\r\n\t\t} else {\r\n\t\t\tthis.type = pType;\r\n\t\t}\r\n\t\tthis.name = pName;\r\n\t\tthis.line = 0;\r\n\t}\r\n}\r\n\r\n// Search for DBField End\r\nfunction parseForDBFieldEnd(pStatus: ParseStatus): ParseStatus {\r\n\t// check start DBField\r\n\tlet DBFieldStart = 0;\r\n\tDBField: while (DBFieldStart >= 0) {\r\n\t\t// check DBField\r\n\t\tDBFieldStart = pStatus.parseString.search(/\\/\\*|\\*\\//);\r\n\r\n\t\t// line inside a DBField, ignore\r\n\t\tif (DBFieldStart === -1) {\r\n\t\t\tpStatus.parseString = '';\r\n\t\t\tbreak DBField;\r\n\t\t}\r\n\r\n\t\t// set new DBField depth level\r\n\t\tconst DBFieldType = pStatus.parseString.substr(DBFieldStart, 2);\r\n\t\tif (DBFieldType === '/*') {\r\n\t\t\tpStatus.parseDepth++;\r\n\t\t} else {\r\n\t\t\tpStatus.parseDepth--;\r\n\t\t}\r\n\r\n\t\t// adjust parse string\r\n\t\tpStatus.parseString = pStatus.parseString.substr(DBFieldStart + 2);\r\n\r\n\t\t// DBField is over, return\r\n\t\tif (pStatus.parseDepth <= 0) {\r\n\t\t\tpStatus.parseMode = PARSE_INSTRUCTION;\r\n\t\t\tbreak DBField;\r\n\t\t}\r\n\t}\r\n\treturn pStatus;\r\n}\r\n\r\n// Search for String End\r\nfunction parseForStringEnd(pStatus: ParseStatus): ParseStatus {\r\n\r\n\tlet endQuote = -1;\r\n\tif (pStatus.stringQuote === '\\'') {\r\n\t\tendQuote = pStatus.parseString.search(/'/);\r\n\t} else {\r\n\t\tendQuote = pStatus.parseString.search(/\"/);\r\n\t}\r\n\r\n\t// End Quote found\r\n\tif (endQuote >= 0) {\r\n\t\t// DoubleQuote\r\n\t\tif (pStatus.parseString.substr(endQuote + 1, 1) === pStatus.stringQuote) {\r\n\t\t\tpStatus.parseString = pStatus.parseString.substr(endQuote + 2);\r\n\t\t\treturn parseForStringEnd(pStatus);\r\n\t\t}\r\n\t\tpStatus.parseString = pStatus.parseString.substr(endQuote + 1);\r\n\t\tpStatus.stringQuote = '';\r\n\t\tpStatus.parseMode = PARSE_INSTRUCTION;\r\n\t} else {\r\n\t\t// line inside a string, ignore\r\n\t\tpStatus.parseString = '';\r\n\t}\r\n\r\n\treturn pStatus;\r\n}\r\n\r\n// create symbol for Block\r\nfunction parseBlock(pBlock: string): ParseItem {\r\n\t// empty string, nothing to do\r\n\tif (pBlock.length === 0) {\r\n\t\treturn null;\r\n\t}\r\n\t// last char is colon, we wont need that\r\n\tif (pBlock.substr(pBlock.length - 1, 1) === ':') {\r\n\t\tpBlock = pBlock.substr(0, pBlock.length - 1);\r\n\t}\r\n\t// split into words\r\n\tconst words = pBlock.split(/\\s+/);\r\n\t// no words, no work\r\n\tif (words.length === 0) {\r\n\t\treturn null;\r\n\t}\r\n\t// is this a label or a block\r\n\t// ABL is case-insensitive, TS is not; make our life easier by coverting string to lowercase\r\n\tswitch (words[0].toLowerCase()) {\r\n\t\tcase 'case':\r\n\t\tcase 'catch':\r\n\t\tcase 'def':\r\n\t\tcase 'define':\r\n\t\tcase 'do':\r\n\t\tcase 'else': // may precede a block\r\n\t\tcase 'finally':\r\n\t\tcase 'for':\r\n\t\tcase 'get':\r\n\t\tcase 'if': // if statements may precede a block\r\n\t\tcase 'on': // on statements may precede a block\r\n\t\tcase 'otherwise': // may precede a block\r\n\t\tcase 'private':\r\n\t\tcase 'protected':\r\n\t\tcase 'public':\r\n\t\tcase 'repeat':\r\n\t\tcase 'set':\r\n\t\tcase 'triggers':\r\n\t\tcase 'when': // may precede a block\r\n\t\t\t// ignore those blocks\r\n\t\t\treturn null;\r\n\t\tcase 'class':\r\n\t\t\treturn new ParseItem(words[1], vscode.SymbolKind.Class);\r\n\t\tcase 'constructor':\r\n\t\t\t// check for keywords that may precede the name\r\n\t\t\tlet iC = 1;\r\n\t\t\tconst wC = words[1].toLowerCase();\r\n\t\t\tif (wC === 'private' || wC === 'public' || wC === 'protected' || wC === 'static') {\r\n\t\t\t\tiC++;\r\n\t\t\t}\r\n\t\t\treturn new ParseItem(RemoveBracketFromName(words[iC]), vscode.SymbolKind.Constructor);\r\n\t\tcase 'destructor':\r\n\t\t\t// check for keywords that may precede the name\r\n\t\t\tlet iD = 1;\r\n\t\t\tconst wD = words[1].toLowerCase();\r\n\t\t\tif (wD === 'public') {\r\n\t\t\t\tiD++;\r\n\t\t\t}\r\n\t\t\t// No Destructor Type in SymbolKind, return Method\r\n\t\t\treturn new ParseItem(RemoveBracketFromName(words[iD]), vscode.SymbolKind.Method);\r\n\t\tcase 'enum':\r\n\t\t\treturn new ParseItem(words[1], vscode.SymbolKind.Enum);\r\n\t\tcase 'function':\r\n\t\tcase 'procedure':\r\n\t\t\t// No Procedure Type in SymbolKind, return Function\r\n\t\t\treturn new ParseItem(words[1], vscode.SymbolKind.Function);\r\n\t\tcase 'interface':\r\n\t\t\treturn new ParseItem(words[1], vscode.SymbolKind.Interface);\r\n\t\tcase 'method':\r\n\t\t\t// We want the Name of the Method, so check for various keywords\r\n\t\t\tlet iM = 1;\r\n\t\t\twhile (words[iM]) {\r\n\t\t\t\tconst wM = words[iM].toLowerCase();\r\n\t\t\t\tif (wM === 'private' || wM === 'public' || wM === 'protected' || wM === 'static'\r\n\t\t\t\t\t|| wM === 'abstract' || wM === 'override' || wM === 'final') {\r\n\t\t\t\t\tiM++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// iM should now be the return type, increase by one to get the name\r\n\t\t\t\t\tiM++;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (words[iM]) {\r\n\t\t\t\treturn new ParseItem(RemoveBracketFromName(words[iM]), vscode.SymbolKind.Method);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t// must be a label\r\n\t\tdefault:\r\n\t\t\treturn new ParseItem(words[0], vscode.SymbolKind.Key);\r\n\r\n\t}\r\n}\r\n\r\n// create symbol for instruction\r\nfunction parseInstruction(pInstruction: string): ParseItem {\r\n\t// ABL is case-insensitive, TS is not; make our life easier by coverting string to lowercase\r\n\tif (pInstruction.substr(0, 3).toLowerCase().startsWith('def')) {\r\n\t\tconst words = pInstruction.split(/\\s+/);\r\n\r\n\t\t/*\r\n         * Walk over all words of the instruction\r\n         * certain keywords identify the type of definition (like parameter or variable)\r\n         * this will be followed by the name\r\n         */\r\n\t\tbuffer: for (let i = 1; i < words.length; i++) {\r\n\t\t\t// ABL is case-insensitive, TS is not; make our life easier by coverting string to lowercase\r\n\t\t\tswitch (words[i].toLowerCase()) {\r\n\t\t\t\t// reserverd words that might show up in a definition\r\n\t\t\t\tcase 'new':\r\n\t\t\t\tcase 'global':\r\n\t\t\t\tcase 'shared':\r\n\t\t\t\tcase 'private':\r\n\t\t\t\tcase 'protected':\r\n\t\t\t\tcase 'public':\r\n\t\t\t\tcase 'static':\r\n\t\t\t\tcase 'abstract':\r\n\t\t\t\tcase 'override':\r\n\t\t\t\tcase 'serializable':\r\n\t\t\t\tcase 'non-serializable':\r\n\t\t\t\tcase 'input':\r\n\t\t\t\tcase 'output':\r\n\t\t\t\tcase 'input-output':\r\n\t\t\t\tcase 'return':\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// mark these as objects unless something better comes along\r\n\t\t\t\tcase 'buffer':\r\n\t\t\t\tcase 'dataset':\r\n\t\t\t\tcase 'data-source':\r\n\t\t\t\tcase 'frame':\r\n\t\t\t\tcase 'image':\r\n\t\t\t\tcase 'menu':\r\n\t\t\t\tcase 'query':\r\n\t\t\t\tcase 'rectangle':\r\n\t\t\t\tcase 'sub-menu':\r\n\t\t\t\tcase 'temp-table':\r\n\t\t\t\tcase 'work-table':\r\n\t\t\t\tcase 'workfile':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.Object);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Enumerations\r\n\t\t\t\tcase 'enum':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.EnumMember);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Events\r\n\t\t\t\tcase 'event':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.Event);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Parameter\r\n\t\t\t\tcase 'parameter':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.TypeParameter);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Property\r\n\t\t\t\tcase 'property':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.Property);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Stream\r\n\t\t\t\tcase 'stream':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.File);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t\t// Variable\r\n\t\t\t\tcase 'var':\r\n\t\t\t\tcase 'vari':\r\n\t\t\t\tcase 'variab':\r\n\t\t\t\tcase 'variabl':\r\n\t\t\t\tcase 'variable':\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tif (words[i]) {\r\n\t\t\t\t\t\treturn new ParseItem(words[i], vscode.SymbolKind.Variable);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak buffer;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n\r\n// Helper Function to Remove Brackets from names, Example: \"Func(input)\" -> \"Func\"\r\nfunction RemoveBracketFromName(pName: string): string {\r\n\tconst rName = pName.split('(', 1);\r\n\treturn rName[0];\r\n}"],"sourceRoot":""}
=======
{"version":3,"file":"server.js","sourceRoot":"","sources":["../src/server.ts"],"names":[],"mappings":"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"}
>>>>>>> rebase
=======
{"version":3,"file":"server.js","sourceRoot":"","sources":["../src/server.ts"],"names":[],"mappings":"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"}
>>>>>>> master
